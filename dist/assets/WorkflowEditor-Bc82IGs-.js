import{c as nn,aE as Ia,aF as Aa,R as Pa,j as M,o as g,X as Mr,$ as $a,Y as Ta,a0 as Da,aG as za,E as ja,B as Ha,Z as Ra,H as le,I as At}from"./index-D9dO6jDR.js";import{r as La}from"./index-DD1lgNRl.js";import{C as Ir,a as Oa,d as Va}from"./card-CwNu_Je7.js";import{I as He}from"./input-B-CVJ1EK.js";import{T as Ba}from"./textarea-CaGXNRBe.js";import{L as In}from"./label-oZkRqp9j.js";import{C as vo}from"./checkbox-Clq-fj6n.js";import{S as Ar,a as Pr,b as Fa,c as $r,d as ze}from"./select-CW8OCjh3.js";import{B as pe}from"./button-BiTOCxHO.js";import{P as Xa,a as Ya,b as Wa}from"./popover-CgO1idC9.js";import{P as Za,S as qa}from"./save-C9eXQhmG.js";import{C as Ga}from"./circle-check-wIzPJg6E.js";import{D as Ua,f as Ka,a as Qa,c as Ja,b as ec,e as tc,d as nc}from"./dialog-CTG_fKa3.js";import{s as oc,W as rc,i as ic}from"./workflows-yFwrpo28.js";import{P as bo}from"./plus-B0uAgXLJ.js";import{T as An,P as sc}from"./type-DiTegJR3.js";import{C as Tr}from"./chevron-down-CqRsxq5z.js";import{L as Dr}from"./list-B9EoXc9w.js";import{T as ac}from"./trash-2-C6TvX7gl.js";import"./index-CurXoWR1.js";import"./index-B6rWjmp5.js";import"./check-DPcULkwW.js";import"./index-BdQq_4o_.js";import"./index-CfA0gxda.js";import"./index-CQKvY29V.js";import"./index-CREuF23G.js";const cc=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],lc=nn("circle-x",cc);const uc=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],zr=nn("hash",uc);const dc=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],jr=nn("square-check-big",dc);const fc=[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 19H3",key:"z6ezky"}]],Hr=nn("text-align-start",fc);function ue(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,o;n<e.length;n++)(o=ue(e[n]))!==""&&(t+=(t&&" ")+o);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var hc={value:()=>{}};function on(){for(var e=0,t=arguments.length,n={},o;e<t;++e){if(!(o=arguments[e]+"")||o in n||/[\s.]/.test(o))throw new Error("illegal type: "+o);n[o]=[]}return new Ot(n)}function Ot(e){this._=e}function gc(e,t){return e.trim().split(/^|\s+/).map(function(n){var o="",r=n.indexOf(".");if(r>=0&&(o=n.slice(r+1),n=n.slice(0,r)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:o}})}Ot.prototype=on.prototype={constructor:Ot,on:function(e,t){var n=this._,o=gc(e+"",n),r,i=-1,s=o.length;if(arguments.length<2){for(;++i<s;)if((r=(e=o[i]).type)&&(r=pc(n[r],e.name)))return r;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++i<s;)if(r=(e=o[i]).type)n[r]=No(n[r],e.name,t);else if(t==null)for(r in n)n[r]=No(n[r],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Ot(e)},call:function(e,t){if((r=arguments.length-2)>0)for(var n=new Array(r),o=0,r,i;o<r;++o)n[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],o=0,r=i.length;o<r;++o)i[o].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var o=this._[e],r=0,i=o.length;r<i;++r)o[r].value.apply(t,n)}};function pc(e,t){for(var n=0,o=e.length,r;n<o;++n)if((r=e[n]).name===t)return r.value}function No(e,t,n){for(var o=0,r=e.length;o<r;++o)if(e[o].name===t){e[o]=hc,e=e.slice(0,o).concat(e.slice(o+1));break}return n!=null&&e.push({name:t,value:n}),e}var Pn="http://www.w3.org/1999/xhtml";const Eo={svg:"http://www.w3.org/2000/svg",xhtml:Pn,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function rn(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),Eo.hasOwnProperty(t)?{space:Eo[t],local:e}:e}function mc(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Pn&&t.documentElement.namespaceURI===Pn?t.createElement(e):t.createElementNS(n,e)}}function xc(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Rr(e){var t=rn(e);return(t.local?xc:mc)(t)}function yc(){}function Yn(e){return e==null?yc:function(){return this.querySelector(e)}}function wc(e){typeof e!="function"&&(e=Yn(e));for(var t=this._groups,n=t.length,o=new Array(n),r=0;r<n;++r)for(var i=t[r],s=i.length,a=o[r]=new Array(s),c,l,u=0;u<s;++u)(c=i[u])&&(l=e.call(c,c.__data__,u,i))&&("__data__"in c&&(l.__data__=c.__data__),a[u]=l);return new ge(o,this._parents)}function vc(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function bc(){return[]}function Lr(e){return e==null?bc:function(){return this.querySelectorAll(e)}}function Nc(e){return function(){return vc(e.apply(this,arguments))}}function Ec(e){typeof e=="function"?e=Nc(e):e=Lr(e);for(var t=this._groups,n=t.length,o=[],r=[],i=0;i<n;++i)for(var s=t[i],a=s.length,c,l=0;l<a;++l)(c=s[l])&&(o.push(e.call(c,c.__data__,l,s)),r.push(c));return new ge(o,r)}function Or(e){return function(){return this.matches(e)}}function Vr(e){return function(t){return t.matches(e)}}var _c=Array.prototype.find;function Cc(e){return function(){return _c.call(this.children,e)}}function Sc(){return this.firstElementChild}function kc(e){return this.select(e==null?Sc:Cc(typeof e=="function"?e:Vr(e)))}var Mc=Array.prototype.filter;function Ic(){return Array.from(this.children)}function Ac(e){return function(){return Mc.call(this.children,e)}}function Pc(e){return this.selectAll(e==null?Ic:Ac(typeof e=="function"?e:Vr(e)))}function $c(e){typeof e!="function"&&(e=Or(e));for(var t=this._groups,n=t.length,o=new Array(n),r=0;r<n;++r)for(var i=t[r],s=i.length,a=o[r]=[],c,l=0;l<s;++l)(c=i[l])&&e.call(c,c.__data__,l,i)&&a.push(c);return new ge(o,this._parents)}function Br(e){return new Array(e.length)}function Tc(){return new ge(this._enter||this._groups.map(Br),this._parents)}function Yt(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Yt.prototype={constructor:Yt,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Dc(e){return function(){return e}}function zc(e,t,n,o,r,i){for(var s=0,a,c=t.length,l=i.length;s<l;++s)(a=t[s])?(a.__data__=i[s],o[s]=a):n[s]=new Yt(e,i[s]);for(;s<c;++s)(a=t[s])&&(r[s]=a)}function jc(e,t,n,o,r,i,s){var a,c,l=new Map,u=t.length,f=i.length,d=new Array(u),p;for(a=0;a<u;++a)(c=t[a])&&(d[a]=p=s.call(c,c.__data__,a,t)+"",l.has(p)?r[a]=c:l.set(p,c));for(a=0;a<f;++a)p=s.call(e,i[a],a,i)+"",(c=l.get(p))?(o[a]=c,c.__data__=i[a],l.delete(p)):n[a]=new Yt(e,i[a]);for(a=0;a<u;++a)(c=t[a])&&l.get(d[a])===c&&(r[a]=c)}function Hc(e){return e.__data__}function Rc(e,t){if(!arguments.length)return Array.from(this,Hc);var n=t?jc:zc,o=this._parents,r=this._groups;typeof e!="function"&&(e=Dc(e));for(var i=r.length,s=new Array(i),a=new Array(i),c=new Array(i),l=0;l<i;++l){var u=o[l],f=r[l],d=f.length,p=Lc(e.call(u,u&&u.__data__,l,o)),m=p.length,w=a[l]=new Array(m),v=s[l]=new Array(m),x=c[l]=new Array(d);n(u,f,w,v,x,p,t);for(var N=0,h=0,y,S;N<m;++N)if(y=w[N]){for(N>=h&&(h=N+1);!(S=v[h])&&++h<m;);y._next=S||null}}return s=new ge(s,o),s._enter=a,s._exit=c,s}function Lc(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Oc(){return new ge(this._exit||this._groups.map(Br),this._parents)}function Vc(e,t,n){var o=this.enter(),r=this,i=this.exit();return typeof e=="function"?(o=e(o),o&&(o=o.selection())):o=o.append(e+""),t!=null&&(r=t(r),r&&(r=r.selection())),n==null?i.remove():n(i),o&&r?o.merge(r).order():r}function Bc(e){for(var t=e.selection?e.selection():e,n=this._groups,o=t._groups,r=n.length,i=o.length,s=Math.min(r,i),a=new Array(r),c=0;c<s;++c)for(var l=n[c],u=o[c],f=l.length,d=a[c]=new Array(f),p,m=0;m<f;++m)(p=l[m]||u[m])&&(d[m]=p);for(;c<r;++c)a[c]=n[c];return new ge(a,this._parents)}function Fc(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var o=e[t],r=o.length-1,i=o[r],s;--r>=0;)(s=o[r])&&(i&&s.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(s,i),i=s);return this}function Xc(e){e||(e=Yc);function t(f,d){return f&&d?e(f.__data__,d.__data__):!f-!d}for(var n=this._groups,o=n.length,r=new Array(o),i=0;i<o;++i){for(var s=n[i],a=s.length,c=r[i]=new Array(a),l,u=0;u<a;++u)(l=s[u])&&(c[u]=l);c.sort(t)}return new ge(r,this._parents).order()}function Yc(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Wc(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function Zc(){return Array.from(this)}function qc(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var o=e[t],r=0,i=o.length;r<i;++r){var s=o[r];if(s)return s}return null}function Gc(){let e=0;for(const t of this)++e;return e}function Uc(){return!this.node()}function Kc(e){for(var t=this._groups,n=0,o=t.length;n<o;++n)for(var r=t[n],i=0,s=r.length,a;i<s;++i)(a=r[i])&&e.call(a,a.__data__,i,r);return this}function Qc(e){return function(){this.removeAttribute(e)}}function Jc(e){return function(){this.removeAttributeNS(e.space,e.local)}}function el(e,t){return function(){this.setAttribute(e,t)}}function tl(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function nl(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function ol(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function rl(e,t){var n=rn(e);if(arguments.length<2){var o=this.node();return n.local?o.getAttributeNS(n.space,n.local):o.getAttribute(n)}return this.each((t==null?n.local?Jc:Qc:typeof t=="function"?n.local?ol:nl:n.local?tl:el)(n,t))}function Fr(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function il(e){return function(){this.style.removeProperty(e)}}function sl(e,t,n){return function(){this.style.setProperty(e,t,n)}}function al(e,t,n){return function(){var o=t.apply(this,arguments);o==null?this.style.removeProperty(e):this.style.setProperty(e,o,n)}}function cl(e,t,n){return arguments.length>1?this.each((t==null?il:typeof t=="function"?al:sl)(e,t,n??"")):Ke(this.node(),e)}function Ke(e,t){return e.style.getPropertyValue(t)||Fr(e).getComputedStyle(e,null).getPropertyValue(t)}function ll(e){return function(){delete this[e]}}function ul(e,t){return function(){this[e]=t}}function dl(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function fl(e,t){return arguments.length>1?this.each((t==null?ll:typeof t=="function"?dl:ul)(e,t)):this.node()[e]}function Xr(e){return e.trim().split(/^|\s+/)}function Wn(e){return e.classList||new Yr(e)}function Yr(e){this._node=e,this._names=Xr(e.getAttribute("class")||"")}Yr.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Wr(e,t){for(var n=Wn(e),o=-1,r=t.length;++o<r;)n.add(t[o])}function Zr(e,t){for(var n=Wn(e),o=-1,r=t.length;++o<r;)n.remove(t[o])}function hl(e){return function(){Wr(this,e)}}function gl(e){return function(){Zr(this,e)}}function pl(e,t){return function(){(t.apply(this,arguments)?Wr:Zr)(this,e)}}function ml(e,t){var n=Xr(e+"");if(arguments.length<2){for(var o=Wn(this.node()),r=-1,i=n.length;++r<i;)if(!o.contains(n[r]))return!1;return!0}return this.each((typeof t=="function"?pl:t?hl:gl)(n,t))}function xl(){this.textContent=""}function yl(e){return function(){this.textContent=e}}function wl(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function vl(e){return arguments.length?this.each(e==null?xl:(typeof e=="function"?wl:yl)(e)):this.node().textContent}function bl(){this.innerHTML=""}function Nl(e){return function(){this.innerHTML=e}}function El(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function _l(e){return arguments.length?this.each(e==null?bl:(typeof e=="function"?El:Nl)(e)):this.node().innerHTML}function Cl(){this.nextSibling&&this.parentNode.appendChild(this)}function Sl(){return this.each(Cl)}function kl(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Ml(){return this.each(kl)}function Il(e){var t=typeof e=="function"?e:Rr(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Al(){return null}function Pl(e,t){var n=typeof e=="function"?e:Rr(e),o=t==null?Al:typeof t=="function"?t:Yn(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),o.apply(this,arguments)||null)})}function $l(){var e=this.parentNode;e&&e.removeChild(this)}function Tl(){return this.each($l)}function Dl(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function zl(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function jl(e){return this.select(e?zl:Dl)}function Hl(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Rl(e){return function(t){e.call(this,t,this.__data__)}}function Ll(e){return e.trim().split(/^|\s+/).map(function(t){var n="",o=t.indexOf(".");return o>=0&&(n=t.slice(o+1),t=t.slice(0,o)),{type:t,name:n}})}function Ol(e){return function(){var t=this.__on;if(t){for(var n=0,o=-1,r=t.length,i;n<r;++n)i=t[n],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):t[++o]=i;++o?t.length=o:delete this.__on}}}function Vl(e,t,n){return function(){var o=this.__on,r,i=Rl(t);if(o){for(var s=0,a=o.length;s<a;++s)if((r=o[s]).type===e.type&&r.name===e.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=i,r.options=n),r.value=t;return}}this.addEventListener(e.type,i,n),r={type:e.type,name:e.name,value:t,listener:i,options:n},o?o.push(r):this.__on=[r]}}function Bl(e,t,n){var o=Ll(e+""),r,i=o.length,s;if(arguments.length<2){var a=this.node().__on;if(a){for(var c=0,l=a.length,u;c<l;++c)for(r=0,u=a[c];r<i;++r)if((s=o[r]).type===u.type&&s.name===u.name)return u.value}return}for(a=t?Vl:Ol,r=0;r<i;++r)this.each(a(o[r],t,n));return this}function qr(e,t,n){var o=Fr(e),r=o.CustomEvent;typeof r=="function"?r=new r(t,n):(r=o.document.createEvent("Event"),n?(r.initEvent(t,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(t,!1,!1)),e.dispatchEvent(r)}function Fl(e,t){return function(){return qr(this,e,t)}}function Xl(e,t){return function(){return qr(this,e,t.apply(this,arguments))}}function Yl(e,t){return this.each((typeof t=="function"?Xl:Fl)(e,t))}function*Wl(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var o=e[t],r=0,i=o.length,s;r<i;++r)(s=o[r])&&(yield s)}var Gr=[null];function ge(e,t){this._groups=e,this._parents=t}function Nt(){return new ge([[document.documentElement]],Gr)}function Zl(){return this}ge.prototype=Nt.prototype={constructor:ge,select:wc,selectAll:Ec,selectChild:kc,selectChildren:Pc,filter:$c,data:Rc,enter:Tc,exit:Oc,join:Vc,merge:Bc,selection:Zl,order:Fc,sort:Xc,call:Wc,nodes:Zc,node:qc,size:Gc,empty:Uc,each:Kc,attr:rl,style:cl,property:fl,classed:ml,text:vl,html:_l,raise:Sl,lower:Ml,append:Il,insert:Pl,remove:Tl,clone:jl,datum:Hl,on:Bl,dispatch:Yl,[Symbol.iterator]:Wl};function he(e){return typeof e=="string"?new ge([[document.querySelector(e)]],[document.documentElement]):new ge([[e]],Gr)}function ql(e){let t;for(;t=e.sourceEvent;)e=t;return e}function me(e,t){if(e=ql(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var o=n.createSVGPoint();return o.x=e.clientX,o.y=e.clientY,o=o.matrixTransform(t.getScreenCTM().inverse()),[o.x,o.y]}if(t.getBoundingClientRect){var r=t.getBoundingClientRect();return[e.clientX-r.left-t.clientLeft,e.clientY-r.top-t.clientTop]}}return[e.pageX,e.pageY]}const Gl={passive:!1},ft={capture:!0,passive:!1};function yn(e){e.stopImmediatePropagation()}function Ge(e){e.preventDefault(),e.stopImmediatePropagation()}function Ur(e){var t=e.document.documentElement,n=he(e).on("dragstart.drag",Ge,ft);"onselectstart"in t?n.on("selectstart.drag",Ge,ft):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Kr(e,t){var n=e.document.documentElement,o=he(e).on("dragstart.drag",null);t&&(o.on("click.drag",Ge,ft),setTimeout(function(){o.on("click.drag",null)},0)),"onselectstart"in n?o.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Pt=e=>()=>e;function $n(e,{sourceEvent:t,subject:n,target:o,identifier:r,active:i,x:s,y:a,dx:c,dy:l,dispatch:u}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},identifier:{value:r,enumerable:!0,configurable:!0},active:{value:i,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:l,enumerable:!0,configurable:!0},_:{value:u}})}$n.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function Ul(e){return!e.ctrlKey&&!e.button}function Kl(){return this.parentNode}function Ql(e,t){return t??{x:e.x,y:e.y}}function Jl(){return navigator.maxTouchPoints||"ontouchstart"in this}function Qr(){var e=Ul,t=Kl,n=Ql,o=Jl,r={},i=on("start","drag","end"),s=0,a,c,l,u,f=0;function d(y){y.on("mousedown.drag",p).filter(o).on("touchstart.drag",v).on("touchmove.drag",x,Gl).on("touchend.drag touchcancel.drag",N).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function p(y,S){if(!(u||!e.call(this,y,S))){var E=h(this,t.call(this,y,S),y,S,"mouse");E&&(he(y.view).on("mousemove.drag",m,ft).on("mouseup.drag",w,ft),Ur(y.view),yn(y),l=!1,a=y.clientX,c=y.clientY,E("start",y))}}function m(y){if(Ge(y),!l){var S=y.clientX-a,E=y.clientY-c;l=S*S+E*E>f}r.mouse("drag",y)}function w(y){he(y.view).on("mousemove.drag mouseup.drag",null),Kr(y.view,l),Ge(y),r.mouse("end",y)}function v(y,S){if(e.call(this,y,S)){var E=y.changedTouches,_=t.call(this,y,S),$=E.length,D,F;for(D=0;D<$;++D)(F=h(this,_,y,S,E[D].identifier,E[D]))&&(yn(y),F("start",y,E[D]))}}function x(y){var S=y.changedTouches,E=S.length,_,$;for(_=0;_<E;++_)($=r[S[_].identifier])&&(Ge(y),$("drag",y,S[_]))}function N(y){var S=y.changedTouches,E=S.length,_,$;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),_=0;_<E;++_)($=r[S[_].identifier])&&(yn(y),$("end",y,S[_]))}function h(y,S,E,_,$,D){var F=i.copy(),A=me(D||E,S),z,H,b;if((b=n.call(y,new $n("beforestart",{sourceEvent:E,target:d,identifier:$,active:s,x:A[0],y:A[1],dx:0,dy:0,dispatch:F}),_))!=null)return z=b.x-A[0]||0,H=b.y-A[1]||0,function k(C,P,I){var T=A,j;switch(C){case"start":r[$]=k,j=s++;break;case"end":delete r[$],--s;case"drag":A=me(I||P,S),j=s;break}F.call(C,y,new $n(C,{sourceEvent:P,subject:b,target:d,identifier:$,active:j,x:A[0]+z,y:A[1]+H,dx:A[0]-T[0],dy:A[1]-T[1],dispatch:F}),_)}}return d.filter=function(y){return arguments.length?(e=typeof y=="function"?y:Pt(!!y),d):e},d.container=function(y){return arguments.length?(t=typeof y=="function"?y:Pt(y),d):t},d.subject=function(y){return arguments.length?(n=typeof y=="function"?y:Pt(y),d):n},d.touchable=function(y){return arguments.length?(o=typeof y=="function"?y:Pt(!!y),d):o},d.on=function(){var y=i.on.apply(i,arguments);return y===i?d:y},d.clickDistance=function(y){return arguments.length?(f=(y=+y)*y,d):Math.sqrt(f)},d}function Zn(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Jr(e,t){var n=Object.create(e.prototype);for(var o in t)n[o]=t[o];return n}function Et(){}var ht=.7,Wt=1/ht,Ue="\\s*([+-]?\\d+)\\s*",gt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ne="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",eu=/^#([0-9a-f]{3,8})$/,tu=new RegExp(`^rgb\\(${Ue},${Ue},${Ue}\\)$`),nu=new RegExp(`^rgb\\(${Ne},${Ne},${Ne}\\)$`),ou=new RegExp(`^rgba\\(${Ue},${Ue},${Ue},${gt}\\)$`),ru=new RegExp(`^rgba\\(${Ne},${Ne},${Ne},${gt}\\)$`),iu=new RegExp(`^hsl\\(${gt},${Ne},${Ne}\\)$`),su=new RegExp(`^hsla\\(${gt},${Ne},${Ne},${gt}\\)$`),_o={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Zn(Et,Ve,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Co,formatHex:Co,formatHex8:au,formatHsl:cu,formatRgb:So,toString:So});function Co(){return this.rgb().formatHex()}function au(){return this.rgb().formatHex8()}function cu(){return ei(this).formatHsl()}function So(){return this.rgb().formatRgb()}function Ve(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=eu.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?ko(t):n===3?new fe(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?$t(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?$t(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=tu.exec(e))?new fe(t[1],t[2],t[3],1):(t=nu.exec(e))?new fe(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=ou.exec(e))?$t(t[1],t[2],t[3],t[4]):(t=ru.exec(e))?$t(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=iu.exec(e))?Ao(t[1],t[2]/100,t[3]/100,1):(t=su.exec(e))?Ao(t[1],t[2]/100,t[3]/100,t[4]):_o.hasOwnProperty(e)?ko(_o[e]):e==="transparent"?new fe(NaN,NaN,NaN,0):null}function ko(e){return new fe(e>>16&255,e>>8&255,e&255,1)}function $t(e,t,n,o){return o<=0&&(e=t=n=NaN),new fe(e,t,n,o)}function lu(e){return e instanceof Et||(e=Ve(e)),e?(e=e.rgb(),new fe(e.r,e.g,e.b,e.opacity)):new fe}function Tn(e,t,n,o){return arguments.length===1?lu(e):new fe(e,t,n,o??1)}function fe(e,t,n,o){this.r=+e,this.g=+t,this.b=+n,this.opacity=+o}Zn(fe,Tn,Jr(Et,{brighter(e){return e=e==null?Wt:Math.pow(Wt,e),new fe(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?ht:Math.pow(ht,e),new fe(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new fe(Le(this.r),Le(this.g),Le(this.b),Zt(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Mo,formatHex:Mo,formatHex8:uu,formatRgb:Io,toString:Io}));function Mo(){return`#${Re(this.r)}${Re(this.g)}${Re(this.b)}`}function uu(){return`#${Re(this.r)}${Re(this.g)}${Re(this.b)}${Re((isNaN(this.opacity)?1:this.opacity)*255)}`}function Io(){const e=Zt(this.opacity);return`${e===1?"rgb(":"rgba("}${Le(this.r)}, ${Le(this.g)}, ${Le(this.b)}${e===1?")":`, ${e})`}`}function Zt(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Le(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Re(e){return e=Le(e),(e<16?"0":"")+e.toString(16)}function Ao(e,t,n,o){return o<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new xe(e,t,n,o)}function ei(e){if(e instanceof xe)return new xe(e.h,e.s,e.l,e.opacity);if(e instanceof Et||(e=Ve(e)),!e)return new xe;if(e instanceof xe)return e;e=e.rgb();var t=e.r/255,n=e.g/255,o=e.b/255,r=Math.min(t,n,o),i=Math.max(t,n,o),s=NaN,a=i-r,c=(i+r)/2;return a?(t===i?s=(n-o)/a+(n<o)*6:n===i?s=(o-t)/a+2:s=(t-n)/a+4,a/=c<.5?i+r:2-i-r,s*=60):a=c>0&&c<1?0:s,new xe(s,a,c,e.opacity)}function du(e,t,n,o){return arguments.length===1?ei(e):new xe(e,t,n,o??1)}function xe(e,t,n,o){this.h=+e,this.s=+t,this.l=+n,this.opacity=+o}Zn(xe,du,Jr(Et,{brighter(e){return e=e==null?Wt:Math.pow(Wt,e),new xe(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?ht:Math.pow(ht,e),new xe(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,o=n+(n<.5?n:1-n)*t,r=2*n-o;return new fe(wn(e>=240?e-240:e+120,r,o),wn(e,r,o),wn(e<120?e+240:e-120,r,o),this.opacity)},clamp(){return new xe(Po(this.h),Tt(this.s),Tt(this.l),Zt(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Zt(this.opacity);return`${e===1?"hsl(":"hsla("}${Po(this.h)}, ${Tt(this.s)*100}%, ${Tt(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Po(e){return e=(e||0)%360,e<0?e+360:e}function Tt(e){return Math.max(0,Math.min(1,e||0))}function wn(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const qn=e=>()=>e;function fu(e,t){return function(n){return e+n*t}}function hu(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(o){return Math.pow(e+o*t,n)}}function gu(e){return(e=+e)==1?ti:function(t,n){return n-t?hu(t,n,e):qn(isNaN(t)?n:t)}}function ti(e,t){var n=t-e;return n?fu(e,n):qn(isNaN(e)?t:e)}const qt=(function e(t){var n=gu(t);function o(r,i){var s=n((r=Tn(r)).r,(i=Tn(i)).r),a=n(r.g,i.g),c=n(r.b,i.b),l=ti(r.opacity,i.opacity);return function(u){return r.r=s(u),r.g=a(u),r.b=c(u),r.opacity=l(u),r+""}}return o.gamma=e,o})(1);function pu(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,o=t.slice(),r;return function(i){for(r=0;r<n;++r)o[r]=e[r]*(1-i)+t[r]*i;return o}}function mu(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function xu(e,t){var n=t?t.length:0,o=e?Math.min(n,e.length):0,r=new Array(o),i=new Array(n),s;for(s=0;s<o;++s)r[s]=ut(e[s],t[s]);for(;s<n;++s)i[s]=t[s];return function(a){for(s=0;s<o;++s)i[s]=r[s](a);return i}}function yu(e,t){var n=new Date;return e=+e,t=+t,function(o){return n.setTime(e*(1-o)+t*o),n}}function be(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function wu(e,t){var n={},o={},r;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(r in t)r in e?n[r]=ut(e[r],t[r]):o[r]=t[r];return function(i){for(r in n)o[r]=n[r](i);return o}}var Dn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,vn=new RegExp(Dn.source,"g");function vu(e){return function(){return e}}function bu(e){return function(t){return e(t)+""}}function ni(e,t){var n=Dn.lastIndex=vn.lastIndex=0,o,r,i,s=-1,a=[],c=[];for(e=e+"",t=t+"";(o=Dn.exec(e))&&(r=vn.exec(t));)(i=r.index)>n&&(i=t.slice(n,i),a[s]?a[s]+=i:a[++s]=i),(o=o[0])===(r=r[0])?a[s]?a[s]+=r:a[++s]=r:(a[++s]=null,c.push({i:s,x:be(o,r)})),n=vn.lastIndex;return n<t.length&&(i=t.slice(n),a[s]?a[s]+=i:a[++s]=i),a.length<2?c[0]?bu(c[0].x):vu(t):(t=c.length,function(l){for(var u=0,f;u<t;++u)a[(f=c[u]).i]=f.x(l);return a.join("")})}function ut(e,t){var n=typeof t,o;return t==null||n==="boolean"?qn(t):(n==="number"?be:n==="string"?(o=Ve(t))?(t=o,qt):ni:t instanceof Ve?qt:t instanceof Date?yu:mu(t)?pu:Array.isArray(t)?xu:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?wu:be)(e,t)}var $o=180/Math.PI,zn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function oi(e,t,n,o,r,i){var s,a,c;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(c=e*n+t*o)&&(n-=e*c,o-=t*c),(a=Math.sqrt(n*n+o*o))&&(n/=a,o/=a,c/=a),e*o<t*n&&(e=-e,t=-t,c=-c,s=-s),{translateX:r,translateY:i,rotate:Math.atan2(t,e)*$o,skewX:Math.atan(c)*$o,scaleX:s,scaleY:a}}var Dt;function Nu(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?zn:oi(t.a,t.b,t.c,t.d,t.e,t.f)}function Eu(e){return e==null||(Dt||(Dt=document.createElementNS("http://www.w3.org/2000/svg","g")),Dt.setAttribute("transform",e),!(e=Dt.transform.baseVal.consolidate()))?zn:(e=e.matrix,oi(e.a,e.b,e.c,e.d,e.e,e.f))}function ri(e,t,n,o){function r(l){return l.length?l.pop()+" ":""}function i(l,u,f,d,p,m){if(l!==f||u!==d){var w=p.push("translate(",null,t,null,n);m.push({i:w-4,x:be(l,f)},{i:w-2,x:be(u,d)})}else(f||d)&&p.push("translate("+f+t+d+n)}function s(l,u,f,d){l!==u?(l-u>180?u+=360:u-l>180&&(l+=360),d.push({i:f.push(r(f)+"rotate(",null,o)-2,x:be(l,u)})):u&&f.push(r(f)+"rotate("+u+o)}function a(l,u,f,d){l!==u?d.push({i:f.push(r(f)+"skewX(",null,o)-2,x:be(l,u)}):u&&f.push(r(f)+"skewX("+u+o)}function c(l,u,f,d,p,m){if(l!==f||u!==d){var w=p.push(r(p)+"scale(",null,",",null,")");m.push({i:w-4,x:be(l,f)},{i:w-2,x:be(u,d)})}else(f!==1||d!==1)&&p.push(r(p)+"scale("+f+","+d+")")}return function(l,u){var f=[],d=[];return l=e(l),u=e(u),i(l.translateX,l.translateY,u.translateX,u.translateY,f,d),s(l.rotate,u.rotate,f,d),a(l.skewX,u.skewX,f,d),c(l.scaleX,l.scaleY,u.scaleX,u.scaleY,f,d),l=u=null,function(p){for(var m=-1,w=d.length,v;++m<w;)f[(v=d[m]).i]=v.x(p);return f.join("")}}}var _u=ri(Nu,"px, ","px)","deg)"),Cu=ri(Eu,", ",")",")"),Su=1e-12;function To(e){return((e=Math.exp(e))+1/e)/2}function ku(e){return((e=Math.exp(e))-1/e)/2}function Mu(e){return((e=Math.exp(2*e))-1)/(e+1)}const Vt=(function e(t,n,o){function r(i,s){var a=i[0],c=i[1],l=i[2],u=s[0],f=s[1],d=s[2],p=u-a,m=f-c,w=p*p+m*m,v,x;if(w<Su)x=Math.log(d/l)/t,v=function(_){return[a+_*p,c+_*m,l*Math.exp(t*_*x)]};else{var N=Math.sqrt(w),h=(d*d-l*l+o*w)/(2*l*n*N),y=(d*d-l*l-o*w)/(2*d*n*N),S=Math.log(Math.sqrt(h*h+1)-h),E=Math.log(Math.sqrt(y*y+1)-y);x=(E-S)/t,v=function(_){var $=_*x,D=To(S),F=l/(n*N)*(D*Mu(t*$+S)-ku(S));return[a+F*p,c+F*m,l*D/To(t*$+S)]}}return v.duration=x*1e3*t/Math.SQRT2,v}return r.rho=function(i){var s=Math.max(.001,+i),a=s*s,c=a*a;return e(s,a,c)},r})(Math.SQRT2,2,4);var Qe=0,ct=0,st=0,ii=1e3,Gt,lt,Ut=0,Be=0,sn=0,pt=typeof performance=="object"&&performance.now?performance:Date,si=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Gn(){return Be||(si(Iu),Be=pt.now()+sn)}function Iu(){Be=0}function Kt(){this._call=this._time=this._next=null}Kt.prototype=ai.prototype={constructor:Kt,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Gn():+n)+(t==null?0:+t),!this._next&&lt!==this&&(lt?lt._next=this:Gt=this,lt=this),this._call=e,this._time=n,jn()},stop:function(){this._call&&(this._call=null,this._time=1/0,jn())}};function ai(e,t,n){var o=new Kt;return o.restart(e,t,n),o}function Au(){Gn(),++Qe;for(var e=Gt,t;e;)(t=Be-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Qe}function Do(){Be=(Ut=pt.now())+sn,Qe=ct=0;try{Au()}finally{Qe=0,$u(),Be=0}}function Pu(){var e=pt.now(),t=e-Ut;t>ii&&(sn-=t,Ut=e)}function $u(){for(var e,t=Gt,n,o=1/0;t;)t._call?(o>t._time&&(o=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Gt=n);lt=e,jn(o)}function jn(e){if(!Qe){ct&&(ct=clearTimeout(ct));var t=e-Be;t>24?(e<1/0&&(ct=setTimeout(Do,e-pt.now()-sn)),st&&(st=clearInterval(st))):(st||(Ut=pt.now(),st=setInterval(Pu,ii)),Qe=1,si(Do))}}function zo(e,t,n){var o=new Kt;return t=t==null?0:+t,o.restart(r=>{o.stop(),e(r+t)},t,n),o}var Tu=on("start","end","cancel","interrupt"),Du=[],ci=0,jo=1,Hn=2,Bt=3,Ho=4,Rn=5,Ft=6;function an(e,t,n,o,r,i){var s=e.__transition;if(!s)e.__transition={};else if(n in s)return;zu(e,n,{name:t,index:o,group:r,on:Tu,tween:Du,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:ci})}function Un(e,t){var n=ve(e,t);if(n.state>ci)throw new Error("too late; already scheduled");return n}function _e(e,t){var n=ve(e,t);if(n.state>Bt)throw new Error("too late; already running");return n}function ve(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function zu(e,t,n){var o=e.__transition,r;o[t]=n,n.timer=ai(i,0,n.time);function i(l){n.state=jo,n.timer.restart(s,n.delay,n.time),n.delay<=l&&s(l-n.delay)}function s(l){var u,f,d,p;if(n.state!==jo)return c();for(u in o)if(p=o[u],p.name===n.name){if(p.state===Bt)return zo(s);p.state===Ho?(p.state=Ft,p.timer.stop(),p.on.call("interrupt",e,e.__data__,p.index,p.group),delete o[u]):+u<t&&(p.state=Ft,p.timer.stop(),p.on.call("cancel",e,e.__data__,p.index,p.group),delete o[u])}if(zo(function(){n.state===Bt&&(n.state=Ho,n.timer.restart(a,n.delay,n.time),a(l))}),n.state=Hn,n.on.call("start",e,e.__data__,n.index,n.group),n.state===Hn){for(n.state=Bt,r=new Array(d=n.tween.length),u=0,f=-1;u<d;++u)(p=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(r[++f]=p);r.length=f+1}}function a(l){for(var u=l<n.duration?n.ease.call(null,l/n.duration):(n.timer.restart(c),n.state=Rn,1),f=-1,d=r.length;++f<d;)r[f].call(e,u);n.state===Rn&&(n.on.call("end",e,e.__data__,n.index,n.group),c())}function c(){n.state=Ft,n.timer.stop(),delete o[t];for(var l in o)return;delete e.__transition}}function Xt(e,t){var n=e.__transition,o,r,i=!0,s;if(n){t=t==null?null:t+"";for(s in n){if((o=n[s]).name!==t){i=!1;continue}r=o.state>Hn&&o.state<Rn,o.state=Ft,o.timer.stop(),o.on.call(r?"interrupt":"cancel",e,e.__data__,o.index,o.group),delete n[s]}i&&delete e.__transition}}function ju(e){return this.each(function(){Xt(this,e)})}function Hu(e,t){var n,o;return function(){var r=_e(this,e),i=r.tween;if(i!==n){o=n=i;for(var s=0,a=o.length;s<a;++s)if(o[s].name===t){o=o.slice(),o.splice(s,1);break}}r.tween=o}}function Ru(e,t,n){var o,r;if(typeof n!="function")throw new Error;return function(){var i=_e(this,e),s=i.tween;if(s!==o){r=(o=s).slice();for(var a={name:t,value:n},c=0,l=r.length;c<l;++c)if(r[c].name===t){r[c]=a;break}c===l&&r.push(a)}i.tween=r}}function Lu(e,t){var n=this._id;if(e+="",arguments.length<2){for(var o=ve(this.node(),n).tween,r=0,i=o.length,s;r<i;++r)if((s=o[r]).name===e)return s.value;return null}return this.each((t==null?Hu:Ru)(n,e,t))}function Kn(e,t,n){var o=e._id;return e.each(function(){var r=_e(this,o);(r.value||(r.value={}))[t]=n.apply(this,arguments)}),function(r){return ve(r,o).value[t]}}function li(e,t){var n;return(typeof t=="number"?be:t instanceof Ve?qt:(n=Ve(t))?(t=n,qt):ni)(e,t)}function Ou(e){return function(){this.removeAttribute(e)}}function Vu(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Bu(e,t,n){var o,r=n+"",i;return function(){var s=this.getAttribute(e);return s===r?null:s===o?i:i=t(o=s,n)}}function Fu(e,t,n){var o,r=n+"",i;return function(){var s=this.getAttributeNS(e.space,e.local);return s===r?null:s===o?i:i=t(o=s,n)}}function Xu(e,t,n){var o,r,i;return function(){var s,a=n(this),c;return a==null?void this.removeAttribute(e):(s=this.getAttribute(e),c=a+"",s===c?null:s===o&&c===r?i:(r=c,i=t(o=s,a)))}}function Yu(e,t,n){var o,r,i;return function(){var s,a=n(this),c;return a==null?void this.removeAttributeNS(e.space,e.local):(s=this.getAttributeNS(e.space,e.local),c=a+"",s===c?null:s===o&&c===r?i:(r=c,i=t(o=s,a)))}}function Wu(e,t){var n=rn(e),o=n==="transform"?Cu:li;return this.attrTween(e,typeof t=="function"?(n.local?Yu:Xu)(n,o,Kn(this,"attr."+e,t)):t==null?(n.local?Vu:Ou)(n):(n.local?Fu:Bu)(n,o,t))}function Zu(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function qu(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function Gu(e,t){var n,o;function r(){var i=t.apply(this,arguments);return i!==o&&(n=(o=i)&&qu(e,i)),n}return r._value=t,r}function Uu(e,t){var n,o;function r(){var i=t.apply(this,arguments);return i!==o&&(n=(o=i)&&Zu(e,i)),n}return r._value=t,r}function Ku(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var o=rn(e);return this.tween(n,(o.local?Gu:Uu)(o,t))}function Qu(e,t){return function(){Un(this,e).delay=+t.apply(this,arguments)}}function Ju(e,t){return t=+t,function(){Un(this,e).delay=t}}function ed(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Qu:Ju)(t,e)):ve(this.node(),t).delay}function td(e,t){return function(){_e(this,e).duration=+t.apply(this,arguments)}}function nd(e,t){return t=+t,function(){_e(this,e).duration=t}}function od(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?td:nd)(t,e)):ve(this.node(),t).duration}function rd(e,t){if(typeof t!="function")throw new Error;return function(){_e(this,e).ease=t}}function id(e){var t=this._id;return arguments.length?this.each(rd(t,e)):ve(this.node(),t).ease}function sd(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;_e(this,e).ease=n}}function ad(e){if(typeof e!="function")throw new Error;return this.each(sd(this._id,e))}function cd(e){typeof e!="function"&&(e=Or(e));for(var t=this._groups,n=t.length,o=new Array(n),r=0;r<n;++r)for(var i=t[r],s=i.length,a=o[r]=[],c,l=0;l<s;++l)(c=i[l])&&e.call(c,c.__data__,l,i)&&a.push(c);return new Me(o,this._parents,this._name,this._id)}function ld(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,o=t.length,r=n.length,i=Math.min(o,r),s=new Array(o),a=0;a<i;++a)for(var c=t[a],l=n[a],u=c.length,f=s[a]=new Array(u),d,p=0;p<u;++p)(d=c[p]||l[p])&&(f[p]=d);for(;a<o;++a)s[a]=t[a];return new Me(s,this._parents,this._name,this._id)}function ud(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function dd(e,t,n){var o,r,i=ud(t)?Un:_e;return function(){var s=i(this,e),a=s.on;a!==o&&(r=(o=a).copy()).on(t,n),s.on=r}}function fd(e,t){var n=this._id;return arguments.length<2?ve(this.node(),n).on.on(e):this.each(dd(n,e,t))}function hd(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function gd(){return this.on("end.remove",hd(this._id))}function pd(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Yn(e));for(var o=this._groups,r=o.length,i=new Array(r),s=0;s<r;++s)for(var a=o[s],c=a.length,l=i[s]=new Array(c),u,f,d=0;d<c;++d)(u=a[d])&&(f=e.call(u,u.__data__,d,a))&&("__data__"in u&&(f.__data__=u.__data__),l[d]=f,an(l[d],t,n,d,l,ve(u,n)));return new Me(i,this._parents,t,n)}function md(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Lr(e));for(var o=this._groups,r=o.length,i=[],s=[],a=0;a<r;++a)for(var c=o[a],l=c.length,u,f=0;f<l;++f)if(u=c[f]){for(var d=e.call(u,u.__data__,f,c),p,m=ve(u,n),w=0,v=d.length;w<v;++w)(p=d[w])&&an(p,t,n,w,d,m);i.push(d),s.push(u)}return new Me(i,s,t,n)}var xd=Nt.prototype.constructor;function yd(){return new xd(this._groups,this._parents)}function wd(e,t){var n,o,r;return function(){var i=Ke(this,e),s=(this.style.removeProperty(e),Ke(this,e));return i===s?null:i===n&&s===o?r:r=t(n=i,o=s)}}function ui(e){return function(){this.style.removeProperty(e)}}function vd(e,t,n){var o,r=n+"",i;return function(){var s=Ke(this,e);return s===r?null:s===o?i:i=t(o=s,n)}}function bd(e,t,n){var o,r,i;return function(){var s=Ke(this,e),a=n(this),c=a+"";return a==null&&(c=a=(this.style.removeProperty(e),Ke(this,e))),s===c?null:s===o&&c===r?i:(r=c,i=t(o=s,a))}}function Nd(e,t){var n,o,r,i="style."+t,s="end."+i,a;return function(){var c=_e(this,e),l=c.on,u=c.value[i]==null?a||(a=ui(t)):void 0;(l!==n||r!==u)&&(o=(n=l).copy()).on(s,r=u),c.on=o}}function Ed(e,t,n){var o=(e+="")=="transform"?_u:li;return t==null?this.styleTween(e,wd(e,o)).on("end.style."+e,ui(e)):typeof t=="function"?this.styleTween(e,bd(e,o,Kn(this,"style."+e,t))).each(Nd(this._id,e)):this.styleTween(e,vd(e,o,t),n).on("end.style."+e,null)}function _d(e,t,n){return function(o){this.style.setProperty(e,t.call(this,o),n)}}function Cd(e,t,n){var o,r;function i(){var s=t.apply(this,arguments);return s!==r&&(o=(r=s)&&_d(e,s,n)),o}return i._value=t,i}function Sd(e,t,n){var o="style."+(e+="");if(arguments.length<2)return(o=this.tween(o))&&o._value;if(t==null)return this.tween(o,null);if(typeof t!="function")throw new Error;return this.tween(o,Cd(e,t,n??""))}function kd(e){return function(){this.textContent=e}}function Md(e){return function(){var t=e(this);this.textContent=t??""}}function Id(e){return this.tween("text",typeof e=="function"?Md(Kn(this,"text",e)):kd(e==null?"":e+""))}function Ad(e){return function(t){this.textContent=e.call(this,t)}}function Pd(e){var t,n;function o(){var r=e.apply(this,arguments);return r!==n&&(t=(n=r)&&Ad(r)),t}return o._value=e,o}function $d(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,Pd(e))}function Td(){for(var e=this._name,t=this._id,n=di(),o=this._groups,r=o.length,i=0;i<r;++i)for(var s=o[i],a=s.length,c,l=0;l<a;++l)if(c=s[l]){var u=ve(c,t);an(c,e,n,l,s,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new Me(o,this._parents,e,n)}function Dd(){var e,t,n=this,o=n._id,r=n.size();return new Promise(function(i,s){var a={value:s},c={value:function(){--r===0&&i()}};n.each(function(){var l=_e(this,o),u=l.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(c)),l.on=t}),r===0&&i()})}var zd=0;function Me(e,t,n,o){this._groups=e,this._parents=t,this._name=n,this._id=o}function di(){return++zd}var Ce=Nt.prototype;Me.prototype={constructor:Me,select:pd,selectAll:md,selectChild:Ce.selectChild,selectChildren:Ce.selectChildren,filter:cd,merge:ld,selection:yd,transition:Td,call:Ce.call,nodes:Ce.nodes,node:Ce.node,size:Ce.size,empty:Ce.empty,each:Ce.each,on:fd,attr:Wu,attrTween:Ku,style:Ed,styleTween:Sd,text:Id,textTween:$d,remove:gd,tween:Lu,delay:ed,duration:od,ease:id,easeVarying:ad,end:Dd,[Symbol.iterator]:Ce[Symbol.iterator]};function jd(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Hd={time:null,delay:0,duration:250,ease:jd};function Rd(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function Ld(e){var t,n;e instanceof Me?(t=e._id,e=e._name):(t=di(),(n=Hd).time=Gn(),e=e==null?null:e+"");for(var o=this._groups,r=o.length,i=0;i<r;++i)for(var s=o[i],a=s.length,c,l=0;l<a;++l)(c=s[l])&&an(c,e,t,l,s,n||Rd(c,t));return new Me(o,this._parents,e,t)}Nt.prototype.interrupt=ju;Nt.prototype.transition=Ld;const zt=e=>()=>e;function Od(e,{sourceEvent:t,target:n,transform:o,dispatch:r}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:o,enumerable:!0,configurable:!0},_:{value:r}})}function Se(e,t,n){this.k=e,this.x=t,this.y=n}Se.prototype={constructor:Se,scale:function(e){return e===1?this:new Se(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Se(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var cn=new Se(1,0,0);fi.prototype=Se.prototype;function fi(e){for(;!e.__zoom;)if(!(e=e.parentNode))return cn;return e.__zoom}function bn(e){e.stopImmediatePropagation()}function at(e){e.preventDefault(),e.stopImmediatePropagation()}function Vd(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Bd(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function Ro(){return this.__zoom||cn}function Fd(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Xd(){return navigator.maxTouchPoints||"ontouchstart"in this}function Yd(e,t,n){var o=e.invertX(t[0][0])-n[0][0],r=e.invertX(t[1][0])-n[1][0],i=e.invertY(t[0][1])-n[0][1],s=e.invertY(t[1][1])-n[1][1];return e.translate(r>o?(o+r)/2:Math.min(0,o)||Math.max(0,r),s>i?(i+s)/2:Math.min(0,i)||Math.max(0,s))}function hi(){var e=Vd,t=Bd,n=Yd,o=Fd,r=Xd,i=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],a=250,c=Vt,l=on("start","zoom","end"),u,f,d,p=500,m=150,w=0,v=10;function x(b){b.property("__zoom",Ro).on("wheel.zoom",$,{passive:!1}).on("mousedown.zoom",D).on("dblclick.zoom",F).filter(r).on("touchstart.zoom",A).on("touchmove.zoom",z).on("touchend.zoom touchcancel.zoom",H).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}x.transform=function(b,k,C,P){var I=b.selection?b.selection():b;I.property("__zoom",Ro),b!==I?S(b,k,C,P):I.interrupt().each(function(){E(this,arguments).event(P).start().zoom(null,typeof k=="function"?k.apply(this,arguments):k).end()})},x.scaleBy=function(b,k,C,P){x.scaleTo(b,function(){var I=this.__zoom.k,T=typeof k=="function"?k.apply(this,arguments):k;return I*T},C,P)},x.scaleTo=function(b,k,C,P){x.transform(b,function(){var I=t.apply(this,arguments),T=this.__zoom,j=C==null?y(I):typeof C=="function"?C.apply(this,arguments):C,V=T.invert(j),O=typeof k=="function"?k.apply(this,arguments):k;return n(h(N(T,O),j,V),I,s)},C,P)},x.translateBy=function(b,k,C,P){x.transform(b,function(){return n(this.__zoom.translate(typeof k=="function"?k.apply(this,arguments):k,typeof C=="function"?C.apply(this,arguments):C),t.apply(this,arguments),s)},null,P)},x.translateTo=function(b,k,C,P,I){x.transform(b,function(){var T=t.apply(this,arguments),j=this.__zoom,V=P==null?y(T):typeof P=="function"?P.apply(this,arguments):P;return n(cn.translate(V[0],V[1]).scale(j.k).translate(typeof k=="function"?-k.apply(this,arguments):-k,typeof C=="function"?-C.apply(this,arguments):-C),T,s)},P,I)};function N(b,k){return k=Math.max(i[0],Math.min(i[1],k)),k===b.k?b:new Se(k,b.x,b.y)}function h(b,k,C){var P=k[0]-C[0]*b.k,I=k[1]-C[1]*b.k;return P===b.x&&I===b.y?b:new Se(b.k,P,I)}function y(b){return[(+b[0][0]+ +b[1][0])/2,(+b[0][1]+ +b[1][1])/2]}function S(b,k,C,P){b.on("start.zoom",function(){E(this,arguments).event(P).start()}).on("interrupt.zoom end.zoom",function(){E(this,arguments).event(P).end()}).tween("zoom",function(){var I=this,T=arguments,j=E(I,T).event(P),V=t.apply(I,T),O=C==null?y(V):typeof C=="function"?C.apply(I,T):C,W=Math.max(V[1][0]-V[0][0],V[1][1]-V[0][1]),Y=I.__zoom,Q=typeof k=="function"?k.apply(I,T):k,ne=c(Y.invert(O).concat(W/Y.k),Q.invert(O).concat(W/Q.k));return function(K){if(K===1)K=Q;else{var X=ne(K),U=W/X[2];K=new Se(U,O[0]-X[0]*U,O[1]-X[1]*U)}j.zoom(null,K)}})}function E(b,k,C){return!C&&b.__zooming||new _(b,k)}function _(b,k){this.that=b,this.args=k,this.active=0,this.sourceEvent=null,this.extent=t.apply(b,k),this.taps=0}_.prototype={event:function(b){return b&&(this.sourceEvent=b),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(b,k){return this.mouse&&b!=="mouse"&&(this.mouse[1]=k.invert(this.mouse[0])),this.touch0&&b!=="touch"&&(this.touch0[1]=k.invert(this.touch0[0])),this.touch1&&b!=="touch"&&(this.touch1[1]=k.invert(this.touch1[0])),this.that.__zoom=k,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(b){var k=he(this.that).datum();l.call(b,this.that,new Od(b,{sourceEvent:this.sourceEvent,target:x,transform:this.that.__zoom,dispatch:l}),k)}};function $(b,...k){if(!e.apply(this,arguments))return;var C=E(this,k).event(b),P=this.__zoom,I=Math.max(i[0],Math.min(i[1],P.k*Math.pow(2,o.apply(this,arguments)))),T=me(b);if(C.wheel)(C.mouse[0][0]!==T[0]||C.mouse[0][1]!==T[1])&&(C.mouse[1]=P.invert(C.mouse[0]=T)),clearTimeout(C.wheel);else{if(P.k===I)return;C.mouse=[T,P.invert(T)],Xt(this),C.start()}at(b),C.wheel=setTimeout(j,m),C.zoom("mouse",n(h(N(P,I),C.mouse[0],C.mouse[1]),C.extent,s));function j(){C.wheel=null,C.end()}}function D(b,...k){if(d||!e.apply(this,arguments))return;var C=b.currentTarget,P=E(this,k,!0).event(b),I=he(b.view).on("mousemove.zoom",O,!0).on("mouseup.zoom",W,!0),T=me(b,C),j=b.clientX,V=b.clientY;Ur(b.view),bn(b),P.mouse=[T,this.__zoom.invert(T)],Xt(this),P.start();function O(Y){if(at(Y),!P.moved){var Q=Y.clientX-j,ne=Y.clientY-V;P.moved=Q*Q+ne*ne>w}P.event(Y).zoom("mouse",n(h(P.that.__zoom,P.mouse[0]=me(Y,C),P.mouse[1]),P.extent,s))}function W(Y){I.on("mousemove.zoom mouseup.zoom",null),Kr(Y.view,P.moved),at(Y),P.event(Y).end()}}function F(b,...k){if(e.apply(this,arguments)){var C=this.__zoom,P=me(b.changedTouches?b.changedTouches[0]:b,this),I=C.invert(P),T=C.k*(b.shiftKey?.5:2),j=n(h(N(C,T),P,I),t.apply(this,k),s);at(b),a>0?he(this).transition().duration(a).call(S,j,P,b):he(this).call(x.transform,j,P,b)}}function A(b,...k){if(e.apply(this,arguments)){var C=b.touches,P=C.length,I=E(this,k,b.changedTouches.length===P).event(b),T,j,V,O;for(bn(b),j=0;j<P;++j)V=C[j],O=me(V,this),O=[O,this.__zoom.invert(O),V.identifier],I.touch0?!I.touch1&&I.touch0[2]!==O[2]&&(I.touch1=O,I.taps=0):(I.touch0=O,T=!0,I.taps=1+!!u);u&&(u=clearTimeout(u)),T&&(I.taps<2&&(f=O[0],u=setTimeout(function(){u=null},p)),Xt(this),I.start())}}function z(b,...k){if(this.__zooming){var C=E(this,k).event(b),P=b.changedTouches,I=P.length,T,j,V,O;for(at(b),T=0;T<I;++T)j=P[T],V=me(j,this),C.touch0&&C.touch0[2]===j.identifier?C.touch0[0]=V:C.touch1&&C.touch1[2]===j.identifier&&(C.touch1[0]=V);if(j=C.that.__zoom,C.touch1){var W=C.touch0[0],Y=C.touch0[1],Q=C.touch1[0],ne=C.touch1[1],K=(K=Q[0]-W[0])*K+(K=Q[1]-W[1])*K,X=(X=ne[0]-Y[0])*X+(X=ne[1]-Y[1])*X;j=N(j,Math.sqrt(K/X)),V=[(W[0]+Q[0])/2,(W[1]+Q[1])/2],O=[(Y[0]+ne[0])/2,(Y[1]+ne[1])/2]}else if(C.touch0)V=C.touch0[0],O=C.touch0[1];else return;C.zoom("touch",n(h(j,V,O),C.extent,s))}}function H(b,...k){if(this.__zooming){var C=E(this,k).event(b),P=b.changedTouches,I=P.length,T,j;for(bn(b),d&&clearTimeout(d),d=setTimeout(function(){d=null},p),T=0;T<I;++T)j=P[T],C.touch0&&C.touch0[2]===j.identifier?delete C.touch0:C.touch1&&C.touch1[2]===j.identifier&&delete C.touch1;if(C.touch1&&!C.touch0&&(C.touch0=C.touch1,delete C.touch1),C.touch0)C.touch0[1]=this.__zoom.invert(C.touch0[0]);else if(C.end(),C.taps===2&&(j=me(j,this),Math.hypot(f[0]-j[0],f[1]-j[1])<v)){var V=he(this).on("dblclick.zoom");V&&V.apply(this,arguments)}}}return x.wheelDelta=function(b){return arguments.length?(o=typeof b=="function"?b:zt(+b),x):o},x.filter=function(b){return arguments.length?(e=typeof b=="function"?b:zt(!!b),x):e},x.touchable=function(b){return arguments.length?(r=typeof b=="function"?b:zt(!!b),x):r},x.extent=function(b){return arguments.length?(t=typeof b=="function"?b:zt([[+b[0][0],+b[0][1]],[+b[1][0],+b[1][1]]]),x):t},x.scaleExtent=function(b){return arguments.length?(i[0]=+b[0],i[1]=+b[1],x):[i[0],i[1]]},x.translateExtent=function(b){return arguments.length?(s[0][0]=+b[0][0],s[1][0]=+b[1][0],s[0][1]=+b[0][1],s[1][1]=+b[1][1],x):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},x.constrain=function(b){return arguments.length?(n=b,x):n},x.duration=function(b){return arguments.length?(a=+b,x):a},x.interpolate=function(b){return arguments.length?(c=b,x):c},x.on=function(){var b=l.on.apply(l,arguments);return b===l?x:b},x.clickDistance=function(b){return arguments.length?(w=(b=+b)*b,x):Math.sqrt(w)},x.tapDistance=function(b){return arguments.length?(v=+b,x):v},x}const Ee={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:n,targetHandle:o})=>`Couldn't create edge for ${e} handle id: "${e==="source"?n:o}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},mt=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],gi=["Enter"," ","Escape"],pi={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":({direction:e,x:t,y:n})=>`Moved selected node ${e}. New position, x: ${t}, y: ${n}`,"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};var Je;(function(e){e.Strict="strict",e.Loose="loose"})(Je||(Je={}));var Oe;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(Oe||(Oe={}));var xt;(function(e){e.Partial="partial",e.Full="full"})(xt||(xt={}));const mi={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null,pointer:null};var Te;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(Te||(Te={}));var Qt;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(Qt||(Qt={}));var Z;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(Z||(Z={}));const Lo={[Z.Left]:Z.Right,[Z.Right]:Z.Left,[Z.Top]:Z.Bottom,[Z.Bottom]:Z.Top};function Wd(e,t){if(!e&&!t)return!0;if(!e||!t||e.size!==t.size)return!1;if(!e.size&&!t.size)return!0;for(const n of e.keys())if(!t.has(n))return!1;return!0}function Oo(e,t,n){if(!n)return;const o=[];e.forEach((r,i)=>{t?.has(i)||o.push(r)}),o.length&&n(o)}function xi(e){return e===null?null:e?"valid":"invalid"}const yi=e=>"id"in e&&"source"in e&&"target"in e,Zd=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),Qn=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),_t=(e,t=[0,0])=>{const{width:n,height:o}=Ie(e),r=e.origin??t,i=n*r[0],s=o*r[1];return{x:e.position.x-i,y:e.position.y-s}},qd=(e,t={nodeOrigin:[0,0]})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((o,r)=>{const i=typeof r=="string";let s=!t.nodeLookup&&!i?r:void 0;t.nodeLookup&&(s=i?t.nodeLookup.get(r):Qn(r)?r:t.nodeLookup.get(r.id));const a=s?Jt(s,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return ln(o,a)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return un(n)},Ct=(e,t={})=>{let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0},o=!1;return e.forEach(r=>{(t.filter===void 0||t.filter(r))&&(n=ln(n,Jt(r)),o=!0)}),o?un(n):{x:0,y:0,width:0,height:0}},Jn=(e,t,[n,o,r]=[0,0,1],i=!1,s=!1)=>{const a={...kt(t,[n,o,r]),width:t.width/r,height:t.height/r},c=[];for(const l of e.values()){const{measured:u,selectable:f=!0,hidden:d=!1}=l;if(s&&!f||d)continue;const p=u.width??l.width??l.initialWidth??null,m=u.height??l.height??l.initialHeight??null,w=yt(a,tt(l)),v=(p??0)*(m??0),x=i&&w>0;(!l.internals.handleBounds||x||w>=v||l.dragging)&&c.push(l)}return c},Gd=(e,t)=>{const n=new Set;return e.forEach(o=>{n.add(o.id)}),t.filter(o=>n.has(o.source)||n.has(o.target))};function Ud(e,t){const n=new Map,o=t?.nodes?new Set(t.nodes.map(r=>r.id)):null;return e.forEach(r=>{r.measured.width&&r.measured.height&&(t?.includeHiddenNodes||!r.hidden)&&(!o||o.has(r.id))&&n.set(r.id,r)}),n}async function Kd({nodes:e,width:t,height:n,panZoom:o,minZoom:r,maxZoom:i},s){if(e.size===0)return Promise.resolve(!0);const a=Ud(e,s),c=Ct(a),l=eo(c,t,n,s?.minZoom??r,s?.maxZoom??i,s?.padding??.1);return await o.setViewport(l,{duration:s?.duration,ease:s?.ease,interpolate:s?.interpolate}),Promise.resolve(!0)}function wi({nodeId:e,nextPosition:t,nodeLookup:n,nodeOrigin:o=[0,0],nodeExtent:r,onError:i}){const s=n.get(e),a=s.parentId?n.get(s.parentId):void 0,{x:c,y:l}=a?a.internals.positionAbsolute:{x:0,y:0},u=s.origin??o;let f=s.extent||r;if(s.extent==="parent"&&!s.expandParent)if(!a)i?.("005",Ee.error005());else{const p=a.measured.width,m=a.measured.height;p&&m&&(f=[[c,l],[c+p,l+m]])}else a&&nt(s.extent)&&(f=[[s.extent[0][0]+c,s.extent[0][1]+l],[s.extent[1][0]+c,s.extent[1][1]+l]]);const d=nt(f)?Fe(t,f,s.measured):t;return(s.measured.width===void 0||s.measured.height===void 0)&&i?.("015",Ee.error015()),{position:{x:d.x-c+(s.measured.width??0)*u[0],y:d.y-l+(s.measured.height??0)*u[1]},positionAbsolute:d}}async function Qd({nodesToRemove:e=[],edgesToRemove:t=[],nodes:n,edges:o,onBeforeDelete:r}){const i=new Set(e.map(d=>d.id)),s=[];for(const d of n){if(d.deletable===!1)continue;const p=i.has(d.id),m=!p&&d.parentId&&s.find(w=>w.id===d.parentId);(p||m)&&s.push(d)}const a=new Set(t.map(d=>d.id)),c=o.filter(d=>d.deletable!==!1),u=Gd(s,c);for(const d of c)a.has(d.id)&&!u.find(m=>m.id===d.id)&&u.push(d);if(!r)return{edges:u,nodes:s};const f=await r({nodes:s,edges:u});return typeof f=="boolean"?f?{edges:u,nodes:s}:{edges:[],nodes:[]}:f}const et=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),Fe=(e={x:0,y:0},t,n)=>({x:et(e.x,t[0][0],t[1][0]-(n?.width??0)),y:et(e.y,t[0][1],t[1][1]-(n?.height??0))});function vi(e,t,n){const{width:o,height:r}=Ie(n),{x:i,y:s}=n.internals.positionAbsolute;return Fe(e,[[i,s],[i+o,s+r]],t)}const Vo=(e,t,n)=>e<t?et(Math.abs(e-t),1,t)/t:e>n?-et(Math.abs(e-n),1,t)/t:0,bi=(e,t,n=15,o=40)=>{const r=Vo(e.x,o,t.width-o)*n,i=Vo(e.y,o,t.height-o)*n;return[r,i]},ln=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),Ln=({x:e,y:t,width:n,height:o})=>({x:e,y:t,x2:e+n,y2:t+o}),un=({x:e,y:t,x2:n,y2:o})=>({x:e,y:t,width:n-e,height:o-t}),tt=(e,t=[0,0])=>{const{x:n,y:o}=Qn(e)?e.internals.positionAbsolute:_t(e,t);return{x:n,y:o,width:e.measured?.width??e.width??e.initialWidth??0,height:e.measured?.height??e.height??e.initialHeight??0}},Jt=(e,t=[0,0])=>{const{x:n,y:o}=Qn(e)?e.internals.positionAbsolute:_t(e,t);return{x:n,y:o,x2:n+(e.measured?.width??e.width??e.initialWidth??0),y2:o+(e.measured?.height??e.height??e.initialHeight??0)}},Ni=(e,t)=>un(ln(Ln(e),Ln(t))),yt=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),o=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*o)},Bo=e=>ye(e.width)&&ye(e.height)&&ye(e.x)&&ye(e.y),ye=e=>!isNaN(e)&&isFinite(e),Jd=(e,t)=>{},St=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),kt=({x:e,y:t},[n,o,r],i=!1,s=[1,1])=>{const a={x:(e-n)/r,y:(t-o)/r};return i?St(a,s):a},en=({x:e,y:t},[n,o,r])=>({x:e*r+n,y:t*r+o});function We(e,t){if(typeof e=="number")return Math.floor((t-t/(1+e))*.5);if(typeof e=="string"&&e.endsWith("px")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(n)}if(typeof e=="string"&&e.endsWith("%")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(t*n*.01)}return console.error(`[React Flow] The padding value "${e}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function ef(e,t,n){if(typeof e=="string"||typeof e=="number"){const o=We(e,n),r=We(e,t);return{top:o,right:r,bottom:o,left:r,x:r*2,y:o*2}}if(typeof e=="object"){const o=We(e.top??e.y??0,n),r=We(e.bottom??e.y??0,n),i=We(e.left??e.x??0,t),s=We(e.right??e.x??0,t);return{top:o,right:s,bottom:r,left:i,x:i+s,y:o+r}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function tf(e,t,n,o,r,i){const{x:s,y:a}=en(e,[t,n,o]),{x:c,y:l}=en({x:e.x+e.width,y:e.y+e.height},[t,n,o]),u=r-c,f=i-l;return{left:Math.floor(s),top:Math.floor(a),right:Math.floor(u),bottom:Math.floor(f)}}const eo=(e,t,n,o,r,i)=>{const s=ef(i,t,n),a=(t-s.x)/e.width,c=(n-s.y)/e.height,l=Math.min(a,c),u=et(l,o,r),f=e.x+e.width/2,d=e.y+e.height/2,p=t/2-f*u,m=n/2-d*u,w=tf(e,p,m,u,t,n),v={left:Math.min(w.left-s.left,0),top:Math.min(w.top-s.top,0),right:Math.min(w.right-s.right,0),bottom:Math.min(w.bottom-s.bottom,0)};return{x:p-v.left+v.right,y:m-v.top+v.bottom,zoom:u}},wt=()=>typeof navigator<"u"&&navigator?.userAgent?.indexOf("Mac")>=0;function nt(e){return e!=null&&e!=="parent"}function Ie(e){return{width:e.measured?.width??e.width??e.initialWidth??0,height:e.measured?.height??e.height??e.initialHeight??0}}function Ei(e){return(e.measured?.width??e.width??e.initialWidth)!==void 0&&(e.measured?.height??e.height??e.initialHeight)!==void 0}function _i(e,t={width:0,height:0},n,o,r){const i={...e},s=o.get(n);if(s){const a=s.origin||r;i.x+=s.internals.positionAbsolute.x-(t.width??0)*a[0],i.y+=s.internals.positionAbsolute.y-(t.height??0)*a[1]}return i}function Fo(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function nf(){let e,t;return{promise:new Promise((o,r)=>{e=o,t=r}),resolve:e,reject:t}}function of(e){return{...pi,...e||{}}}function dt(e,{snapGrid:t=[0,0],snapToGrid:n=!1,transform:o,containerBounds:r}){const{x:i,y:s}=we(e),a=kt({x:i-(r?.left??0),y:s-(r?.top??0)},o),{x:c,y:l}=n?St(a,t):a;return{xSnapped:c,ySnapped:l,...a}}const to=e=>({width:e.offsetWidth,height:e.offsetHeight}),Ci=e=>e?.getRootNode?.()||window?.document,rf=["INPUT","SELECT","TEXTAREA"];function Si(e){const t=e.composedPath?.()?.[0]||e.target;return t?.nodeType!==1?!1:rf.includes(t.nodeName)||t.hasAttribute("contenteditable")||!!t.closest(".nokey")}const ki=e=>"clientX"in e,we=(e,t)=>{const n=ki(e),o=n?e.clientX:e.touches?.[0].clientX,r=n?e.clientY:e.touches?.[0].clientY;return{x:o-(t?.left??0),y:r-(t?.top??0)}},Xo=(e,t,n,o,r)=>{const i=t.querySelectorAll(`.${e}`);return!i||!i.length?null:Array.from(i).map(s=>{const a=s.getBoundingClientRect();return{id:s.getAttribute("data-handleid"),type:e,nodeId:r,position:s.getAttribute("data-handlepos"),x:(a.left-n.left)/o,y:(a.top-n.top)/o,...to(s)}})};function Mi({sourceX:e,sourceY:t,targetX:n,targetY:o,sourceControlX:r,sourceControlY:i,targetControlX:s,targetControlY:a}){const c=e*.125+r*.375+s*.375+n*.125,l=t*.125+i*.375+a*.375+o*.125,u=Math.abs(c-e),f=Math.abs(l-t);return[c,l,u,f]}function jt(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function Yo({pos:e,x1:t,y1:n,x2:o,y2:r,c:i}){switch(e){case Z.Left:return[t-jt(t-o,i),n];case Z.Right:return[t+jt(o-t,i),n];case Z.Top:return[t,n-jt(n-r,i)];case Z.Bottom:return[t,n+jt(r-n,i)]}}function Ii({sourceX:e,sourceY:t,sourcePosition:n=Z.Bottom,targetX:o,targetY:r,targetPosition:i=Z.Top,curvature:s=.25}){const[a,c]=Yo({pos:n,x1:e,y1:t,x2:o,y2:r,c:s}),[l,u]=Yo({pos:i,x1:o,y1:r,x2:e,y2:t,c:s}),[f,d,p,m]=Mi({sourceX:e,sourceY:t,targetX:o,targetY:r,sourceControlX:a,sourceControlY:c,targetControlX:l,targetControlY:u});return[`M${e},${t} C${a},${c} ${l},${u} ${o},${r}`,f,d,p,m]}function Ai({sourceX:e,sourceY:t,targetX:n,targetY:o}){const r=Math.abs(n-e)/2,i=n<e?n+r:n-r,s=Math.abs(o-t)/2,a=o<t?o+s:o-s;return[i,a,r,s]}function sf({sourceNode:e,targetNode:t,selected:n=!1,zIndex:o=0,elevateOnSelect:r=!1,zIndexMode:i="basic"}){if(i==="manual")return o;const s=r&&n?o+1e3:o,a=Math.max(e.parentId||r&&e.selected?e.internals.z:0,t.parentId||r&&t.selected?t.internals.z:0);return s+a}function af({sourceNode:e,targetNode:t,width:n,height:o,transform:r}){const i=ln(Jt(e),Jt(t));i.x===i.x2&&(i.x2+=1),i.y===i.y2&&(i.y2+=1);const s={x:-r[0]/r[2],y:-r[1]/r[2],width:n/r[2],height:o/r[2]};return yt(s,un(i))>0}const Pi=({source:e,sourceHandle:t,target:n,targetHandle:o})=>`xy-edge__${e}${t||""}-${n}${o||""}`,cf=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),$i=(e,t,n={})=>{if(!e.source||!e.target)return t;const o=n.getEdgeId||Pi;let r;return yi(e)?r={...e}:r={...e,id:o(e)},cf(r,t)?t:(r.sourceHandle===null&&delete r.sourceHandle,r.targetHandle===null&&delete r.targetHandle,t.concat(r))},lf=(e,t,n,o={shouldReplaceId:!0})=>{const{id:r,...i}=e;if(!t.source||!t.target||!n.find(l=>l.id===e.id))return n;const a=o.getEdgeId||Pi,c={...i,id:o.shouldReplaceId?a(t):r,source:t.source,target:t.target,sourceHandle:t.sourceHandle,targetHandle:t.targetHandle};return n.filter(l=>l.id!==r).concat(c)};function Ti({sourceX:e,sourceY:t,targetX:n,targetY:o}){const[r,i,s,a]=Ai({sourceX:e,sourceY:t,targetX:n,targetY:o});return[`M ${e},${t}L ${n},${o}`,r,i,s,a]}const Wo={[Z.Left]:{x:-1,y:0},[Z.Right]:{x:1,y:0},[Z.Top]:{x:0,y:-1},[Z.Bottom]:{x:0,y:1}},uf=({source:e,sourcePosition:t=Z.Bottom,target:n})=>t===Z.Left||t===Z.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},Zo=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function df({source:e,sourcePosition:t=Z.Bottom,target:n,targetPosition:o=Z.Top,center:r,offset:i,stepPosition:s}){const a=Wo[t],c=Wo[o],l={x:e.x+a.x*i,y:e.y+a.y*i},u={x:n.x+c.x*i,y:n.y+c.y*i},f=uf({source:l,sourcePosition:t,target:u}),d=f.x!==0?"x":"y",p=f[d];let m=[],w,v;const x={x:0,y:0},N={x:0,y:0},[,,h,y]=Ai({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(a[d]*c[d]===-1){d==="x"?(w=r.x??l.x+(u.x-l.x)*s,v=r.y??(l.y+u.y)/2):(w=r.x??(l.x+u.x)/2,v=r.y??l.y+(u.y-l.y)*s);const E=[{x:w,y:l.y},{x:w,y:u.y}],_=[{x:l.x,y:v},{x:u.x,y:v}];a[d]===p?m=d==="x"?E:_:m=d==="x"?_:E}else{const E=[{x:l.x,y:u.y}],_=[{x:u.x,y:l.y}];if(d==="x"?m=a.x===p?_:E:m=a.y===p?E:_,t===o){const z=Math.abs(e[d]-n[d]);if(z<=i){const H=Math.min(i-1,i-z);a[d]===p?x[d]=(l[d]>e[d]?-1:1)*H:N[d]=(u[d]>n[d]?-1:1)*H}}if(t!==o){const z=d==="x"?"y":"x",H=a[d]===c[z],b=l[z]>u[z],k=l[z]<u[z];(a[d]===1&&(!H&&b||H&&k)||a[d]!==1&&(!H&&k||H&&b))&&(m=d==="x"?E:_)}const $={x:l.x+x.x,y:l.y+x.y},D={x:u.x+N.x,y:u.y+N.y},F=Math.max(Math.abs($.x-m[0].x),Math.abs(D.x-m[0].x)),A=Math.max(Math.abs($.y-m[0].y),Math.abs(D.y-m[0].y));F>=A?(w=($.x+D.x)/2,v=m[0].y):(w=m[0].x,v=($.y+D.y)/2)}return[[e,{x:l.x+x.x,y:l.y+x.y},...m,{x:u.x+N.x,y:u.y+N.y},n],w,v,h,y]}function ff(e,t,n,o){const r=Math.min(Zo(e,t)/2,Zo(t,n)/2,o),{x:i,y:s}=t;if(e.x===i&&i===n.x||e.y===s&&s===n.y)return`L${i} ${s}`;if(e.y===s){const l=e.x<n.x?-1:1,u=e.y<n.y?1:-1;return`L ${i+r*l},${s}Q ${i},${s} ${i},${s+r*u}`}const a=e.x<n.x?1:-1,c=e.y<n.y?-1:1;return`L ${i},${s+r*c}Q ${i},${s} ${i+r*a},${s}`}function On({sourceX:e,sourceY:t,sourcePosition:n=Z.Bottom,targetX:o,targetY:r,targetPosition:i=Z.Top,borderRadius:s=5,centerX:a,centerY:c,offset:l=20,stepPosition:u=.5}){const[f,d,p,m,w]=df({source:{x:e,y:t},sourcePosition:n,target:{x:o,y:r},targetPosition:i,center:{x:a,y:c},offset:l,stepPosition:u});return[f.reduce((x,N,h)=>{let y="";return h>0&&h<f.length-1?y=ff(f[h-1],N,f[h+1],s):y=`${h===0?"M":"L"}${N.x} ${N.y}`,x+=y,x},""),d,p,m,w]}function qo(e){return e&&!!(e.internals.handleBounds||e.handles?.length)&&!!(e.measured.width||e.width||e.initialWidth)}function hf(e){const{sourceNode:t,targetNode:n}=e;if(!qo(t)||!qo(n))return null;const o=t.internals.handleBounds||Go(t.handles),r=n.internals.handleBounds||Go(n.handles),i=Uo(o?.source??[],e.sourceHandle),s=Uo(e.connectionMode===Je.Strict?r?.target??[]:(r?.target??[]).concat(r?.source??[]),e.targetHandle);if(!i||!s)return e.onError?.("008",Ee.error008(i?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const a=i?.position||Z.Bottom,c=s?.position||Z.Top,l=Xe(t,i,a),u=Xe(n,s,c);return{sourceX:l.x,sourceY:l.y,targetX:u.x,targetY:u.y,sourcePosition:a,targetPosition:c}}function Go(e){if(!e)return null;const t=[],n=[];for(const o of e)o.width=o.width??1,o.height=o.height??1,o.type==="source"?t.push(o):o.type==="target"&&n.push(o);return{source:t,target:n}}function Xe(e,t,n=Z.Left,o=!1){const r=(t?.x??0)+e.internals.positionAbsolute.x,i=(t?.y??0)+e.internals.positionAbsolute.y,{width:s,height:a}=t??Ie(e);if(o)return{x:r+s/2,y:i+a/2};switch(t?.position??n){case Z.Top:return{x:r+s/2,y:i};case Z.Right:return{x:r+s,y:i+a/2};case Z.Bottom:return{x:r+s/2,y:i+a};case Z.Left:return{x:r,y:i+a/2}}}function Uo(e,t){return e&&(t?e.find(n=>n.id===t):e[0])||null}function Vn(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(o=>`${o}=${e[o]}`).join("&")}`:""}function gf(e,{id:t,defaultColor:n,defaultMarkerStart:o,defaultMarkerEnd:r}){const i=new Set;return e.reduce((s,a)=>([a.markerStart||o,a.markerEnd||r].forEach(c=>{if(c&&typeof c=="object"){const l=Vn(c,t);i.has(l)||(s.push({id:l,color:c.color||n,...c}),i.add(l))}}),s),[]).sort((s,a)=>s.id.localeCompare(a.id))}const Di=1e3,pf=10,no={nodeOrigin:[0,0],nodeExtent:mt,elevateNodesOnSelect:!0,zIndexMode:"basic",defaults:{}},mf={...no,checkEquality:!0};function oo(e,t){const n={...e};for(const o in t)t[o]!==void 0&&(n[o]=t[o]);return n}function xf(e,t,n){const o=oo(no,n);for(const r of e.values())if(r.parentId)io(r,e,t,o);else{const i=_t(r,o.nodeOrigin),s=nt(r.extent)?r.extent:o.nodeExtent,a=Fe(i,s,Ie(r));r.internals.positionAbsolute=a}}function yf(e,t){if(!e.handles)return e.measured?t?.internals.handleBounds:void 0;const n=[],o=[];for(const r of e.handles){const i={id:r.id,width:r.width??1,height:r.height??1,nodeId:e.id,x:r.x,y:r.y,position:r.position,type:r.type};r.type==="source"?n.push(i):r.type==="target"&&o.push(i)}return{source:n,target:o}}function ro(e){return e==="manual"}function Bn(e,t,n,o={}){const r=oo(mf,o),i={i:0},s=new Map(t),a=r?.elevateNodesOnSelect&&!ro(r.zIndexMode)?Di:0;let c=e.length>0;t.clear(),n.clear();for(const l of e){let u=s.get(l.id);if(r.checkEquality&&l===u?.internals.userNode)t.set(l.id,u);else{const f=_t(l,r.nodeOrigin),d=nt(l.extent)?l.extent:r.nodeExtent,p=Fe(f,d,Ie(l));u={...r.defaults,...l,measured:{width:l.measured?.width,height:l.measured?.height},internals:{positionAbsolute:p,handleBounds:yf(l,u),z:zi(l,a,r.zIndexMode),userNode:l}},t.set(l.id,u)}(u.measured===void 0||u.measured.width===void 0||u.measured.height===void 0)&&!u.hidden&&(c=!1),l.parentId&&io(u,t,n,o,i)}return c}function wf(e,t){if(!e.parentId)return;const n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function io(e,t,n,o,r){const{elevateNodesOnSelect:i,nodeOrigin:s,nodeExtent:a,zIndexMode:c}=oo(no,o),l=e.parentId,u=t.get(l);if(!u){console.warn(`Parent node ${l} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}wf(e,n),r&&!u.parentId&&u.internals.rootParentIndex===void 0&&c==="auto"&&(u.internals.rootParentIndex=++r.i,u.internals.z=u.internals.z+r.i*pf),r&&u.internals.rootParentIndex!==void 0&&(r.i=u.internals.rootParentIndex);const f=i&&!ro(c)?Di:0,{x:d,y:p,z:m}=vf(e,u,s,a,f,c),{positionAbsolute:w}=e.internals,v=d!==w.x||p!==w.y;(v||m!==e.internals.z)&&t.set(e.id,{...e,internals:{...e.internals,positionAbsolute:v?{x:d,y:p}:w,z:m}})}function zi(e,t,n){const o=ye(e.zIndex)?e.zIndex:0;return ro(n)?o:o+(e.selected?t:0)}function vf(e,t,n,o,r,i){const{x:s,y:a}=t.internals.positionAbsolute,c=Ie(e),l=_t(e,n),u=nt(e.extent)?Fe(l,e.extent,c):l;let f=Fe({x:s+u.x,y:a+u.y},o,c);e.extent==="parent"&&(f=vi(f,c,t));const d=zi(e,r,i),p=t.internals.z??0;return{x:f.x,y:f.y,z:p>=d?p+1:d}}function so(e,t,n,o=[0,0]){const r=[],i=new Map;for(const s of e){const a=t.get(s.parentId);if(!a)continue;const c=i.get(s.parentId)?.expandedRect??tt(a),l=Ni(c,s.rect);i.set(s.parentId,{expandedRect:l,parent:a})}return i.size>0&&i.forEach(({expandedRect:s,parent:a},c)=>{const l=a.internals.positionAbsolute,u=Ie(a),f=a.origin??o,d=s.x<l.x?Math.round(Math.abs(l.x-s.x)):0,p=s.y<l.y?Math.round(Math.abs(l.y-s.y)):0,m=Math.max(u.width,Math.round(s.width)),w=Math.max(u.height,Math.round(s.height)),v=(m-u.width)*f[0],x=(w-u.height)*f[1];(d>0||p>0||v||x)&&(r.push({id:c,type:"position",position:{x:a.position.x-d+v,y:a.position.y-p+x}}),n.get(c)?.forEach(N=>{e.some(h=>h.id===N.id)||r.push({id:N.id,type:"position",position:{x:N.position.x+d,y:N.position.y+p}})})),(u.width<s.width||u.height<s.height||d||p)&&r.push({id:c,type:"dimensions",setAttributes:!0,dimensions:{width:m+(d?f[0]*d-v:0),height:w+(p?f[1]*p-x:0)}})}),r}function bf(e,t,n,o,r,i,s){const a=o?.querySelector(".xyflow__viewport");let c=!1;if(!a)return{changes:[],updatedInternals:c};const l=[],u=window.getComputedStyle(a),{m22:f}=new window.DOMMatrixReadOnly(u.transform),d=[];for(const p of e.values()){const m=t.get(p.id);if(!m)continue;if(m.hidden){t.set(m.id,{...m,internals:{...m.internals,handleBounds:void 0}}),c=!0;continue}const w=to(p.nodeElement),v=m.measured.width!==w.width||m.measured.height!==w.height;if(!!(w.width&&w.height&&(v||!m.internals.handleBounds||p.force))){const N=p.nodeElement.getBoundingClientRect(),h=nt(m.extent)?m.extent:i;let{positionAbsolute:y}=m.internals;m.parentId&&m.extent==="parent"?y=vi(y,w,t.get(m.parentId)):h&&(y=Fe(y,h,w));const S={...m,measured:w,internals:{...m.internals,positionAbsolute:y,handleBounds:{source:Xo("source",p.nodeElement,N,f,m.id),target:Xo("target",p.nodeElement,N,f,m.id)}}};t.set(m.id,S),m.parentId&&io(S,t,n,{nodeOrigin:r,zIndexMode:s}),c=!0,v&&(l.push({id:m.id,type:"dimensions",dimensions:w}),m.expandParent&&m.parentId&&d.push({id:m.id,parentId:m.parentId,rect:tt(S,r)}))}}if(d.length>0){const p=so(d,t,n,r);l.push(...p)}return{changes:l,updatedInternals:c}}async function Nf({delta:e,panZoom:t,transform:n,translateExtent:o,width:r,height:i}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const s=await t.setViewportConstrained({x:n[0]+e.x,y:n[1]+e.y,zoom:n[2]},[[0,0],[r,i]],o),a=!!s&&(s.x!==n[0]||s.y!==n[1]||s.k!==n[2]);return Promise.resolve(a)}function Ko(e,t,n,o,r,i){let s=r;const a=o.get(s)||new Map;o.set(s,a.set(n,t)),s=`${r}-${e}`;const c=o.get(s)||new Map;if(o.set(s,c.set(n,t)),i){s=`${r}-${e}-${i}`;const l=o.get(s)||new Map;o.set(s,l.set(n,t))}}function ji(e,t,n){e.clear(),t.clear();for(const o of n){const{source:r,target:i,sourceHandle:s=null,targetHandle:a=null}=o,c={edgeId:o.id,source:r,target:i,sourceHandle:s,targetHandle:a},l=`${r}-${s}--${i}-${a}`,u=`${i}-${a}--${r}-${s}`;Ko("source",c,u,e,r,s),Ko("target",c,l,e,i,a),t.set(o.id,o)}}function Hi(e,t){if(!e.parentId)return!1;const n=t.get(e.parentId);return n?n.selected?!0:Hi(n,t):!1}function Qo(e,t,n){let o=e;do{if(o?.matches?.(t))return!0;if(o===n)return!1;o=o?.parentElement}while(o);return!1}function Ef(e,t,n,o){const r=new Map;for(const[i,s]of e)if((s.selected||s.id===o)&&(!s.parentId||!Hi(s,e))&&(s.draggable||t&&typeof s.draggable>"u")){const a=e.get(i);a&&r.set(i,{id:i,position:a.position||{x:0,y:0},distance:{x:n.x-a.internals.positionAbsolute.x,y:n.y-a.internals.positionAbsolute.y},extent:a.extent,parentId:a.parentId,origin:a.origin,expandParent:a.expandParent,internals:{positionAbsolute:a.internals.positionAbsolute||{x:0,y:0}},measured:{width:a.measured.width??0,height:a.measured.height??0}})}return r}function Nn({nodeId:e,dragItems:t,nodeLookup:n,dragging:o=!0}){const r=[];for(const[s,a]of t){const c=n.get(s)?.internals.userNode;c&&r.push({...c,position:a.position,dragging:o})}if(!e)return[r[0],r];const i=n.get(e)?.internals.userNode;return[i?{...i,position:t.get(e)?.position||i.position,dragging:o}:r[0],r]}function _f({dragItems:e,snapGrid:t,x:n,y:o}){const r=e.values().next().value;if(!r)return null;const i={x:n-r.distance.x,y:o-r.distance.y},s=St(i,t);return{x:s.x-i.x,y:s.y-i.y}}function Cf({onNodeMouseDown:e,getStoreItems:t,onDragStart:n,onDrag:o,onDragStop:r}){let i={x:null,y:null},s=0,a=new Map,c=!1,l={x:0,y:0},u=null,f=!1,d=null,p=!1,m=!1,w=null;function v({noDragClassName:N,handleSelector:h,domNode:y,isSelectable:S,nodeId:E,nodeClickDistance:_=0}){d=he(y);function $({x:z,y:H}){const{nodeLookup:b,nodeExtent:k,snapGrid:C,snapToGrid:P,nodeOrigin:I,onNodeDrag:T,onSelectionDrag:j,onError:V,updateNodePositions:O}=t();i={x:z,y:H};let W=!1;const Y=a.size>1,Q=Y&&k?Ln(Ct(a)):null,ne=Y&&P?_f({dragItems:a,snapGrid:C,x:z,y:H}):null;for(const[K,X]of a){if(!b.has(K))continue;let U={x:z-X.distance.x,y:H-X.distance.y};P&&(U=ne?{x:Math.round(U.x+ne.x),y:Math.round(U.y+ne.y)}:St(U,C));let re=null;if(Y&&k&&!X.extent&&Q){const{positionAbsolute:te}=X.internals,L=te.x-Q.x+k[0][0],R=te.x+X.measured.width-Q.x2+k[1][0],B=te.y-Q.y+k[0][1],q=te.y+X.measured.height-Q.y2+k[1][1];re=[[L,B],[R,q]]}const{position:oe,positionAbsolute:J}=wi({nodeId:K,nextPosition:U,nodeLookup:b,nodeExtent:re||k,nodeOrigin:I,onError:V});W=W||X.position.x!==oe.x||X.position.y!==oe.y,X.position=oe,X.internals.positionAbsolute=J}if(m=m||W,!!W&&(O(a,!0),w&&(o||T||!E&&j))){const[K,X]=Nn({nodeId:E,dragItems:a,nodeLookup:b});o?.(w,a,K,X),T?.(w,K,X),E||j?.(w,X)}}async function D(){if(!u)return;const{transform:z,panBy:H,autoPanSpeed:b,autoPanOnNodeDrag:k}=t();if(!k){c=!1,cancelAnimationFrame(s);return}const[C,P]=bi(l,u,b);(C!==0||P!==0)&&(i.x=(i.x??0)-C/z[2],i.y=(i.y??0)-P/z[2],await H({x:C,y:P})&&$(i)),s=requestAnimationFrame(D)}function F(z){const{nodeLookup:H,multiSelectionActive:b,nodesDraggable:k,transform:C,snapGrid:P,snapToGrid:I,selectNodesOnDrag:T,onNodeDragStart:j,onSelectionDragStart:V,unselectNodesAndEdges:O}=t();f=!0,(!T||!S)&&!b&&E&&(H.get(E)?.selected||O()),S&&T&&E&&e?.(E);const W=dt(z.sourceEvent,{transform:C,snapGrid:P,snapToGrid:I,containerBounds:u});if(i=W,a=Ef(H,k,W,E),a.size>0&&(n||j||!E&&V)){const[Y,Q]=Nn({nodeId:E,dragItems:a,nodeLookup:H});n?.(z.sourceEvent,a,Y,Q),j?.(z.sourceEvent,Y,Q),E||V?.(z.sourceEvent,Q)}}const A=Qr().clickDistance(_).on("start",z=>{const{domNode:H,nodeDragThreshold:b,transform:k,snapGrid:C,snapToGrid:P}=t();u=H?.getBoundingClientRect()||null,p=!1,m=!1,w=z.sourceEvent,b===0&&F(z),i=dt(z.sourceEvent,{transform:k,snapGrid:C,snapToGrid:P,containerBounds:u}),l=we(z.sourceEvent,u)}).on("drag",z=>{const{autoPanOnNodeDrag:H,transform:b,snapGrid:k,snapToGrid:C,nodeDragThreshold:P,nodeLookup:I}=t(),T=dt(z.sourceEvent,{transform:b,snapGrid:k,snapToGrid:C,containerBounds:u});if(w=z.sourceEvent,(z.sourceEvent.type==="touchmove"&&z.sourceEvent.touches.length>1||E&&!I.has(E))&&(p=!0),!p){if(!c&&H&&f&&(c=!0,D()),!f){const j=we(z.sourceEvent,u),V=j.x-l.x,O=j.y-l.y;Math.sqrt(V*V+O*O)>P&&F(z)}(i.x!==T.xSnapped||i.y!==T.ySnapped)&&a&&f&&(l=we(z.sourceEvent,u),$(T))}}).on("end",z=>{if(!(!f||p)&&(c=!1,f=!1,cancelAnimationFrame(s),a.size>0)){const{nodeLookup:H,updateNodePositions:b,onNodeDragStop:k,onSelectionDragStop:C}=t();if(m&&(b(a,!1),m=!1),r||k||!E&&C){const[P,I]=Nn({nodeId:E,dragItems:a,nodeLookup:H,dragging:!1});r?.(z.sourceEvent,a,P,I),k?.(z.sourceEvent,P,I),E||C?.(z.sourceEvent,I)}}}).filter(z=>{const H=z.target;return!z.button&&(!N||!Qo(H,`.${N}`,y))&&(!h||Qo(H,h,y))});d.call(A)}function x(){d?.on(".drag",null)}return{update:v,destroy:x}}function Sf(e,t,n){const o=[],r={x:e.x-n,y:e.y-n,width:n*2,height:n*2};for(const i of t.values())yt(r,tt(i))>0&&o.push(i);return o}const kf=250;function Mf(e,t,n,o){let r=[],i=1/0;const s=Sf(e,n,t+kf);for(const a of s){const c=[...a.internals.handleBounds?.source??[],...a.internals.handleBounds?.target??[]];for(const l of c){if(o.nodeId===l.nodeId&&o.type===l.type&&o.id===l.id)continue;const{x:u,y:f}=Xe(a,l,l.position,!0),d=Math.sqrt(Math.pow(u-e.x,2)+Math.pow(f-e.y,2));d>t||(d<i?(r=[{...l,x:u,y:f}],i=d):d===i&&r.push({...l,x:u,y:f}))}}if(!r.length)return null;if(r.length>1){const a=o.type==="source"?"target":"source";return r.find(c=>c.type===a)??r[0]}return r[0]}function Ri(e,t,n,o,r,i=!1){const s=o.get(e);if(!s)return null;const a=r==="strict"?s.internals.handleBounds?.[t]:[...s.internals.handleBounds?.source??[],...s.internals.handleBounds?.target??[]],c=(n?a?.find(l=>l.id===n):a?.[0])??null;return c&&i?{...c,...Xe(s,c,c.position,!0)}:c}function Li(e,t){return e||(t?.classList.contains("target")?"target":t?.classList.contains("source")?"source":null)}function If(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}const Oi=()=>!0;function Af(e,{connectionMode:t,connectionRadius:n,handleId:o,nodeId:r,edgeUpdaterType:i,isTarget:s,domNode:a,nodeLookup:c,lib:l,autoPanOnConnect:u,flowId:f,panBy:d,cancelConnection:p,onConnectStart:m,onConnect:w,onConnectEnd:v,isValidConnection:x=Oi,onReconnectEnd:N,updateConnection:h,getTransform:y,getFromHandle:S,autoPanSpeed:E,dragThreshold:_=1,handleDomNode:$}){const D=Ci(e.target);let F=0,A;const{x:z,y:H}=we(e),b=Li(i,$),k=a?.getBoundingClientRect();let C=!1;if(!k||!b)return;const P=Ri(r,b,o,c,t);if(!P)return;let I=we(e,k),T=!1,j=null,V=!1,O=null;function W(){if(!u||!k)return;const[oe,J]=bi(I,k,E);d({x:oe,y:J}),F=requestAnimationFrame(W)}const Y={...P,nodeId:r,type:b,position:P.position},Q=c.get(r);let K={inProgress:!0,isValid:null,from:Xe(Q,Y,Z.Left,!0),fromHandle:Y,fromPosition:Y.position,fromNode:Q,to:I,toHandle:null,toPosition:Lo[Y.position],toNode:null,pointer:I};function X(){C=!0,h(K),m?.(e,{nodeId:r,handleId:o,handleType:b})}_===0&&X();function U(oe){if(!C){const{x:q,y:G}=we(oe),ee=q-z,se=G-H;if(!(ee*ee+se*se>_*_))return;X()}if(!S()||!Y){re(oe);return}const J=y();I=we(oe,k),A=Mf(kt(I,J,!1,[1,1]),n,c,Y),T||(W(),T=!0);const te=Vi(oe,{handle:A,connectionMode:t,fromNodeId:r,fromHandleId:o,fromType:s?"target":"source",isValidConnection:x,doc:D,lib:l,flowId:f,nodeLookup:c});O=te.handleDomNode,j=te.connection,V=If(!!A,te.isValid);const L=c.get(r),R=L?Xe(L,Y,Z.Left,!0):K.from,B={...K,from:R,isValid:V,to:te.toHandle&&V?en({x:te.toHandle.x,y:te.toHandle.y},J):I,toHandle:te.toHandle,toPosition:V&&te.toHandle?te.toHandle.position:Lo[Y.position],toNode:te.toHandle?c.get(te.toHandle.nodeId):null,pointer:I};h(B),K=B}function re(oe){if(!("touches"in oe&&oe.touches.length>0)){if(C){(A||O)&&j&&V&&w?.(j);const{inProgress:J,...te}=K,L={...te,toPosition:K.toHandle?K.toPosition:null};v?.(oe,L),i&&N?.(oe,L)}p(),cancelAnimationFrame(F),T=!1,V=!1,j=null,O=null,D.removeEventListener("mousemove",U),D.removeEventListener("mouseup",re),D.removeEventListener("touchmove",U),D.removeEventListener("touchend",re)}}D.addEventListener("mousemove",U),D.addEventListener("mouseup",re),D.addEventListener("touchmove",U),D.addEventListener("touchend",re)}function Vi(e,{handle:t,connectionMode:n,fromNodeId:o,fromHandleId:r,fromType:i,doc:s,lib:a,flowId:c,isValidConnection:l=Oi,nodeLookup:u}){const f=i==="target",d=t?s.querySelector(`.${a}-flow__handle[data-id="${c}-${t?.nodeId}-${t?.id}-${t?.type}"]`):null,{x:p,y:m}=we(e),w=s.elementFromPoint(p,m),v=w?.classList.contains(`${a}-flow__handle`)?w:d,x={handleDomNode:v,isValid:!1,connection:null,toHandle:null};if(v){const N=Li(void 0,v),h=v.getAttribute("data-nodeid"),y=v.getAttribute("data-handleid"),S=v.classList.contains("connectable"),E=v.classList.contains("connectableend");if(!h||!N)return x;const _={source:f?h:o,sourceHandle:f?y:r,target:f?o:h,targetHandle:f?r:y};x.connection=_;const D=S&&E&&(n===Je.Strict?f&&N==="source"||!f&&N==="target":h!==o||y!==r);x.isValid=D&&l(_),x.toHandle=Ri(h,N,y,u,n,!0)}return x}const Fn={onPointerDown:Af,isValid:Vi};function Pf({domNode:e,panZoom:t,getTransform:n,getViewScale:o}){const r=he(e);function i({translateExtent:a,width:c,height:l,zoomStep:u=1,pannable:f=!0,zoomable:d=!0,inversePan:p=!1}){const m=h=>{if(h.sourceEvent.type!=="wheel"||!t)return;const y=n(),S=h.sourceEvent.ctrlKey&&wt()?10:1,E=-h.sourceEvent.deltaY*(h.sourceEvent.deltaMode===1?.05:h.sourceEvent.deltaMode?1:.002)*u,_=y[2]*Math.pow(2,E*S);t.scaleTo(_)};let w=[0,0];const v=h=>{(h.sourceEvent.type==="mousedown"||h.sourceEvent.type==="touchstart")&&(w=[h.sourceEvent.clientX??h.sourceEvent.touches[0].clientX,h.sourceEvent.clientY??h.sourceEvent.touches[0].clientY])},x=h=>{const y=n();if(h.sourceEvent.type!=="mousemove"&&h.sourceEvent.type!=="touchmove"||!t)return;const S=[h.sourceEvent.clientX??h.sourceEvent.touches[0].clientX,h.sourceEvent.clientY??h.sourceEvent.touches[0].clientY],E=[S[0]-w[0],S[1]-w[1]];w=S;const _=o()*Math.max(y[2],Math.log(y[2]))*(p?-1:1),$={x:y[0]-E[0]*_,y:y[1]-E[1]*_},D=[[0,0],[c,l]];t.setViewportConstrained({x:$.x,y:$.y,zoom:y[2]},D,a)},N=hi().on("start",v).on("zoom",f?x:null).on("zoom.wheel",d?m:null);r.call(N,{})}function s(){r.on("zoom",null)}return{update:i,destroy:s,pointer:me}}const dn=e=>({x:e.x,y:e.y,zoom:e.k}),En=({x:e,y:t,zoom:n})=>cn.translate(e,t).scale(n),Ze=(e,t)=>e.target.closest(`.${t}`),Bi=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),$f=e=>((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2,_n=(e,t=0,n=$f,o=()=>{})=>{const r=typeof t=="number"&&t>0;return r||o(),r?e.transition().duration(t).ease(n).on("end",o):e},Fi=e=>{const t=e.ctrlKey&&wt()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function Tf({zoomPanValues:e,noWheelClassName:t,d3Selection:n,d3Zoom:o,panOnScrollMode:r,panOnScrollSpeed:i,zoomOnPinch:s,onPanZoomStart:a,onPanZoom:c,onPanZoomEnd:l}){return u=>{if(Ze(u,t))return u.ctrlKey&&u.preventDefault(),!1;u.preventDefault(),u.stopImmediatePropagation();const f=n.property("__zoom").k||1;if(u.ctrlKey&&s){const v=me(u),x=Fi(u),N=f*Math.pow(2,x);o.scaleTo(n,N,v,u);return}const d=u.deltaMode===1?20:1;let p=r===Oe.Vertical?0:u.deltaX*d,m=r===Oe.Horizontal?0:u.deltaY*d;!wt()&&u.shiftKey&&r!==Oe.Vertical&&(p=u.deltaY*d,m=0),o.translateBy(n,-(p/f)*i,-(m/f)*i,{internal:!0});const w=dn(n.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling?(c?.(u,w),e.panScrollTimeout=setTimeout(()=>{l?.(u,w),e.isPanScrolling=!1},150)):(e.isPanScrolling=!0,a?.(u,w))}}function Df({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:n}){return function(o,r){const i=o.type==="wheel",s=!t&&i&&!o.ctrlKey,a=Ze(o,e);if(o.ctrlKey&&i&&a&&o.preventDefault(),s||a)return null;o.preventDefault(),n.call(this,o,r)}}function zf({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:n}){return o=>{if(o.sourceEvent?.internal)return;const r=dn(o.transform);e.mouseButton=o.sourceEvent?.button||0,e.isZoomingOrPanning=!0,e.prevViewport=r,o.sourceEvent?.type==="mousedown"&&t(!0),n&&n?.(o.sourceEvent,r)}}function jf({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:n,onTransformChange:o,onPanZoom:r}){return i=>{e.usedRightMouseButton=!!(n&&Bi(t,e.mouseButton??0)),i.sourceEvent?.sync||o([i.transform.x,i.transform.y,i.transform.k]),r&&!i.sourceEvent?.internal&&r?.(i.sourceEvent,dn(i.transform))}}function Hf({zoomPanValues:e,panOnDrag:t,panOnScroll:n,onDraggingChange:o,onPanZoomEnd:r,onPaneContextMenu:i}){return s=>{if(!s.sourceEvent?.internal&&(e.isZoomingOrPanning=!1,i&&Bi(t,e.mouseButton??0)&&!e.usedRightMouseButton&&s.sourceEvent&&i(s.sourceEvent),e.usedRightMouseButton=!1,o(!1),r)){const a=dn(s.transform);e.prevViewport=a,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{r?.(s.sourceEvent,a)},n?150:0)}}}function Rf({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:n,panOnDrag:o,panOnScroll:r,zoomOnDoubleClick:i,userSelectionActive:s,noWheelClassName:a,noPanClassName:c,lib:l,connectionInProgress:u}){return f=>{const d=e||t,p=n&&f.ctrlKey,m=f.type==="wheel";if(f.button===1&&f.type==="mousedown"&&(Ze(f,`${l}-flow__node`)||Ze(f,`${l}-flow__edge`)))return!0;if(!o&&!d&&!r&&!i&&!n||s||u&&!m||Ze(f,a)&&m||Ze(f,c)&&(!m||r&&m&&!e)||!n&&f.ctrlKey&&m)return!1;if(!n&&f.type==="touchstart"&&f.touches?.length>1)return f.preventDefault(),!1;if(!d&&!r&&!p&&m||!o&&(f.type==="mousedown"||f.type==="touchstart")||Array.isArray(o)&&!o.includes(f.button)&&f.type==="mousedown")return!1;const w=Array.isArray(o)&&o.includes(f.button)||!f.button||f.button<=1;return(!f.ctrlKey||m)&&w}}function Lf({domNode:e,minZoom:t,maxZoom:n,translateExtent:o,viewport:r,onPanZoom:i,onPanZoomStart:s,onPanZoomEnd:a,onDraggingChange:c}){const l={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},u=e.getBoundingClientRect(),f=hi().scaleExtent([t,n]).translateExtent(o),d=he(e).call(f);N({x:r.x,y:r.y,zoom:et(r.zoom,t,n)},[[0,0],[u.width,u.height]],o);const p=d.on("wheel.zoom"),m=d.on("dblclick.zoom");f.wheelDelta(Fi);function w(A,z){return d?new Promise(H=>{f?.interpolate(z?.interpolate==="linear"?ut:Vt).transform(_n(d,z?.duration,z?.ease,()=>H(!0)),A)}):Promise.resolve(!1)}function v({noWheelClassName:A,noPanClassName:z,onPaneContextMenu:H,userSelectionActive:b,panOnScroll:k,panOnDrag:C,panOnScrollMode:P,panOnScrollSpeed:I,preventScrolling:T,zoomOnPinch:j,zoomOnScroll:V,zoomOnDoubleClick:O,zoomActivationKeyPressed:W,lib:Y,onTransformChange:Q,connectionInProgress:ne,paneClickDistance:K,selectionOnDrag:X}){b&&!l.isZoomingOrPanning&&x();const U=k&&!W&&!b;f.clickDistance(X?1/0:!ye(K)||K<0?0:K);const re=U?Tf({zoomPanValues:l,noWheelClassName:A,d3Selection:d,d3Zoom:f,panOnScrollMode:P,panOnScrollSpeed:I,zoomOnPinch:j,onPanZoomStart:s,onPanZoom:i,onPanZoomEnd:a}):Df({noWheelClassName:A,preventScrolling:T,d3ZoomHandler:p});if(d.on("wheel.zoom",re,{passive:!1}),!b){const J=zf({zoomPanValues:l,onDraggingChange:c,onPanZoomStart:s});f.on("start",J);const te=jf({zoomPanValues:l,panOnDrag:C,onPaneContextMenu:!!H,onPanZoom:i,onTransformChange:Q});f.on("zoom",te);const L=Hf({zoomPanValues:l,panOnDrag:C,panOnScroll:k,onPaneContextMenu:H,onPanZoomEnd:a,onDraggingChange:c});f.on("end",L)}const oe=Rf({zoomActivationKeyPressed:W,panOnDrag:C,zoomOnScroll:V,panOnScroll:k,zoomOnDoubleClick:O,zoomOnPinch:j,userSelectionActive:b,noPanClassName:z,noWheelClassName:A,lib:Y,connectionInProgress:ne});f.filter(oe),O?d.on("dblclick.zoom",m):d.on("dblclick.zoom",null)}function x(){f.on("zoom",null)}async function N(A,z,H){const b=En(A),k=f?.constrain()(b,z,H);return k&&await w(k),new Promise(C=>C(k))}async function h(A,z){const H=En(A);return await w(H,z),new Promise(b=>b(H))}function y(A){if(d){const z=En(A),H=d.property("__zoom");(H.k!==A.zoom||H.x!==A.x||H.y!==A.y)&&f?.transform(d,z,null,{sync:!0})}}function S(){const A=d?fi(d.node()):{x:0,y:0,k:1};return{x:A.x,y:A.y,zoom:A.k}}function E(A,z){return d?new Promise(H=>{f?.interpolate(z?.interpolate==="linear"?ut:Vt).scaleTo(_n(d,z?.duration,z?.ease,()=>H(!0)),A)}):Promise.resolve(!1)}function _(A,z){return d?new Promise(H=>{f?.interpolate(z?.interpolate==="linear"?ut:Vt).scaleBy(_n(d,z?.duration,z?.ease,()=>H(!0)),A)}):Promise.resolve(!1)}function $(A){f?.scaleExtent(A)}function D(A){f?.translateExtent(A)}function F(A){const z=!ye(A)||A<0?0:A;f?.clickDistance(z)}return{update:v,destroy:x,setViewport:h,setViewportConstrained:N,getViewport:S,scaleTo:E,scaleBy:_,setScaleExtent:$,setTranslateExtent:D,syncViewport:y,setClickDistance:F}}var ot;(function(e){e.Line="line",e.Handle="handle"})(ot||(ot={}));function Of({width:e,prevWidth:t,height:n,prevHeight:o,affectsX:r,affectsY:i}){const s=e-t,a=n-o,c=[s>0?1:s<0?-1:0,a>0?1:a<0?-1:0];return s&&r&&(c[0]=c[0]*-1),a&&i&&(c[1]=c[1]*-1),c}function Jo(e){const t=e.includes("right")||e.includes("left"),n=e.includes("bottom")||e.includes("top"),o=e.includes("left"),r=e.includes("top");return{isHorizontal:t,isVertical:n,affectsX:o,affectsY:r}}function Ae(e,t){return Math.max(0,t-e)}function Pe(e,t){return Math.max(0,e-t)}function Ht(e,t,n){return Math.max(0,t-e,e-n)}function er(e,t){return e?!t:t}function Vf(e,t,n,o,r,i,s,a){let{affectsX:c,affectsY:l}=t;const{isHorizontal:u,isVertical:f}=t,d=u&&f,{xSnapped:p,ySnapped:m}=n,{minWidth:w,maxWidth:v,minHeight:x,maxHeight:N}=o,{x:h,y,width:S,height:E,aspectRatio:_}=e;let $=Math.floor(u?p-e.pointerX:0),D=Math.floor(f?m-e.pointerY:0);const F=S+(c?-$:$),A=E+(l?-D:D),z=-i[0]*S,H=-i[1]*E;let b=Ht(F,w,v),k=Ht(A,x,N);if(s){let I=0,T=0;c&&$<0?I=Ae(h+$+z,s[0][0]):!c&&$>0&&(I=Pe(h+F+z,s[1][0])),l&&D<0?T=Ae(y+D+H,s[0][1]):!l&&D>0&&(T=Pe(y+A+H,s[1][1])),b=Math.max(b,I),k=Math.max(k,T)}if(a){let I=0,T=0;c&&$>0?I=Pe(h+$,a[0][0]):!c&&$<0&&(I=Ae(h+F,a[1][0])),l&&D>0?T=Pe(y+D,a[0][1]):!l&&D<0&&(T=Ae(y+A,a[1][1])),b=Math.max(b,I),k=Math.max(k,T)}if(r){if(u){const I=Ht(F/_,x,N)*_;if(b=Math.max(b,I),s){let T=0;!c&&!l||c&&!l&&d?T=Pe(y+H+F/_,s[1][1])*_:T=Ae(y+H+(c?$:-$)/_,s[0][1])*_,b=Math.max(b,T)}if(a){let T=0;!c&&!l||c&&!l&&d?T=Ae(y+F/_,a[1][1])*_:T=Pe(y+(c?$:-$)/_,a[0][1])*_,b=Math.max(b,T)}}if(f){const I=Ht(A*_,w,v)/_;if(k=Math.max(k,I),s){let T=0;!c&&!l||l&&!c&&d?T=Pe(h+A*_+z,s[1][0])/_:T=Ae(h+(l?D:-D)*_+z,s[0][0])/_,k=Math.max(k,T)}if(a){let T=0;!c&&!l||l&&!c&&d?T=Ae(h+A*_,a[1][0])/_:T=Pe(h+(l?D:-D)*_,a[0][0])/_,k=Math.max(k,T)}}}D=D+(D<0?k:-k),$=$+($<0?b:-b),r&&(d?F>A*_?D=(er(c,l)?-$:$)/_:$=(er(c,l)?-D:D)*_:u?(D=$/_,l=c):($=D*_,c=l));const C=c?h+$:h,P=l?y+D:y;return{width:S+(c?-$:$),height:E+(l?-D:D),x:i[0]*$*(c?-1:1)+C,y:i[1]*D*(l?-1:1)+P}}const Xi={width:0,height:0,x:0,y:0},Bf={...Xi,pointerX:0,pointerY:0,aspectRatio:1};function Ff(e){return[[0,0],[e.measured.width,e.measured.height]]}function Xf(e,t,n){const o=t.position.x+e.position.x,r=t.position.y+e.position.y,i=e.measured.width??0,s=e.measured.height??0,a=n[0]*i,c=n[1]*s;return[[o-a,r-c],[o+i-a,r+s-c]]}function Yf({domNode:e,nodeId:t,getStoreItems:n,onChange:o,onEnd:r}){const i=he(e);let s={controlDirection:Jo("bottom-right"),boundaries:{minWidth:0,minHeight:0,maxWidth:Number.MAX_VALUE,maxHeight:Number.MAX_VALUE},resizeDirection:void 0,keepAspectRatio:!1};function a({controlPosition:l,boundaries:u,keepAspectRatio:f,resizeDirection:d,onResizeStart:p,onResize:m,onResizeEnd:w,shouldResize:v}){let x={...Xi},N={...Bf};s={boundaries:u,resizeDirection:d,keepAspectRatio:f,controlDirection:Jo(l)};let h,y=null,S=[],E,_,$,D=!1;const F=Qr().on("start",A=>{const{nodeLookup:z,transform:H,snapGrid:b,snapToGrid:k,nodeOrigin:C,paneDomNode:P}=n();if(h=z.get(t),!h)return;y=P?.getBoundingClientRect()??null;const{xSnapped:I,ySnapped:T}=dt(A.sourceEvent,{transform:H,snapGrid:b,snapToGrid:k,containerBounds:y});x={width:h.measured.width??0,height:h.measured.height??0,x:h.position.x??0,y:h.position.y??0},N={...x,pointerX:I,pointerY:T,aspectRatio:x.width/x.height},E=void 0,h.parentId&&(h.extent==="parent"||h.expandParent)&&(E=z.get(h.parentId),_=E&&h.extent==="parent"?Ff(E):void 0),S=[],$=void 0;for(const[j,V]of z)if(V.parentId===t&&(S.push({id:j,position:{...V.position},extent:V.extent}),V.extent==="parent"||V.expandParent)){const O=Xf(V,h,V.origin??C);$?$=[[Math.min(O[0][0],$[0][0]),Math.min(O[0][1],$[0][1])],[Math.max(O[1][0],$[1][0]),Math.max(O[1][1],$[1][1])]]:$=O}p?.(A,{...x})}).on("drag",A=>{const{transform:z,snapGrid:H,snapToGrid:b,nodeOrigin:k}=n(),C=dt(A.sourceEvent,{transform:z,snapGrid:H,snapToGrid:b,containerBounds:y}),P=[];if(!h)return;const{x:I,y:T,width:j,height:V}=x,O={},W=h.origin??k,{width:Y,height:Q,x:ne,y:K}=Vf(N,s.controlDirection,C,s.boundaries,s.keepAspectRatio,W,_,$),X=Y!==j,U=Q!==V,re=ne!==I&&X,oe=K!==T&&U;if(!re&&!oe&&!X&&!U)return;if((re||oe||W[0]===1||W[1]===1)&&(O.x=re?ne:x.x,O.y=oe?K:x.y,x.x=O.x,x.y=O.y,S.length>0)){const R=ne-I,B=K-T;for(const q of S)q.position={x:q.position.x-R+W[0]*(Y-j),y:q.position.y-B+W[1]*(Q-V)},P.push(q)}if((X||U)&&(O.width=X&&(!s.resizeDirection||s.resizeDirection==="horizontal")?Y:x.width,O.height=U&&(!s.resizeDirection||s.resizeDirection==="vertical")?Q:x.height,x.width=O.width,x.height=O.height),E&&h.expandParent){const R=W[0]*(O.width??0);O.x&&O.x<R&&(x.x=R,N.x=N.x-(O.x-R));const B=W[1]*(O.height??0);O.y&&O.y<B&&(x.y=B,N.y=N.y-(O.y-B))}const J=Of({width:x.width,prevWidth:j,height:x.height,prevHeight:V,affectsX:s.controlDirection.affectsX,affectsY:s.controlDirection.affectsY}),te={...x,direction:J};v?.(A,te)!==!1&&(D=!0,m?.(A,te),o(O,P))}).on("end",A=>{D&&(w?.(A,{...x}),r?.({...x}),D=!1)});i.call(F)}function c(){i.on(".drag",null)}return{update:a,destroy:c}}var Cn={exports:{}},Sn={};var tr;function Wf(){if(tr)return Sn;tr=1;var e=Ia(),t=La();function n(l,u){return l===u&&(l!==0||1/l===1/u)||l!==l&&u!==u}var o=typeof Object.is=="function"?Object.is:n,r=t.useSyncExternalStore,i=e.useRef,s=e.useEffect,a=e.useMemo,c=e.useDebugValue;return Sn.useSyncExternalStoreWithSelector=function(l,u,f,d,p){var m=i(null);if(m.current===null){var w={hasValue:!1,value:null};m.current=w}else w=m.current;m=a(function(){function x(E){if(!N){if(N=!0,h=E,E=d(E),p!==void 0&&w.hasValue){var _=w.value;if(p(_,E))return y=_}return y=E}if(_=y,o(h,E))return _;var $=d(E);return p!==void 0&&p(_,$)?(h=E,_):(h=E,y=$)}var N=!1,h,y,S=f===void 0?null:f;return[function(){return x(u())},S===null?void 0:function(){return x(S())}]},[u,f,d,p]);var v=r(l,m[0],m[1]);return s(function(){w.hasValue=!0,w.value=v},[v]),c(v),v},Sn}var nr;function Zf(){return nr||(nr=1,Cn.exports=Wf()),Cn.exports}var qf=Zf();const Gf=Aa(qf),Uf={},or=e=>{let t;const n=new Set,o=(u,f)=>{const d=typeof u=="function"?u(t):u;if(!Object.is(d,t)){const p=t;t=f??(typeof d!="object"||d===null)?d:Object.assign({},t,d),n.forEach(m=>m(t,p))}},r=()=>t,c={setState:o,getState:r,getInitialState:()=>l,subscribe:u=>(n.add(u),()=>n.delete(u)),destroy:()=>{(Uf?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},l=t=e(o,r,c);return c},Kf=e=>e?or(e):or,{useDebugValue:Qf}=Pa,{useSyncExternalStoreWithSelector:Jf}=Gf,eh=e=>e;function Yi(e,t=eh,n){const o=Jf(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return Qf(o),o}const rr=(e,t)=>{const n=Kf(e),o=(r,i=t)=>Yi(n,r,i);return Object.assign(o,n),o},th=(e,t)=>e?rr(e,t):rr;function ae(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[o,r]of e)if(!Object.is(r,t.get(o)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const o of e)if(!t.has(o))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const o of n)if(!Object.prototype.hasOwnProperty.call(t,o)||!Object.is(e[o],t[o]))return!1;return!0}const fn=M.createContext(null),nh=fn.Provider,Wi=Ee.error001();function ie(e,t){const n=M.useContext(fn);if(n===null)throw new Error(Wi);return Yi(n,e,t)}function ce(){const e=M.useContext(fn);if(e===null)throw new Error(Wi);return M.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}const ir={display:"none"},oh={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},Zi="react-flow__node-desc",qi="react-flow__edge-desc",rh="react-flow__aria-live",ih=e=>e.ariaLiveMessage,sh=e=>e.ariaLabelConfig;function ah({rfId:e}){const t=ie(ih);return g.jsx("div",{id:`${rh}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:oh,children:t})}function ch({rfId:e,disableKeyboardA11y:t}){const n=ie(sh);return g.jsxs(g.Fragment,{children:[g.jsx("div",{id:`${Zi}-${e}`,style:ir,children:t?n["node.a11yDescription.default"]:n["node.a11yDescription.keyboardDisabled"]}),g.jsx("div",{id:`${qi}-${e}`,style:ir,children:n["edge.a11yDescription.default"]}),!t&&g.jsx(ah,{rfId:e})]})}const Mt=M.forwardRef(({position:e="top-left",children:t,className:n,style:o,...r},i)=>{const s=`${e}`.split("-");return g.jsx("div",{className:ue(["react-flow__panel",n,...s]),style:o,ref:i,...r,children:t})});Mt.displayName="Panel";function lh({proOptions:e,position:t="bottom-right"}){return e?.hideAttribution?null:g.jsx(Mt,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:g.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const uh=e=>{const t=[],n=[];for(const[,o]of e.nodeLookup)o.selected&&t.push(o.internals.userNode);for(const[,o]of e.edgeLookup)o.selected&&n.push(o);return{selectedNodes:t,selectedEdges:n}},Rt=e=>e.id;function dh(e,t){return ae(e.selectedNodes.map(Rt),t.selectedNodes.map(Rt))&&ae(e.selectedEdges.map(Rt),t.selectedEdges.map(Rt))}function fh({onSelectionChange:e}){const t=ce(),{selectedNodes:n,selectedEdges:o}=ie(uh,dh);return M.useEffect(()=>{const r={nodes:n,edges:o};e?.(r),t.getState().onSelectionChangeHandlers.forEach(i=>i(r))},[n,o,e]),null}const hh=e=>!!e.onSelectionChangeHandlers;function gh({onSelectionChange:e}){const t=ie(hh);return e||t?g.jsx(fh,{onSelectionChange:e}):null}const Gi=[0,0],ph={x:0,y:0,zoom:1},mh=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","connectionDragThreshold","onBeforeDelete","debug","autoPanSpeed","ariaLabelConfig","zIndexMode"],sr=[...mh,"rfId"],xh=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges}),ar={translateExtent:mt,nodeOrigin:Gi,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1"};function yh(e){const{setNodes:t,setEdges:n,setMinZoom:o,setMaxZoom:r,setTranslateExtent:i,setNodeExtent:s,reset:a,setDefaultNodesAndEdges:c}=ie(xh,ae),l=ce();M.useEffect(()=>(c(e.defaultNodes,e.defaultEdges),()=>{u.current=ar,a()}),[]);const u=M.useRef(ar);return M.useEffect(()=>{for(const f of sr){const d=e[f],p=u.current[f];d!==p&&(typeof e[f]>"u"||(f==="nodes"?t(d):f==="edges"?n(d):f==="minZoom"?o(d):f==="maxZoom"?r(d):f==="translateExtent"?i(d):f==="nodeExtent"?s(d):f==="ariaLabelConfig"?l.setState({ariaLabelConfig:of(d)}):f==="fitView"?l.setState({fitViewQueued:d}):f==="fitViewOptions"?l.setState({fitViewOptions:d}):l.setState({[f]:d})))}u.current=e},sr.map(f=>e[f])),null}function cr(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function wh(e){const[t,n]=M.useState(e==="system"?null:e);return M.useEffect(()=>{if(e!=="system"){n(e);return}const o=cr(),r=()=>n(o?.matches?"dark":"light");return r(),o?.addEventListener("change",r),()=>{o?.removeEventListener("change",r)}},[e]),t!==null?t:cr()?.matches?"dark":"light"}const lr=typeof document<"u"?document:null;function vt(e=null,t={target:lr,actInsideInputWithModifier:!0}){const[n,o]=M.useState(!1),r=M.useRef(!1),i=M.useRef(new Set([])),[s,a]=M.useMemo(()=>{if(e!==null){const l=(Array.isArray(e)?e:[e]).filter(f=>typeof f=="string").map(f=>f.replace("+",`
`).replace(`

`,`
+`).split(`
`)),u=l.reduce((f,d)=>f.concat(...d),[]);return[l,u]}return[[],[]]},[e]);return M.useEffect(()=>{const c=t?.target??lr,l=t?.actInsideInputWithModifier??!0;if(e!==null){const u=p=>{if(r.current=p.ctrlKey||p.metaKey||p.shiftKey||p.altKey,(!r.current||r.current&&!l)&&Si(p))return!1;const w=dr(p.code,a);if(i.current.add(p[w]),ur(s,i.current,!1)){const v=p.composedPath?.()?.[0]||p.target,x=v?.nodeName==="BUTTON"||v?.nodeName==="A";t.preventDefault!==!1&&(r.current||!x)&&p.preventDefault(),o(!0)}},f=p=>{const m=dr(p.code,a);ur(s,i.current,!0)?(o(!1),i.current.clear()):i.current.delete(p[m]),p.key==="Meta"&&i.current.clear(),r.current=!1},d=()=>{i.current.clear(),o(!1)};return c?.addEventListener("keydown",u),c?.addEventListener("keyup",f),window.addEventListener("blur",d),window.addEventListener("contextmenu",d),()=>{c?.removeEventListener("keydown",u),c?.removeEventListener("keyup",f),window.removeEventListener("blur",d),window.removeEventListener("contextmenu",d)}}},[e,o]),n}function ur(e,t,n){return e.filter(o=>n||o.length===t.size).some(o=>o.every(r=>t.has(r)))}function dr(e,t){return t.includes(e)?"code":"key"}const vh=()=>{const e=ce();return M.useMemo(()=>({zoomIn:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1.2,{duration:t?.duration}):Promise.resolve(!1)},zoomOut:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1/1.2,{duration:t?.duration}):Promise.resolve(!1)},zoomTo:(t,n)=>{const{panZoom:o}=e.getState();return o?o.scaleTo(t,{duration:n?.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,n)=>{const{transform:[o,r,i],panZoom:s}=e.getState();return s?(await s.setViewport({x:t.x??o,y:t.y??r,zoom:t.zoom??i},n),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[t,n,o]=e.getState().transform;return{x:t,y:n,zoom:o}},setCenter:async(t,n,o)=>e.getState().setCenter(t,n,o),fitBounds:async(t,n)=>{const{width:o,height:r,minZoom:i,maxZoom:s,panZoom:a}=e.getState(),c=eo(t,o,r,i,s,n?.padding??.1);return a?(await a.setViewport(c,{duration:n?.duration,ease:n?.ease,interpolate:n?.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,n={})=>{const{transform:o,snapGrid:r,snapToGrid:i,domNode:s}=e.getState();if(!s)return t;const{x:a,y:c}=s.getBoundingClientRect(),l={x:t.x-a,y:t.y-c},u=n.snapGrid??r,f=n.snapToGrid??i;return kt(l,o,f,u)},flowToScreenPosition:t=>{const{transform:n,domNode:o}=e.getState();if(!o)return t;const{x:r,y:i}=o.getBoundingClientRect(),s=en(t,n);return{x:s.x+r,y:s.y+i}}}),[])};function Ui(e,t){const n=[],o=new Map,r=[];for(const i of e)if(i.type==="add"){r.push(i);continue}else if(i.type==="remove"||i.type==="replace")o.set(i.id,[i]);else{const s=o.get(i.id);s?s.push(i):o.set(i.id,[i])}for(const i of t){const s=o.get(i.id);if(!s){n.push(i);continue}if(s[0].type==="remove")continue;if(s[0].type==="replace"){n.push({...s[0].item});continue}const a={...i};for(const c of s)bh(c,a);n.push(a)}return r.length&&r.forEach(i=>{i.index!==void 0?n.splice(i.index,0,{...i.item}):n.push({...i.item})}),n}function bh(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured={...e.dimensions},e.setAttributes&&((e.setAttributes===!0||e.setAttributes==="width")&&(t.width=e.dimensions.width),(e.setAttributes===!0||e.setAttributes==="height")&&(t.height=e.dimensions.height))),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function Ki(e,t){return Ui(e,t)}function Qi(e,t){return Ui(e,t)}function je(e,t){return{id:e,type:"select",selected:t}}function qe(e,t=new Set,n=!1){const o=[];for(const[r,i]of e){const s=t.has(r);!(i.selected===void 0&&!s)&&i.selected!==s&&(n&&(i.selected=s),o.push(je(i.id,s)))}return o}function fr({items:e=[],lookup:t}){const n=[],o=new Map(e.map(r=>[r.id,r]));for(const[r,i]of e.entries()){const s=t.get(i.id),a=s?.internals?.userNode??s;a!==void 0&&a!==i&&n.push({id:i.id,item:i,type:"replace"}),a===void 0&&n.push({item:i,type:"add",index:r})}for(const[r]of t)o.get(r)===void 0&&n.push({id:r,type:"remove"});return n}function hr(e){return{id:e.id,type:"remove"}}const gr=e=>Zd(e),Nh=e=>yi(e);function Ji(e){return M.forwardRef(e)}const Eh=typeof window<"u"?M.useLayoutEffect:M.useEffect;function pr(e){const[t,n]=M.useState(BigInt(0)),[o]=M.useState(()=>_h(()=>n(r=>r+BigInt(1))));return Eh(()=>{const r=o.get();r.length&&(e(r),o.reset())},[t]),o}function _h(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}}const es=M.createContext(null);function Ch({children:e}){const t=ce(),n=M.useCallback(a=>{const{nodes:c=[],setNodes:l,hasDefaultNodes:u,onNodesChange:f,nodeLookup:d,fitViewQueued:p,onNodesChangeMiddlewareMap:m}=t.getState();let w=c;for(const x of a)w=typeof x=="function"?x(w):x;let v=fr({items:w,lookup:d});for(const x of m.values())v=x(v);u&&l(w),v.length>0?f?.(v):p&&window.requestAnimationFrame(()=>{const{fitViewQueued:x,nodes:N,setNodes:h}=t.getState();x&&h(N)})},[]),o=pr(n),r=M.useCallback(a=>{const{edges:c=[],setEdges:l,hasDefaultEdges:u,onEdgesChange:f,edgeLookup:d}=t.getState();let p=c;for(const m of a)p=typeof m=="function"?m(p):m;u?l(p):f&&f(fr({items:p,lookup:d}))},[]),i=pr(r),s=M.useMemo(()=>({nodeQueue:o,edgeQueue:i}),[]);return g.jsx(es.Provider,{value:s,children:e})}function Sh(){const e=M.useContext(es);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}const kh=e=>!!e.panZoom;function ao(){const e=vh(),t=ce(),n=Sh(),o=ie(kh),r=M.useMemo(()=>{const i=f=>t.getState().nodeLookup.get(f),s=f=>{n.nodeQueue.push(f)},a=f=>{n.edgeQueue.push(f)},c=f=>{const{nodeLookup:d,nodeOrigin:p}=t.getState(),m=gr(f)?f:d.get(f.id),w=m.parentId?_i(m.position,m.measured,m.parentId,d,p):m.position,v={...m,position:w,width:m.measured?.width??m.width,height:m.measured?.height??m.height};return tt(v)},l=(f,d,p={replace:!1})=>{s(m=>m.map(w=>{if(w.id===f){const v=typeof d=="function"?d(w):d;return p.replace&&gr(v)?v:{...w,...v}}return w}))},u=(f,d,p={replace:!1})=>{a(m=>m.map(w=>{if(w.id===f){const v=typeof d=="function"?d(w):d;return p.replace&&Nh(v)?v:{...w,...v}}return w}))};return{getNodes:()=>t.getState().nodes.map(f=>({...f})),getNode:f=>i(f)?.internals.userNode,getInternalNode:i,getEdges:()=>{const{edges:f=[]}=t.getState();return f.map(d=>({...d}))},getEdge:f=>t.getState().edgeLookup.get(f),setNodes:s,setEdges:a,addNodes:f=>{const d=Array.isArray(f)?f:[f];n.nodeQueue.push(p=>[...p,...d])},addEdges:f=>{const d=Array.isArray(f)?f:[f];n.edgeQueue.push(p=>[...p,...d])},toObject:()=>{const{nodes:f=[],edges:d=[],transform:p}=t.getState(),[m,w,v]=p;return{nodes:f.map(x=>({...x})),edges:d.map(x=>({...x})),viewport:{x:m,y:w,zoom:v}}},deleteElements:async({nodes:f=[],edges:d=[]})=>{const{nodes:p,edges:m,onNodesDelete:w,onEdgesDelete:v,triggerNodeChanges:x,triggerEdgeChanges:N,onDelete:h,onBeforeDelete:y}=t.getState(),{nodes:S,edges:E}=await Qd({nodesToRemove:f,edgesToRemove:d,nodes:p,edges:m,onBeforeDelete:y}),_=E.length>0,$=S.length>0;if(_){const D=E.map(hr);v?.(E),N(D)}if($){const D=S.map(hr);w?.(S),x(D)}return($||_)&&h?.({nodes:S,edges:E}),{deletedNodes:S,deletedEdges:E}},getIntersectingNodes:(f,d=!0,p)=>{const m=Bo(f),w=m?f:c(f),v=p!==void 0;return w?(p||t.getState().nodes).filter(x=>{const N=t.getState().nodeLookup.get(x.id);if(N&&!m&&(x.id===f.id||!N.internals.positionAbsolute))return!1;const h=tt(v?x:N),y=yt(h,w);return d&&y>0||y>=h.width*h.height||y>=w.width*w.height}):[]},isNodeIntersecting:(f,d,p=!0)=>{const w=Bo(f)?f:c(f);if(!w)return!1;const v=yt(w,d);return p&&v>0||v>=d.width*d.height||v>=w.width*w.height},updateNode:l,updateNodeData:(f,d,p={replace:!1})=>{l(f,m=>{const w=typeof d=="function"?d(m):d;return p.replace?{...m,data:w}:{...m,data:{...m.data,...w}}},p)},updateEdge:u,updateEdgeData:(f,d,p={replace:!1})=>{u(f,m=>{const w=typeof d=="function"?d(m):d;return p.replace?{...m,data:w}:{...m,data:{...m.data,...w}}},p)},getNodesBounds:f=>{const{nodeLookup:d,nodeOrigin:p}=t.getState();return qd(f,{nodeLookup:d,nodeOrigin:p})},getHandleConnections:({type:f,id:d,nodeId:p})=>Array.from(t.getState().connectionLookup.get(`${p}-${f}${d?`-${d}`:""}`)?.values()??[]),getNodeConnections:({type:f,handleId:d,nodeId:p})=>Array.from(t.getState().connectionLookup.get(`${p}${f?d?`-${f}-${d}`:`-${f}`:""}`)?.values()??[]),fitView:async f=>{const d=t.getState().fitViewResolver??nf();return t.setState({fitViewQueued:!0,fitViewOptions:f,fitViewResolver:d}),n.nodeQueue.push(p=>[...p]),d.promise}}},[]);return M.useMemo(()=>({...r,...e,viewportInitialized:o}),[o])}const mr=e=>e.selected,Mh=typeof window<"u"?window:void 0;function Ih({deleteKeyCode:e,multiSelectionKeyCode:t}){const n=ce(),{deleteElements:o}=ao(),r=vt(e,{actInsideInputWithModifier:!1}),i=vt(t,{target:Mh});M.useEffect(()=>{if(r){const{edges:s,nodes:a}=n.getState();o({nodes:a.filter(mr),edges:s.filter(mr)}),n.setState({nodesSelectionActive:!1})}},[r]),M.useEffect(()=>{n.setState({multiSelectionActive:i})},[i])}function Ah(e){const t=ce();M.useEffect(()=>{const n=()=>{if(!e.current||!(e.current.checkVisibility?.()??!0))return!1;const o=to(e.current);(o.height===0||o.width===0)&&t.getState().onError?.("004",Ee.error004()),t.setState({width:o.width||500,height:o.height||500})};if(e.current){n(),window.addEventListener("resize",n);const o=new ResizeObserver(()=>n());return o.observe(e.current),()=>{window.removeEventListener("resize",n),o&&e.current&&o.unobserve(e.current)}}},[])}const hn={position:"absolute",width:"100%",height:"100%",top:0,left:0},Ph=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib,connectionInProgress:e.connection.inProgress});function $h({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:n=!0,panOnScroll:o=!1,panOnScrollSpeed:r=.5,panOnScrollMode:i=Oe.Free,zoomOnDoubleClick:s=!0,panOnDrag:a=!0,defaultViewport:c,translateExtent:l,minZoom:u,maxZoom:f,zoomActivationKeyCode:d,preventScrolling:p=!0,children:m,noWheelClassName:w,noPanClassName:v,onViewportChange:x,isControlledViewport:N,paneClickDistance:h,selectionOnDrag:y}){const S=ce(),E=M.useRef(null),{userSelectionActive:_,lib:$,connectionInProgress:D}=ie(Ph,ae),F=vt(d),A=M.useRef();Ah(E);const z=M.useCallback(H=>{x?.({x:H[0],y:H[1],zoom:H[2]}),N||S.setState({transform:H})},[x,N]);return M.useEffect(()=>{if(E.current){A.current=Lf({domNode:E.current,minZoom:u,maxZoom:f,translateExtent:l,viewport:c,onDraggingChange:C=>S.setState({paneDragging:C}),onPanZoomStart:(C,P)=>{const{onViewportChangeStart:I,onMoveStart:T}=S.getState();T?.(C,P),I?.(P)},onPanZoom:(C,P)=>{const{onViewportChange:I,onMove:T}=S.getState();T?.(C,P),I?.(P)},onPanZoomEnd:(C,P)=>{const{onViewportChangeEnd:I,onMoveEnd:T}=S.getState();T?.(C,P),I?.(P)}});const{x:H,y:b,zoom:k}=A.current.getViewport();return S.setState({panZoom:A.current,transform:[H,b,k],domNode:E.current.closest(".react-flow")}),()=>{A.current?.destroy()}}},[]),M.useEffect(()=>{A.current?.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:n,panOnScroll:o,panOnScrollSpeed:r,panOnScrollMode:i,zoomOnDoubleClick:s,panOnDrag:a,zoomActivationKeyPressed:F,preventScrolling:p,noPanClassName:v,userSelectionActive:_,noWheelClassName:w,lib:$,onTransformChange:z,connectionInProgress:D,selectionOnDrag:y,paneClickDistance:h})},[e,t,n,o,r,i,s,a,F,p,v,_,w,$,z,D,y,h]),g.jsx("div",{className:"react-flow__renderer",ref:E,style:hn,children:m})}const Th=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function Dh(){const{userSelectionActive:e,userSelectionRect:t}=ie(Th,ae);return e&&t?g.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}const kn=(e,t)=>n=>{n.target===t.current&&e?.(n)},zh=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,connectionInProgress:e.connection.inProgress,dragging:e.paneDragging});function jh({isSelecting:e,selectionKeyPressed:t,selectionMode:n=xt.Full,panOnDrag:o,paneClickDistance:r,selectionOnDrag:i,onSelectionStart:s,onSelectionEnd:a,onPaneClick:c,onPaneContextMenu:l,onPaneScroll:u,onPaneMouseEnter:f,onPaneMouseMove:d,onPaneMouseLeave:p,children:m}){const w=ce(),{userSelectionActive:v,elementsSelectable:x,dragging:N,connectionInProgress:h}=ie(zh,ae),y=x&&(e||v),S=M.useRef(null),E=M.useRef(),_=M.useRef(new Set),$=M.useRef(new Set),D=M.useRef(!1),F=I=>{if(D.current||h){D.current=!1;return}c?.(I),w.getState().resetSelectedElements(),w.setState({nodesSelectionActive:!1})},A=I=>{if(Array.isArray(o)&&o?.includes(2)){I.preventDefault();return}l?.(I)},z=u?I=>u(I):void 0,H=I=>{D.current&&(I.stopPropagation(),D.current=!1)},b=I=>{const{domNode:T}=w.getState();if(E.current=T?.getBoundingClientRect(),!E.current)return;const j=I.target===S.current;if(!j&&!!I.target.closest(".nokey")||!e||!(i&&j||t)||I.button!==0||!I.isPrimary)return;I.target?.setPointerCapture?.(I.pointerId),D.current=!1;const{x:W,y:Y}=we(I.nativeEvent,E.current);w.setState({userSelectionRect:{width:0,height:0,startX:W,startY:Y,x:W,y:Y}}),j||(I.stopPropagation(),I.preventDefault())},k=I=>{const{userSelectionRect:T,transform:j,nodeLookup:V,edgeLookup:O,connectionLookup:W,triggerNodeChanges:Y,triggerEdgeChanges:Q,defaultEdgeOptions:ne,resetSelectedElements:K}=w.getState();if(!E.current||!T)return;const{x:X,y:U}=we(I.nativeEvent,E.current),{startX:re,startY:oe}=T;if(!D.current){const B=t?0:r;if(Math.hypot(X-re,U-oe)<=B)return;K(),s?.(I)}D.current=!0;const J={startX:re,startY:oe,x:X<re?X:re,y:U<oe?U:oe,width:Math.abs(X-re),height:Math.abs(U-oe)},te=_.current,L=$.current;_.current=new Set(Jn(V,J,j,n===xt.Partial,!0).map(B=>B.id)),$.current=new Set;const R=ne?.selectable??!0;for(const B of _.current){const q=W.get(B);if(q)for(const{edgeId:G}of q.values()){const ee=O.get(G);ee&&(ee.selectable??R)&&$.current.add(G)}}if(!Fo(te,_.current)){const B=qe(V,_.current,!0);Y(B)}if(!Fo(L,$.current)){const B=qe(O,$.current);Q(B)}w.setState({userSelectionRect:J,userSelectionActive:!0,nodesSelectionActive:!1})},C=I=>{I.button===0&&(I.target?.releasePointerCapture?.(I.pointerId),!v&&I.target===S.current&&w.getState().userSelectionRect&&F?.(I),w.setState({userSelectionActive:!1,userSelectionRect:null}),D.current&&(a?.(I),w.setState({nodesSelectionActive:_.current.size>0})))},P=o===!0||Array.isArray(o)&&o.includes(0);return g.jsxs("div",{className:ue(["react-flow__pane",{draggable:P,dragging:N,selection:e}]),onClick:y?void 0:kn(F,S),onContextMenu:kn(A,S),onWheel:kn(z,S),onPointerEnter:y?void 0:f,onPointerMove:y?k:d,onPointerUp:y?C:void 0,onPointerDownCapture:y?b:void 0,onClickCapture:y?H:void 0,onPointerLeave:p,ref:S,style:hn,children:[m,g.jsx(Dh,{})]})}function Xn({id:e,store:t,unselect:n=!1,nodeRef:o}){const{addSelectedNodes:r,unselectNodesAndEdges:i,multiSelectionActive:s,nodeLookup:a,onError:c}=t.getState(),l=a.get(e);if(!l){c?.("012",Ee.error012(e));return}t.setState({nodesSelectionActive:!1}),l.selected?(n||l.selected&&s)&&(i({nodes:[l],edges:[]}),requestAnimationFrame(()=>o?.current?.blur())):r([e])}function ts({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:o,nodeId:r,isSelectable:i,nodeClickDistance:s}){const a=ce(),[c,l]=M.useState(!1),u=M.useRef();return M.useEffect(()=>{u.current=Cf({getStoreItems:()=>a.getState(),onNodeMouseDown:f=>{Xn({id:f,store:a,nodeRef:e})},onDragStart:()=>{l(!0)},onDragStop:()=>{l(!1)}})},[]),M.useEffect(()=>{if(t)u.current?.destroy();else if(e.current)return u.current?.update({noDragClassName:n,handleSelector:o,domNode:e.current,isSelectable:i,nodeId:r,nodeClickDistance:s}),()=>{u.current?.destroy()}},[n,o,t,i,e,r]),c}const Hh=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function ns(){const e=ce();return M.useCallback(n=>{const{nodeExtent:o,snapToGrid:r,snapGrid:i,nodesDraggable:s,onError:a,updateNodePositions:c,nodeLookup:l,nodeOrigin:u}=e.getState(),f=new Map,d=Hh(s),p=r?i[0]:5,m=r?i[1]:5,w=n.direction.x*p*n.factor,v=n.direction.y*m*n.factor;for(const[,x]of l){if(!d(x))continue;let N={x:x.internals.positionAbsolute.x+w,y:x.internals.positionAbsolute.y+v};r&&(N=St(N,i));const{position:h,positionAbsolute:y}=wi({nodeId:x.id,nextPosition:N,nodeLookup:l,nodeExtent:o,nodeOrigin:u,onError:a});x.position=h,x.internals.positionAbsolute=y,f.set(x.id,x)}c(f)},[])}const co=M.createContext(null),Rh=co.Provider;co.Consumer;const lo=()=>M.useContext(co),Lh=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),Oh=(e,t,n)=>o=>{const{connectionClickStartHandle:r,connectionMode:i,connection:s}=o,{fromHandle:a,toHandle:c,isValid:l}=s,u=c?.nodeId===e&&c?.id===t&&c?.type===n;return{connectingFrom:a?.nodeId===e&&a?.id===t&&a?.type===n,connectingTo:u,clickConnecting:r?.nodeId===e&&r?.id===t&&r?.type===n,isPossibleEndHandle:i===Je.Strict?a?.type!==n:e!==a?.nodeId||t!==a?.id,connectionInProcess:!!a,clickConnectionInProcess:!!r,valid:u&&l}};function Vh({type:e="source",position:t=Z.Top,isValidConnection:n,isConnectable:o=!0,isConnectableStart:r=!0,isConnectableEnd:i=!0,id:s,onConnect:a,children:c,className:l,onMouseDown:u,onTouchStart:f,...d},p){const m=s||null,w=e==="target",v=ce(),x=lo(),{connectOnClick:N,noPanClassName:h,rfId:y}=ie(Lh,ae),{connectingFrom:S,connectingTo:E,clickConnecting:_,isPossibleEndHandle:$,connectionInProcess:D,clickConnectionInProcess:F,valid:A}=ie(Oh(x,m,e),ae);x||v.getState().onError?.("010",Ee.error010());const z=k=>{const{defaultEdgeOptions:C,onConnect:P,hasDefaultEdges:I}=v.getState(),T={...C,...k};if(I){const{edges:j,setEdges:V}=v.getState();V($i(T,j))}P?.(T),a?.(T)},H=k=>{if(!x)return;const C=ki(k.nativeEvent);if(r&&(C&&k.button===0||!C)){const P=v.getState();Fn.onPointerDown(k.nativeEvent,{handleDomNode:k.currentTarget,autoPanOnConnect:P.autoPanOnConnect,connectionMode:P.connectionMode,connectionRadius:P.connectionRadius,domNode:P.domNode,nodeLookup:P.nodeLookup,lib:P.lib,isTarget:w,handleId:m,nodeId:x,flowId:P.rfId,panBy:P.panBy,cancelConnection:P.cancelConnection,onConnectStart:P.onConnectStart,onConnectEnd:P.onConnectEnd,updateConnection:P.updateConnection,onConnect:z,isValidConnection:n||P.isValidConnection,getTransform:()=>v.getState().transform,getFromHandle:()=>v.getState().connection.fromHandle,autoPanSpeed:P.autoPanSpeed,dragThreshold:P.connectionDragThreshold})}C?u?.(k):f?.(k)},b=k=>{const{onClickConnectStart:C,onClickConnectEnd:P,connectionClickStartHandle:I,connectionMode:T,isValidConnection:j,lib:V,rfId:O,nodeLookup:W,connection:Y}=v.getState();if(!x||!I&&!r)return;if(!I){C?.(k.nativeEvent,{nodeId:x,handleId:m,handleType:e}),v.setState({connectionClickStartHandle:{nodeId:x,type:e,id:m}});return}const Q=Ci(k.target),ne=n||j,{connection:K,isValid:X}=Fn.isValid(k.nativeEvent,{handle:{nodeId:x,id:m,type:e},connectionMode:T,fromNodeId:I.nodeId,fromHandleId:I.id||null,fromType:I.type,isValidConnection:ne,flowId:O,doc:Q,lib:V,nodeLookup:W});X&&K&&z(K);const U=structuredClone(Y);delete U.inProgress,U.toPosition=U.toHandle?U.toHandle.position:null,P?.(k,U),v.setState({connectionClickStartHandle:null})};return g.jsx("div",{"data-handleid":m,"data-nodeid":x,"data-handlepos":t,"data-id":`${y}-${x}-${m}-${e}`,className:ue(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",h,l,{source:!w,target:w,connectable:o,connectablestart:r,connectableend:i,clickconnecting:_,connectingfrom:S,connectingto:E,valid:A,connectionindicator:o&&(!D||$)&&(D||F?i:r)}]),onMouseDown:H,onTouchStart:H,onClick:N?b:void 0,ref:p,...d,children:c})}const bt=M.memo(Ji(Vh));function Bh({data:e,isConnectable:t,sourcePosition:n=Z.Bottom}){return g.jsxs(g.Fragment,{children:[e?.label,g.jsx(bt,{type:"source",position:n,isConnectable:t})]})}function Fh({data:e,isConnectable:t,targetPosition:n=Z.Top,sourcePosition:o=Z.Bottom}){return g.jsxs(g.Fragment,{children:[g.jsx(bt,{type:"target",position:n,isConnectable:t}),e?.label,g.jsx(bt,{type:"source",position:o,isConnectable:t})]})}function Xh(){return null}function Yh({data:e,isConnectable:t,targetPosition:n=Z.Top}){return g.jsxs(g.Fragment,{children:[g.jsx(bt,{type:"target",position:n,isConnectable:t}),e?.label]})}const tn={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},xr={input:Bh,default:Fh,output:Yh,group:Xh};function Wh(e){return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??e.style?.width,height:e.height??e.initialHeight??e.style?.height}:{width:e.width??e.style?.width,height:e.height??e.style?.height}}const Zh=e=>{const{width:t,height:n,x:o,y:r}=Ct(e.nodeLookup,{filter:i=>!!i.selected});return{width:ye(t)?t:null,height:ye(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${o}px,${r}px)`}};function qh({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const o=ce(),{width:r,height:i,transformString:s,userSelectionActive:a}=ie(Zh,ae),c=ns(),l=M.useRef(null);if(M.useEffect(()=>{n||l.current?.focus({preventScroll:!0})},[n]),ts({nodeRef:l}),a||!r||!i)return null;const u=e?d=>{const p=o.getState().nodes.filter(m=>m.selected);e(d,p)}:void 0,f=d=>{Object.prototype.hasOwnProperty.call(tn,d.key)&&(d.preventDefault(),c({direction:tn[d.key],factor:d.shiftKey?4:1}))};return g.jsx("div",{className:ue(["react-flow__nodesselection","react-flow__container",t]),style:{transform:s},children:g.jsx("div",{ref:l,className:"react-flow__nodesselection-rect",onContextMenu:u,tabIndex:n?void 0:-1,onKeyDown:n?void 0:f,style:{width:r,height:i}})})}const yr=typeof window<"u"?window:void 0,Gh=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function os({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:r,onPaneContextMenu:i,onPaneScroll:s,paneClickDistance:a,deleteKeyCode:c,selectionKeyCode:l,selectionOnDrag:u,selectionMode:f,onSelectionStart:d,onSelectionEnd:p,multiSelectionKeyCode:m,panActivationKeyCode:w,zoomActivationKeyCode:v,elementsSelectable:x,zoomOnScroll:N,zoomOnPinch:h,panOnScroll:y,panOnScrollSpeed:S,panOnScrollMode:E,zoomOnDoubleClick:_,panOnDrag:$,defaultViewport:D,translateExtent:F,minZoom:A,maxZoom:z,preventScrolling:H,onSelectionContextMenu:b,noWheelClassName:k,noPanClassName:C,disableKeyboardA11y:P,onViewportChange:I,isControlledViewport:T}){const{nodesSelectionActive:j,userSelectionActive:V}=ie(Gh,ae),O=vt(l,{target:yr}),W=vt(w,{target:yr}),Y=W||$,Q=W||y,ne=u&&Y!==!0,K=O||V||ne;return Ih({deleteKeyCode:c,multiSelectionKeyCode:m}),g.jsx($h,{onPaneContextMenu:i,elementsSelectable:x,zoomOnScroll:N,zoomOnPinch:h,panOnScroll:Q,panOnScrollSpeed:S,panOnScrollMode:E,zoomOnDoubleClick:_,panOnDrag:!O&&Y,defaultViewport:D,translateExtent:F,minZoom:A,maxZoom:z,zoomActivationKeyCode:v,preventScrolling:H,noWheelClassName:k,noPanClassName:C,onViewportChange:I,isControlledViewport:T,paneClickDistance:a,selectionOnDrag:ne,children:g.jsxs(jh,{onSelectionStart:d,onSelectionEnd:p,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:r,onPaneContextMenu:i,onPaneScroll:s,panOnDrag:Y,isSelecting:!!K,selectionMode:f,selectionKeyPressed:O,paneClickDistance:a,selectionOnDrag:ne,children:[e,j&&g.jsx(qh,{onSelectionContextMenu:b,noPanClassName:C,disableKeyboardA11y:P})]})})}os.displayName="FlowRenderer";const Uh=M.memo(os),Kh=e=>t=>e?Jn(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(n=>n.id):Array.from(t.nodeLookup.keys());function Qh(e){return ie(M.useCallback(Kh(e),[e]),ae)}const Jh=e=>e.updateNodeInternals;function eg(){const e=ie(Jh),[t]=M.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(n=>{const o=new Map;n.forEach(r=>{const i=r.target.getAttribute("data-id");o.set(i,{id:i,nodeElement:r.target,force:!0})}),e(o)}));return M.useEffect(()=>()=>{t?.disconnect()},[t]),t}function tg({node:e,nodeType:t,hasDimensions:n,resizeObserver:o}){const r=ce(),i=M.useRef(null),s=M.useRef(null),a=M.useRef(e.sourcePosition),c=M.useRef(e.targetPosition),l=M.useRef(t),u=n&&!!e.internals.handleBounds;return M.useEffect(()=>{i.current&&!e.hidden&&(!u||s.current!==i.current)&&(s.current&&o?.unobserve(s.current),o?.observe(i.current),s.current=i.current)},[u,e.hidden]),M.useEffect(()=>()=>{s.current&&(o?.unobserve(s.current),s.current=null)},[]),M.useEffect(()=>{if(i.current){const f=l.current!==t,d=a.current!==e.sourcePosition,p=c.current!==e.targetPosition;(f||d||p)&&(l.current=t,a.current=e.sourcePosition,c.current=e.targetPosition,r.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:i.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),i}function ng({id:e,onClick:t,onMouseEnter:n,onMouseMove:o,onMouseLeave:r,onContextMenu:i,onDoubleClick:s,nodesDraggable:a,elementsSelectable:c,nodesConnectable:l,nodesFocusable:u,resizeObserver:f,noDragClassName:d,noPanClassName:p,disableKeyboardA11y:m,rfId:w,nodeTypes:v,nodeClickDistance:x,onError:N}){const{node:h,internals:y,isParent:S}=ie(X=>{const U=X.nodeLookup.get(e),re=X.parentLookup.has(e);return{node:U,internals:U.internals,isParent:re}},ae);let E=h.type||"default",_=v?.[E]||xr[E];_===void 0&&(N?.("003",Ee.error003(E)),E="default",_=v?.default||xr.default);const $=!!(h.draggable||a&&typeof h.draggable>"u"),D=!!(h.selectable||c&&typeof h.selectable>"u"),F=!!(h.connectable||l&&typeof h.connectable>"u"),A=!!(h.focusable||u&&typeof h.focusable>"u"),z=ce(),H=Ei(h),b=tg({node:h,nodeType:E,hasDimensions:H,resizeObserver:f}),k=ts({nodeRef:b,disabled:h.hidden||!$,noDragClassName:d,handleSelector:h.dragHandle,nodeId:e,isSelectable:D,nodeClickDistance:x}),C=ns();if(h.hidden)return null;const P=Ie(h),I=Wh(h),T=D||$||t||n||o||r,j=n?X=>n(X,{...y.userNode}):void 0,V=o?X=>o(X,{...y.userNode}):void 0,O=r?X=>r(X,{...y.userNode}):void 0,W=i?X=>i(X,{...y.userNode}):void 0,Y=s?X=>s(X,{...y.userNode}):void 0,Q=X=>{const{selectNodesOnDrag:U,nodeDragThreshold:re}=z.getState();D&&(!U||!$||re>0)&&Xn({id:e,store:z,nodeRef:b}),t&&t(X,{...y.userNode})},ne=X=>{if(!(Si(X.nativeEvent)||m)){if(gi.includes(X.key)&&D){const U=X.key==="Escape";Xn({id:e,store:z,unselect:U,nodeRef:b})}else if($&&h.selected&&Object.prototype.hasOwnProperty.call(tn,X.key)){X.preventDefault();const{ariaLabelConfig:U}=z.getState();z.setState({ariaLiveMessage:U["node.a11yDescription.ariaLiveMessage"]({direction:X.key.replace("Arrow","").toLowerCase(),x:~~y.positionAbsolute.x,y:~~y.positionAbsolute.y})}),C({direction:tn[X.key],factor:X.shiftKey?4:1})}}},K=()=>{if(m||!b.current?.matches(":focus-visible"))return;const{transform:X,width:U,height:re,autoPanOnNodeFocus:oe,setCenter:J}=z.getState();if(!oe)return;Jn(new Map([[e,h]]),{x:0,y:0,width:U,height:re},X,!0).length>0||J(h.position.x+P.width/2,h.position.y+P.height/2,{zoom:X[2]})};return g.jsx("div",{className:ue(["react-flow__node",`react-flow__node-${E}`,{[p]:$},h.className,{selected:h.selected,selectable:D,parent:S,draggable:$,dragging:k}]),ref:b,style:{zIndex:y.z,transform:`translate(${y.positionAbsolute.x}px,${y.positionAbsolute.y}px)`,pointerEvents:T?"all":"none",visibility:H?"visible":"hidden",...h.style,...I},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:j,onMouseMove:V,onMouseLeave:O,onContextMenu:W,onClick:Q,onDoubleClick:Y,onKeyDown:A?ne:void 0,tabIndex:A?0:void 0,onFocus:A?K:void 0,role:h.ariaRole??(A?"group":void 0),"aria-roledescription":"node","aria-describedby":m?void 0:`${Zi}-${w}`,"aria-label":h.ariaLabel,...h.domAttributes,children:g.jsx(Rh,{value:e,children:g.jsx(_,{id:e,data:h.data,type:E,positionAbsoluteX:y.positionAbsolute.x,positionAbsoluteY:y.positionAbsolute.y,selected:h.selected??!1,selectable:D,draggable:$,deletable:h.deletable??!0,isConnectable:F,sourcePosition:h.sourcePosition,targetPosition:h.targetPosition,dragging:k,dragHandle:h.dragHandle,zIndex:y.z,parentId:h.parentId,...P})})})}var og=M.memo(ng);const rg=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function rs(e){const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:o,elementsSelectable:r,onError:i}=ie(rg,ae),s=Qh(e.onlyRenderVisibleElements),a=eg();return g.jsx("div",{className:"react-flow__nodes",style:hn,children:s.map(c=>g.jsx(og,{id:c,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:a,nodesDraggable:t,nodesConnectable:n,nodesFocusable:o,elementsSelectable:r,nodeClickDistance:e.nodeClickDistance,onError:i},c))})}rs.displayName="NodeRenderer";const ig=M.memo(rs);function sg(e){return ie(M.useCallback(n=>{if(!e)return n.edges.map(r=>r.id);const o=[];if(n.width&&n.height)for(const r of n.edges){const i=n.nodeLookup.get(r.source),s=n.nodeLookup.get(r.target);i&&s&&af({sourceNode:i,targetNode:s,width:n.width,height:n.height,transform:n.transform})&&o.push(r.id)}return o},[e]),ae)}const ag=({color:e="none",strokeWidth:t=1})=>{const n={strokeWidth:t,...e&&{stroke:e}};return g.jsx("polyline",{className:"arrow",style:n,strokeLinecap:"round",fill:"none",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4"})},cg=({color:e="none",strokeWidth:t=1})=>{const n={strokeWidth:t,...e&&{stroke:e,fill:e}};return g.jsx("polyline",{className:"arrowclosed",style:n,strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"})},wr={[Qt.Arrow]:ag,[Qt.ArrowClosed]:cg};function lg(e){const t=ce();return M.useMemo(()=>Object.prototype.hasOwnProperty.call(wr,e)?wr[e]:(t.getState().onError?.("009",Ee.error009(e)),null),[e])}const ug=({id:e,type:t,color:n,width:o=12.5,height:r=12.5,markerUnits:i="strokeWidth",strokeWidth:s,orient:a="auto-start-reverse"})=>{const c=lg(t);return c?g.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${o}`,markerHeight:`${r}`,viewBox:"-10 -10 20 20",markerUnits:i,orient:a,refX:"0",refY:"0",children:g.jsx(c,{color:n,strokeWidth:s})}):null},is=({defaultColor:e,rfId:t})=>{const n=ie(i=>i.edges),o=ie(i=>i.defaultEdgeOptions),r=M.useMemo(()=>gf(n,{id:t,defaultColor:e,defaultMarkerStart:o?.markerStart,defaultMarkerEnd:o?.markerEnd}),[n,o,t,e]);return r.length?g.jsx("svg",{className:"react-flow__marker","aria-hidden":"true",children:g.jsx("defs",{children:r.map(i=>g.jsx(ug,{id:i.id,type:i.type,color:i.color,width:i.width,height:i.height,markerUnits:i.markerUnits,strokeWidth:i.strokeWidth,orient:i.orient},i.id))})}):null};is.displayName="MarkerDefinitions";var dg=M.memo(is);function ss({x:e,y:t,label:n,labelStyle:o,labelShowBg:r=!0,labelBgStyle:i,labelBgPadding:s=[2,4],labelBgBorderRadius:a=2,children:c,className:l,...u}){const[f,d]=M.useState({x:1,y:0,width:0,height:0}),p=ue(["react-flow__edge-textwrapper",l]),m=M.useRef(null);return M.useEffect(()=>{if(m.current){const w=m.current.getBBox();d({x:w.x,y:w.y,width:w.width,height:w.height})}},[n]),n?g.jsxs("g",{transform:`translate(${e-f.width/2} ${t-f.height/2})`,className:p,visibility:f.width?"visible":"hidden",...u,children:[r&&g.jsx("rect",{width:f.width+2*s[0],x:-s[0],y:-s[1],height:f.height+2*s[1],className:"react-flow__edge-textbg",style:i,rx:a,ry:a}),g.jsx("text",{className:"react-flow__edge-text",y:f.height/2,dy:"0.3em",ref:m,style:o,children:n}),c]}):null}ss.displayName="EdgeText";const fg=M.memo(ss);function gn({path:e,labelX:t,labelY:n,label:o,labelStyle:r,labelShowBg:i,labelBgStyle:s,labelBgPadding:a,labelBgBorderRadius:c,interactionWidth:l=20,...u}){return g.jsxs(g.Fragment,{children:[g.jsx("path",{...u,d:e,fill:"none",className:ue(["react-flow__edge-path",u.className])}),l?g.jsx("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:l,className:"react-flow__edge-interaction"}):null,o&&ye(t)&&ye(n)?g.jsx(fg,{x:t,y:n,label:o,labelStyle:r,labelShowBg:i,labelBgStyle:s,labelBgPadding:a,labelBgBorderRadius:c}):null]})}function vr({pos:e,x1:t,y1:n,x2:o,y2:r}){return e===Z.Left||e===Z.Right?[.5*(t+o),n]:[t,.5*(n+r)]}function as({sourceX:e,sourceY:t,sourcePosition:n=Z.Bottom,targetX:o,targetY:r,targetPosition:i=Z.Top}){const[s,a]=vr({pos:n,x1:e,y1:t,x2:o,y2:r}),[c,l]=vr({pos:i,x1:o,y1:r,x2:e,y2:t}),[u,f,d,p]=Mi({sourceX:e,sourceY:t,targetX:o,targetY:r,sourceControlX:s,sourceControlY:a,targetControlX:c,targetControlY:l});return[`M${e},${t} C${s},${a} ${c},${l} ${o},${r}`,u,f,d,p]}function cs(e){return M.memo(({id:t,sourceX:n,sourceY:o,targetX:r,targetY:i,sourcePosition:s,targetPosition:a,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:f,labelBgPadding:d,labelBgBorderRadius:p,style:m,markerEnd:w,markerStart:v,interactionWidth:x})=>{const[N,h,y]=as({sourceX:n,sourceY:o,sourcePosition:s,targetX:r,targetY:i,targetPosition:a}),S=e.isInternal?void 0:t;return g.jsx(gn,{id:S,path:N,labelX:h,labelY:y,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:f,labelBgPadding:d,labelBgBorderRadius:p,style:m,markerEnd:w,markerStart:v,interactionWidth:x})})}const hg=cs({isInternal:!1}),ls=cs({isInternal:!0});hg.displayName="SimpleBezierEdge";ls.displayName="SimpleBezierEdgeInternal";function us(e){return M.memo(({id:t,sourceX:n,sourceY:o,targetX:r,targetY:i,label:s,labelStyle:a,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:f,style:d,sourcePosition:p=Z.Bottom,targetPosition:m=Z.Top,markerEnd:w,markerStart:v,pathOptions:x,interactionWidth:N})=>{const[h,y,S]=On({sourceX:n,sourceY:o,sourcePosition:p,targetX:r,targetY:i,targetPosition:m,borderRadius:x?.borderRadius,offset:x?.offset,stepPosition:x?.stepPosition}),E=e.isInternal?void 0:t;return g.jsx(gn,{id:E,path:h,labelX:y,labelY:S,label:s,labelStyle:a,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:f,style:d,markerEnd:w,markerStart:v,interactionWidth:N})})}const ds=us({isInternal:!1}),fs=us({isInternal:!0});ds.displayName="SmoothStepEdge";fs.displayName="SmoothStepEdgeInternal";function hs(e){return M.memo(({id:t,...n})=>{const o=e.isInternal?void 0:t;return g.jsx(ds,{...n,id:o,pathOptions:M.useMemo(()=>({borderRadius:0,offset:n.pathOptions?.offset}),[n.pathOptions?.offset])})})}const gg=hs({isInternal:!1}),gs=hs({isInternal:!0});gg.displayName="StepEdge";gs.displayName="StepEdgeInternal";function ps(e){return M.memo(({id:t,sourceX:n,sourceY:o,targetX:r,targetY:i,label:s,labelStyle:a,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:f,style:d,markerEnd:p,markerStart:m,interactionWidth:w})=>{const[v,x,N]=Ti({sourceX:n,sourceY:o,targetX:r,targetY:i}),h=e.isInternal?void 0:t;return g.jsx(gn,{id:h,path:v,labelX:x,labelY:N,label:s,labelStyle:a,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:f,style:d,markerEnd:p,markerStart:m,interactionWidth:w})})}const pg=ps({isInternal:!1}),ms=ps({isInternal:!0});pg.displayName="StraightEdge";ms.displayName="StraightEdgeInternal";function xs(e){return M.memo(({id:t,sourceX:n,sourceY:o,targetX:r,targetY:i,sourcePosition:s=Z.Bottom,targetPosition:a=Z.Top,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:f,labelBgPadding:d,labelBgBorderRadius:p,style:m,markerEnd:w,markerStart:v,pathOptions:x,interactionWidth:N})=>{const[h,y,S]=Ii({sourceX:n,sourceY:o,sourcePosition:s,targetX:r,targetY:i,targetPosition:a,curvature:x?.curvature}),E=e.isInternal?void 0:t;return g.jsx(gn,{id:E,path:h,labelX:y,labelY:S,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:f,labelBgPadding:d,labelBgBorderRadius:p,style:m,markerEnd:w,markerStart:v,interactionWidth:N})})}const mg=xs({isInternal:!1}),ys=xs({isInternal:!0});mg.displayName="BezierEdge";ys.displayName="BezierEdgeInternal";const br={default:ys,straight:ms,step:gs,smoothstep:fs,simplebezier:ls},Nr={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},xg=(e,t,n)=>n===Z.Left?e-t:n===Z.Right?e+t:e,yg=(e,t,n)=>n===Z.Top?e-t:n===Z.Bottom?e+t:e,Er="react-flow__edgeupdater";function _r({position:e,centerX:t,centerY:n,radius:o=10,onMouseDown:r,onMouseEnter:i,onMouseOut:s,type:a}){return g.jsx("circle",{onMouseDown:r,onMouseEnter:i,onMouseOut:s,className:ue([Er,`${Er}-${a}`]),cx:xg(t,o,e),cy:yg(n,o,e),r:o,stroke:"transparent",fill:"transparent"})}function wg({isReconnectable:e,reconnectRadius:t,edge:n,sourceX:o,sourceY:r,targetX:i,targetY:s,sourcePosition:a,targetPosition:c,onReconnect:l,onReconnectStart:u,onReconnectEnd:f,setReconnecting:d,setUpdateHover:p}){const m=ce(),w=(y,S)=>{if(y.button!==0)return;const{autoPanOnConnect:E,domNode:_,isValidConnection:$,connectionMode:D,connectionRadius:F,lib:A,onConnectStart:z,onConnectEnd:H,cancelConnection:b,nodeLookup:k,rfId:C,panBy:P,updateConnection:I}=m.getState(),T=S.type==="target",j=(W,Y)=>{d(!1),f?.(W,n,S.type,Y)},V=W=>l?.(n,W),O=(W,Y)=>{d(!0),u?.(y,n,S.type),z?.(W,Y)};Fn.onPointerDown(y.nativeEvent,{autoPanOnConnect:E,connectionMode:D,connectionRadius:F,domNode:_,handleId:S.id,nodeId:S.nodeId,nodeLookup:k,isTarget:T,edgeUpdaterType:S.type,lib:A,flowId:C,cancelConnection:b,panBy:P,isValidConnection:$,onConnect:V,onConnectStart:O,onConnectEnd:H,onReconnectEnd:j,updateConnection:I,getTransform:()=>m.getState().transform,getFromHandle:()=>m.getState().connection.fromHandle,dragThreshold:m.getState().connectionDragThreshold,handleDomNode:y.currentTarget})},v=y=>w(y,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),x=y=>w(y,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),N=()=>p(!0),h=()=>p(!1);return g.jsxs(g.Fragment,{children:[(e===!0||e==="source")&&g.jsx(_r,{position:a,centerX:o,centerY:r,radius:t,onMouseDown:v,onMouseEnter:N,onMouseOut:h,type:"source"}),(e===!0||e==="target")&&g.jsx(_r,{position:c,centerX:i,centerY:s,radius:t,onMouseDown:x,onMouseEnter:N,onMouseOut:h,type:"target"})]})}function vg({id:e,edgesFocusable:t,edgesReconnectable:n,elementsSelectable:o,onClick:r,onDoubleClick:i,onContextMenu:s,onMouseEnter:a,onMouseMove:c,onMouseLeave:l,reconnectRadius:u,onReconnect:f,onReconnectStart:d,onReconnectEnd:p,rfId:m,edgeTypes:w,noPanClassName:v,onError:x,disableKeyboardA11y:N}){let h=ie(J=>J.edgeLookup.get(e));const y=ie(J=>J.defaultEdgeOptions);h=y?{...y,...h}:h;let S=h.type||"default",E=w?.[S]||br[S];E===void 0&&(x?.("011",Ee.error011(S)),S="default",E=w?.default||br.default);const _=!!(h.focusable||t&&typeof h.focusable>"u"),$=typeof f<"u"&&(h.reconnectable||n&&typeof h.reconnectable>"u"),D=!!(h.selectable||o&&typeof h.selectable>"u"),F=M.useRef(null),[A,z]=M.useState(!1),[H,b]=M.useState(!1),k=ce(),{zIndex:C,sourceX:P,sourceY:I,targetX:T,targetY:j,sourcePosition:V,targetPosition:O}=ie(M.useCallback(J=>{const te=J.nodeLookup.get(h.source),L=J.nodeLookup.get(h.target);if(!te||!L)return{zIndex:h.zIndex,...Nr};const R=hf({id:e,sourceNode:te,targetNode:L,sourceHandle:h.sourceHandle||null,targetHandle:h.targetHandle||null,connectionMode:J.connectionMode,onError:x});return{zIndex:sf({selected:h.selected,zIndex:h.zIndex,sourceNode:te,targetNode:L,elevateOnSelect:J.elevateEdgesOnSelect,zIndexMode:J.zIndexMode}),...R||Nr}},[h.source,h.target,h.sourceHandle,h.targetHandle,h.selected,h.zIndex]),ae),W=M.useMemo(()=>h.markerStart?`url('#${Vn(h.markerStart,m)}')`:void 0,[h.markerStart,m]),Y=M.useMemo(()=>h.markerEnd?`url('#${Vn(h.markerEnd,m)}')`:void 0,[h.markerEnd,m]);if(h.hidden||P===null||I===null||T===null||j===null)return null;const Q=J=>{const{addSelectedEdges:te,unselectNodesAndEdges:L,multiSelectionActive:R}=k.getState();D&&(k.setState({nodesSelectionActive:!1}),h.selected&&R?(L({nodes:[],edges:[h]}),F.current?.blur()):te([e])),r&&r(J,h)},ne=i?J=>{i(J,{...h})}:void 0,K=s?J=>{s(J,{...h})}:void 0,X=a?J=>{a(J,{...h})}:void 0,U=c?J=>{c(J,{...h})}:void 0,re=l?J=>{l(J,{...h})}:void 0,oe=J=>{if(!N&&gi.includes(J.key)&&D){const{unselectNodesAndEdges:te,addSelectedEdges:L}=k.getState();J.key==="Escape"?(F.current?.blur(),te({edges:[h]})):L([e])}};return g.jsx("svg",{style:{zIndex:C},children:g.jsxs("g",{className:ue(["react-flow__edge",`react-flow__edge-${S}`,h.className,v,{selected:h.selected,animated:h.animated,inactive:!D&&!r,updating:A,selectable:D}]),onClick:Q,onDoubleClick:ne,onContextMenu:K,onMouseEnter:X,onMouseMove:U,onMouseLeave:re,onKeyDown:_?oe:void 0,tabIndex:_?0:void 0,role:h.ariaRole??(_?"group":"img"),"aria-roledescription":"edge","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":h.ariaLabel===null?void 0:h.ariaLabel||`Edge from ${h.source} to ${h.target}`,"aria-describedby":_?`${qi}-${m}`:void 0,ref:F,...h.domAttributes,children:[!H&&g.jsx(E,{id:e,source:h.source,target:h.target,type:h.type,selected:h.selected,animated:h.animated,selectable:D,deletable:h.deletable??!0,label:h.label,labelStyle:h.labelStyle,labelShowBg:h.labelShowBg,labelBgStyle:h.labelBgStyle,labelBgPadding:h.labelBgPadding,labelBgBorderRadius:h.labelBgBorderRadius,sourceX:P,sourceY:I,targetX:T,targetY:j,sourcePosition:V,targetPosition:O,data:h.data,style:h.style,sourceHandleId:h.sourceHandle,targetHandleId:h.targetHandle,markerStart:W,markerEnd:Y,pathOptions:"pathOptions"in h?h.pathOptions:void 0,interactionWidth:h.interactionWidth}),$&&g.jsx(wg,{edge:h,isReconnectable:$,reconnectRadius:u,onReconnect:f,onReconnectStart:d,onReconnectEnd:p,sourceX:P,sourceY:I,targetX:T,targetY:j,sourcePosition:V,targetPosition:O,setUpdateHover:z,setReconnecting:b})]})})}var bg=M.memo(vg);const Ng=e=>({edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function ws({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:n,edgeTypes:o,noPanClassName:r,onReconnect:i,onEdgeContextMenu:s,onEdgeMouseEnter:a,onEdgeMouseMove:c,onEdgeMouseLeave:l,onEdgeClick:u,reconnectRadius:f,onEdgeDoubleClick:d,onReconnectStart:p,onReconnectEnd:m,disableKeyboardA11y:w}){const{edgesFocusable:v,edgesReconnectable:x,elementsSelectable:N,onError:h}=ie(Ng,ae),y=sg(t);return g.jsxs("div",{className:"react-flow__edges",children:[g.jsx(dg,{defaultColor:e,rfId:n}),y.map(S=>g.jsx(bg,{id:S,edgesFocusable:v,edgesReconnectable:x,elementsSelectable:N,noPanClassName:r,onReconnect:i,onContextMenu:s,onMouseEnter:a,onMouseMove:c,onMouseLeave:l,onClick:u,reconnectRadius:f,onDoubleClick:d,onReconnectStart:p,onReconnectEnd:m,rfId:n,onError:h,edgeTypes:o,disableKeyboardA11y:w},S))]})}ws.displayName="EdgeRenderer";const Eg=M.memo(ws),_g=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function Cg({children:e}){const t=ie(_g);return g.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function Sg(e){const t=ao(),n=M.useRef(!1);M.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const kg=e=>e.panZoom?.syncViewport;function Mg(e){const t=ie(kg),n=ce();return M.useEffect(()=>{e&&(t?.(e),n.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function Ig(e){return e.connection.inProgress?{...e.connection,to:kt(e.connection.to,e.transform)}:{...e.connection}}function Ag(e){return Ig}function Pg(e){const t=Ag();return ie(t,ae)}const $g=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function Tg({containerStyle:e,style:t,type:n,component:o}){const{nodesConnectable:r,width:i,height:s,isValid:a,inProgress:c}=ie($g,ae);return!(i&&r&&c)?null:g.jsx("svg",{style:e,width:i,height:s,className:"react-flow__connectionline react-flow__container",children:g.jsx("g",{className:ue(["react-flow__connection",xi(a)]),children:g.jsx(vs,{style:t,type:n,CustomComponent:o,isValid:a})})})}const vs=({style:e,type:t=Te.Bezier,CustomComponent:n,isValid:o})=>{const{inProgress:r,from:i,fromNode:s,fromHandle:a,fromPosition:c,to:l,toNode:u,toHandle:f,toPosition:d,pointer:p}=Pg();if(!r)return;if(n)return g.jsx(n,{connectionLineType:t,connectionLineStyle:e,fromNode:s,fromHandle:a,fromX:i.x,fromY:i.y,toX:l.x,toY:l.y,fromPosition:c,toPosition:d,connectionStatus:xi(o),toNode:u,toHandle:f,pointer:p});let m="";const w={sourceX:i.x,sourceY:i.y,sourcePosition:c,targetX:l.x,targetY:l.y,targetPosition:d};switch(t){case Te.Bezier:[m]=Ii(w);break;case Te.SimpleBezier:[m]=as(w);break;case Te.Step:[m]=On({...w,borderRadius:0});break;case Te.SmoothStep:[m]=On(w);break;default:[m]=Ti(w)}return g.jsx("path",{d:m,fill:"none",className:"react-flow__connection-path",style:e})};vs.displayName="ConnectionLine";const Dg={};function Cr(e=Dg){M.useRef(e),ce(),M.useEffect(()=>{},[e])}function zg(){ce(),M.useRef(!1),M.useEffect(()=>{},[])}function bs({nodeTypes:e,edgeTypes:t,onInit:n,onNodeClick:o,onEdgeClick:r,onNodeDoubleClick:i,onEdgeDoubleClick:s,onNodeMouseEnter:a,onNodeMouseMove:c,onNodeMouseLeave:l,onNodeContextMenu:u,onSelectionContextMenu:f,onSelectionStart:d,onSelectionEnd:p,connectionLineType:m,connectionLineStyle:w,connectionLineComponent:v,connectionLineContainerStyle:x,selectionKeyCode:N,selectionOnDrag:h,selectionMode:y,multiSelectionKeyCode:S,panActivationKeyCode:E,zoomActivationKeyCode:_,deleteKeyCode:$,onlyRenderVisibleElements:D,elementsSelectable:F,defaultViewport:A,translateExtent:z,minZoom:H,maxZoom:b,preventScrolling:k,defaultMarkerColor:C,zoomOnScroll:P,zoomOnPinch:I,panOnScroll:T,panOnScrollSpeed:j,panOnScrollMode:V,zoomOnDoubleClick:O,panOnDrag:W,onPaneClick:Y,onPaneMouseEnter:Q,onPaneMouseMove:ne,onPaneMouseLeave:K,onPaneScroll:X,onPaneContextMenu:U,paneClickDistance:re,nodeClickDistance:oe,onEdgeContextMenu:J,onEdgeMouseEnter:te,onEdgeMouseMove:L,onEdgeMouseLeave:R,reconnectRadius:B,onReconnect:q,onReconnectStart:G,onReconnectEnd:ee,noDragClassName:se,noWheelClassName:de,noPanClassName:De,disableKeyboardA11y:rt,nodeExtent:pn,rfId:It,viewport:Ye,onViewportChange:it}){return Cr(e),Cr(t),zg(),Sg(n),Mg(Ye),g.jsx(Uh,{onPaneClick:Y,onPaneMouseEnter:Q,onPaneMouseMove:ne,onPaneMouseLeave:K,onPaneContextMenu:U,onPaneScroll:X,paneClickDistance:re,deleteKeyCode:$,selectionKeyCode:N,selectionOnDrag:h,selectionMode:y,onSelectionStart:d,onSelectionEnd:p,multiSelectionKeyCode:S,panActivationKeyCode:E,zoomActivationKeyCode:_,elementsSelectable:F,zoomOnScroll:P,zoomOnPinch:I,zoomOnDoubleClick:O,panOnScroll:T,panOnScrollSpeed:j,panOnScrollMode:V,panOnDrag:W,defaultViewport:A,translateExtent:z,minZoom:H,maxZoom:b,onSelectionContextMenu:f,preventScrolling:k,noDragClassName:se,noWheelClassName:de,noPanClassName:De,disableKeyboardA11y:rt,onViewportChange:it,isControlledViewport:!!Ye,children:g.jsxs(Cg,{children:[g.jsx(Eg,{edgeTypes:t,onEdgeClick:r,onEdgeDoubleClick:s,onReconnect:q,onReconnectStart:G,onReconnectEnd:ee,onlyRenderVisibleElements:D,onEdgeContextMenu:J,onEdgeMouseEnter:te,onEdgeMouseMove:L,onEdgeMouseLeave:R,reconnectRadius:B,defaultMarkerColor:C,noPanClassName:De,disableKeyboardA11y:rt,rfId:It}),g.jsx(Tg,{style:w,type:m,component:v,containerStyle:x}),g.jsx("div",{className:"react-flow__edgelabel-renderer"}),g.jsx(ig,{nodeTypes:e,onNodeClick:o,onNodeDoubleClick:i,onNodeMouseEnter:a,onNodeMouseMove:c,onNodeMouseLeave:l,onNodeContextMenu:u,nodeClickDistance:oe,onlyRenderVisibleElements:D,noPanClassName:De,noDragClassName:se,disableKeyboardA11y:rt,nodeExtent:pn,rfId:It}),g.jsx("div",{className:"react-flow__viewport-portal"})]})})}bs.displayName="GraphView";const jg=M.memo(bs),Sr=({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:r,height:i,fitView:s,fitViewOptions:a,minZoom:c=.5,maxZoom:l=2,nodeOrigin:u,nodeExtent:f,zIndexMode:d="basic"}={})=>{const p=new Map,m=new Map,w=new Map,v=new Map,x=o??t??[],N=n??e??[],h=u??[0,0],y=f??mt;ji(w,v,x);const S=Bn(N,p,m,{nodeOrigin:h,nodeExtent:y,zIndexMode:d});let E=[0,0,1];if(s&&r&&i){const _=Ct(p,{filter:A=>!!((A.width||A.initialWidth)&&(A.height||A.initialHeight))}),{x:$,y:D,zoom:F}=eo(_,r,i,c,l,a?.padding??.1);E=[$,D,F]}return{rfId:"1",width:r??0,height:i??0,transform:E,nodes:N,nodesInitialized:S,nodeLookup:p,parentLookup:m,edges:x,edgeLookup:v,connectionLookup:w,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:n!==void 0,hasDefaultEdges:o!==void 0,panZoom:null,minZoom:c,maxZoom:l,translateExtent:mt,nodeExtent:y,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:Je.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:h,nodeDragThreshold:1,connectionDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!0,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:s??!1,fitViewOptions:a,fitViewResolver:null,connection:{...mi},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanOnNodeFocus:!0,autoPanSpeed:15,connectionRadius:20,onError:Jd,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1,ariaLabelConfig:pi,zIndexMode:d,onNodesChangeMiddlewareMap:new Map,onEdgesChangeMiddlewareMap:new Map}},Hg=({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:r,height:i,fitView:s,fitViewOptions:a,minZoom:c,maxZoom:l,nodeOrigin:u,nodeExtent:f,zIndexMode:d})=>th((p,m)=>{async function w(){const{nodeLookup:v,panZoom:x,fitViewOptions:N,fitViewResolver:h,width:y,height:S,minZoom:E,maxZoom:_}=m();x&&(await Kd({nodes:v,width:y,height:S,panZoom:x,minZoom:E,maxZoom:_},N),h?.resolve(!0),p({fitViewResolver:null}))}return{...Sr({nodes:e,edges:t,width:r,height:i,fitView:s,fitViewOptions:a,minZoom:c,maxZoom:l,nodeOrigin:u,nodeExtent:f,defaultNodes:n,defaultEdges:o,zIndexMode:d}),setNodes:v=>{const{nodeLookup:x,parentLookup:N,nodeOrigin:h,elevateNodesOnSelect:y,fitViewQueued:S,zIndexMode:E}=m(),_=Bn(v,x,N,{nodeOrigin:h,nodeExtent:f,elevateNodesOnSelect:y,checkEquality:!0,zIndexMode:E});S&&_?(w(),p({nodes:v,nodesInitialized:_,fitViewQueued:!1,fitViewOptions:void 0})):p({nodes:v,nodesInitialized:_})},setEdges:v=>{const{connectionLookup:x,edgeLookup:N}=m();ji(x,N,v),p({edges:v})},setDefaultNodesAndEdges:(v,x)=>{if(v){const{setNodes:N}=m();N(v),p({hasDefaultNodes:!0})}if(x){const{setEdges:N}=m();N(x),p({hasDefaultEdges:!0})}},updateNodeInternals:v=>{const{triggerNodeChanges:x,nodeLookup:N,parentLookup:h,domNode:y,nodeOrigin:S,nodeExtent:E,debug:_,fitViewQueued:$,zIndexMode:D}=m(),{changes:F,updatedInternals:A}=bf(v,N,h,y,S,E,D);A&&(xf(N,h,{nodeOrigin:S,nodeExtent:E,zIndexMode:D}),$?(w(),p({fitViewQueued:!1,fitViewOptions:void 0})):p({}),F?.length>0&&(_&&console.log("React Flow: trigger node changes",F),x?.(F)))},updateNodePositions:(v,x=!1)=>{const N=[];let h=[];const{nodeLookup:y,triggerNodeChanges:S,connection:E,updateConnection:_,onNodesChangeMiddlewareMap:$}=m();for(const[D,F]of v){const A=y.get(D),z=!!(A?.expandParent&&A?.parentId&&F?.position),H={id:D,type:"position",position:z?{x:Math.max(0,F.position.x),y:Math.max(0,F.position.y)}:F.position,dragging:x};if(A&&E.inProgress&&E.fromNode.id===A.id){const b=Xe(A,E.fromHandle,Z.Left,!0);_({...E,from:b})}z&&A.parentId&&N.push({id:D,parentId:A.parentId,rect:{...F.internals.positionAbsolute,width:F.measured.width??0,height:F.measured.height??0}}),h.push(H)}if(N.length>0){const{parentLookup:D,nodeOrigin:F}=m(),A=so(N,y,D,F);h.push(...A)}for(const D of $.values())h=D(h);S(h)},triggerNodeChanges:v=>{const{onNodesChange:x,setNodes:N,nodes:h,hasDefaultNodes:y,debug:S}=m();if(v?.length){if(y){const E=Ki(v,h);N(E)}S&&console.log("React Flow: trigger node changes",v),x?.(v)}},triggerEdgeChanges:v=>{const{onEdgesChange:x,setEdges:N,edges:h,hasDefaultEdges:y,debug:S}=m();if(v?.length){if(y){const E=Qi(v,h);N(E)}S&&console.log("React Flow: trigger edge changes",v),x?.(v)}},addSelectedNodes:v=>{const{multiSelectionActive:x,edgeLookup:N,nodeLookup:h,triggerNodeChanges:y,triggerEdgeChanges:S}=m();if(x){const E=v.map(_=>je(_,!0));y(E);return}y(qe(h,new Set([...v]),!0)),S(qe(N))},addSelectedEdges:v=>{const{multiSelectionActive:x,edgeLookup:N,nodeLookup:h,triggerNodeChanges:y,triggerEdgeChanges:S}=m();if(x){const E=v.map(_=>je(_,!0));S(E);return}S(qe(N,new Set([...v]))),y(qe(h,new Set,!0))},unselectNodesAndEdges:({nodes:v,edges:x}={})=>{const{edges:N,nodes:h,nodeLookup:y,triggerNodeChanges:S,triggerEdgeChanges:E}=m(),_=v||h,$=x||N,D=_.map(A=>{const z=y.get(A.id);return z&&(z.selected=!1),je(A.id,!1)}),F=$.map(A=>je(A.id,!1));S(D),E(F)},setMinZoom:v=>{const{panZoom:x,maxZoom:N}=m();x?.setScaleExtent([v,N]),p({minZoom:v})},setMaxZoom:v=>{const{panZoom:x,minZoom:N}=m();x?.setScaleExtent([N,v]),p({maxZoom:v})},setTranslateExtent:v=>{m().panZoom?.setTranslateExtent(v),p({translateExtent:v})},resetSelectedElements:()=>{const{edges:v,nodes:x,triggerNodeChanges:N,triggerEdgeChanges:h,elementsSelectable:y}=m();if(!y)return;const S=x.reduce((_,$)=>$.selected?[..._,je($.id,!1)]:_,[]),E=v.reduce((_,$)=>$.selected?[..._,je($.id,!1)]:_,[]);N(S),h(E)},setNodeExtent:v=>{const{nodes:x,nodeLookup:N,parentLookup:h,nodeOrigin:y,elevateNodesOnSelect:S,nodeExtent:E,zIndexMode:_}=m();v[0][0]===E[0][0]&&v[0][1]===E[0][1]&&v[1][0]===E[1][0]&&v[1][1]===E[1][1]||(Bn(x,N,h,{nodeOrigin:y,nodeExtent:v,elevateNodesOnSelect:S,checkEquality:!1,zIndexMode:_}),p({nodeExtent:v}))},panBy:v=>{const{transform:x,width:N,height:h,panZoom:y,translateExtent:S}=m();return Nf({delta:v,panZoom:y,transform:x,translateExtent:S,width:N,height:h})},setCenter:async(v,x,N)=>{const{width:h,height:y,maxZoom:S,panZoom:E}=m();if(!E)return Promise.resolve(!1);const _=typeof N?.zoom<"u"?N.zoom:S;return await E.setViewport({x:h/2-v*_,y:y/2-x*_,zoom:_},{duration:N?.duration,ease:N?.ease,interpolate:N?.interpolate}),Promise.resolve(!0)},cancelConnection:()=>{p({connection:{...mi}})},updateConnection:v=>{p({connection:v})},reset:()=>p({...Sr()})}},Object.is);function Ns({initialNodes:e,initialEdges:t,defaultNodes:n,defaultEdges:o,initialWidth:r,initialHeight:i,initialMinZoom:s,initialMaxZoom:a,initialFitViewOptions:c,fitView:l,nodeOrigin:u,nodeExtent:f,zIndexMode:d,children:p}){const[m]=M.useState(()=>Hg({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:r,height:i,fitView:l,minZoom:s,maxZoom:a,fitViewOptions:c,nodeOrigin:u,nodeExtent:f,zIndexMode:d}));return g.jsx(nh,{value:m,children:g.jsx(Ch,{children:p})})}function Rg({children:e,nodes:t,edges:n,defaultNodes:o,defaultEdges:r,width:i,height:s,fitView:a,fitViewOptions:c,minZoom:l,maxZoom:u,nodeOrigin:f,nodeExtent:d,zIndexMode:p}){return M.useContext(fn)?g.jsx(g.Fragment,{children:e}):g.jsx(Ns,{initialNodes:t,initialEdges:n,defaultNodes:o,defaultEdges:r,initialWidth:i,initialHeight:s,fitView:a,initialFitViewOptions:c,initialMinZoom:l,initialMaxZoom:u,nodeOrigin:f,nodeExtent:d,zIndexMode:p,children:e})}const Lg={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function Og({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,className:r,nodeTypes:i,edgeTypes:s,onNodeClick:a,onEdgeClick:c,onInit:l,onMove:u,onMoveStart:f,onMoveEnd:d,onConnect:p,onConnectStart:m,onConnectEnd:w,onClickConnectStart:v,onClickConnectEnd:x,onNodeMouseEnter:N,onNodeMouseMove:h,onNodeMouseLeave:y,onNodeContextMenu:S,onNodeDoubleClick:E,onNodeDragStart:_,onNodeDrag:$,onNodeDragStop:D,onNodesDelete:F,onEdgesDelete:A,onDelete:z,onSelectionChange:H,onSelectionDragStart:b,onSelectionDrag:k,onSelectionDragStop:C,onSelectionContextMenu:P,onSelectionStart:I,onSelectionEnd:T,onBeforeDelete:j,connectionMode:V,connectionLineType:O=Te.Bezier,connectionLineStyle:W,connectionLineComponent:Y,connectionLineContainerStyle:Q,deleteKeyCode:ne="Backspace",selectionKeyCode:K="Shift",selectionOnDrag:X=!1,selectionMode:U=xt.Full,panActivationKeyCode:re="Space",multiSelectionKeyCode:oe=wt()?"Meta":"Control",zoomActivationKeyCode:J=wt()?"Meta":"Control",snapToGrid:te,snapGrid:L,onlyRenderVisibleElements:R=!1,selectNodesOnDrag:B,nodesDraggable:q,autoPanOnNodeFocus:G,nodesConnectable:ee,nodesFocusable:se,nodeOrigin:de=Gi,edgesFocusable:De,edgesReconnectable:rt,elementsSelectable:pn=!0,defaultViewport:It=ph,minZoom:Ye=.5,maxZoom:it=2,translateExtent:uo=mt,preventScrolling:Ss=!0,nodeExtent:mn,defaultMarkerColor:ks="#b1b1b7",zoomOnScroll:Ms=!0,zoomOnPinch:Is=!0,panOnScroll:As=!1,panOnScrollSpeed:Ps=.5,panOnScrollMode:$s=Oe.Free,zoomOnDoubleClick:Ts=!0,panOnDrag:Ds=!0,onPaneClick:zs,onPaneMouseEnter:js,onPaneMouseMove:Hs,onPaneMouseLeave:Rs,onPaneScroll:Ls,onPaneContextMenu:Os,paneClickDistance:Vs=1,nodeClickDistance:Bs=0,children:Fs,onReconnect:Xs,onReconnectStart:Ys,onReconnectEnd:Ws,onEdgeContextMenu:Zs,onEdgeDoubleClick:qs,onEdgeMouseEnter:Gs,onEdgeMouseMove:Us,onEdgeMouseLeave:Ks,reconnectRadius:Qs=10,onNodesChange:Js,onEdgesChange:ea,noDragClassName:ta="nodrag",noWheelClassName:na="nowheel",noPanClassName:fo="nopan",fitView:ho,fitViewOptions:go,connectOnClick:oa,attributionPosition:ra,proOptions:ia,defaultEdgeOptions:sa,elevateNodesOnSelect:aa=!0,elevateEdgesOnSelect:ca=!1,disableKeyboardA11y:po=!1,autoPanOnConnect:la,autoPanOnNodeDrag:ua,autoPanSpeed:da,connectionRadius:fa,isValidConnection:ha,onError:ga,style:pa,id:mo,nodeDragThreshold:ma,connectionDragThreshold:xa,viewport:ya,onViewportChange:wa,width:va,height:ba,colorMode:Na="light",debug:Ea,onScroll:xo,ariaLabelConfig:_a,zIndexMode:yo="basic",...Ca},Sa){const xn=mo||"1",ka=wh(Na),Ma=M.useCallback(wo=>{wo.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),xo?.(wo)},[xo]);return g.jsx("div",{"data-testid":"rf__wrapper",...Ca,onScroll:Ma,style:{...pa,...Lg},ref:Sa,className:ue(["react-flow",r,ka]),id:mo,role:"application",children:g.jsxs(Rg,{nodes:e,edges:t,width:va,height:ba,fitView:ho,fitViewOptions:go,minZoom:Ye,maxZoom:it,nodeOrigin:de,nodeExtent:mn,zIndexMode:yo,children:[g.jsx(jg,{onInit:l,onNodeClick:a,onEdgeClick:c,onNodeMouseEnter:N,onNodeMouseMove:h,onNodeMouseLeave:y,onNodeContextMenu:S,onNodeDoubleClick:E,nodeTypes:i,edgeTypes:s,connectionLineType:O,connectionLineStyle:W,connectionLineComponent:Y,connectionLineContainerStyle:Q,selectionKeyCode:K,selectionOnDrag:X,selectionMode:U,deleteKeyCode:ne,multiSelectionKeyCode:oe,panActivationKeyCode:re,zoomActivationKeyCode:J,onlyRenderVisibleElements:R,defaultViewport:It,translateExtent:uo,minZoom:Ye,maxZoom:it,preventScrolling:Ss,zoomOnScroll:Ms,zoomOnPinch:Is,zoomOnDoubleClick:Ts,panOnScroll:As,panOnScrollSpeed:Ps,panOnScrollMode:$s,panOnDrag:Ds,onPaneClick:zs,onPaneMouseEnter:js,onPaneMouseMove:Hs,onPaneMouseLeave:Rs,onPaneScroll:Ls,onPaneContextMenu:Os,paneClickDistance:Vs,nodeClickDistance:Bs,onSelectionContextMenu:P,onSelectionStart:I,onSelectionEnd:T,onReconnect:Xs,onReconnectStart:Ys,onReconnectEnd:Ws,onEdgeContextMenu:Zs,onEdgeDoubleClick:qs,onEdgeMouseEnter:Gs,onEdgeMouseMove:Us,onEdgeMouseLeave:Ks,reconnectRadius:Qs,defaultMarkerColor:ks,noDragClassName:ta,noWheelClassName:na,noPanClassName:fo,rfId:xn,disableKeyboardA11y:po,nodeExtent:mn,viewport:ya,onViewportChange:wa}),g.jsx(yh,{nodes:e,edges:t,defaultNodes:n,defaultEdges:o,onConnect:p,onConnectStart:m,onConnectEnd:w,onClickConnectStart:v,onClickConnectEnd:x,nodesDraggable:q,autoPanOnNodeFocus:G,nodesConnectable:ee,nodesFocusable:se,edgesFocusable:De,edgesReconnectable:rt,elementsSelectable:pn,elevateNodesOnSelect:aa,elevateEdgesOnSelect:ca,minZoom:Ye,maxZoom:it,nodeExtent:mn,onNodesChange:Js,onEdgesChange:ea,snapToGrid:te,snapGrid:L,connectionMode:V,translateExtent:uo,connectOnClick:oa,defaultEdgeOptions:sa,fitView:ho,fitViewOptions:go,onNodesDelete:F,onEdgesDelete:A,onDelete:z,onNodeDragStart:_,onNodeDrag:$,onNodeDragStop:D,onSelectionDrag:k,onSelectionDragStart:b,onSelectionDragStop:C,onMove:u,onMoveStart:f,onMoveEnd:d,noPanClassName:fo,nodeOrigin:de,rfId:xn,autoPanOnConnect:la,autoPanOnNodeDrag:ua,autoPanSpeed:da,onError:ga,connectionRadius:fa,isValidConnection:ha,selectNodesOnDrag:B,nodeDragThreshold:ma,connectionDragThreshold:xa,onBeforeDelete:j,debug:Ea,ariaLabelConfig:_a,zIndexMode:yo}),g.jsx(gh,{onSelectionChange:H}),Fs,g.jsx(lh,{proOptions:ia,position:ra}),g.jsx(ch,{rfId:xn,disableKeyboardA11y:po})]})})}var Vg=Ji(Og);function Bg(e){const[t,n]=M.useState(e),o=M.useCallback(r=>n(i=>Ki(r,i)),[]);return[t,n,o]}function Fg(e){const[t,n]=M.useState(e),o=M.useCallback(r=>n(i=>Qi(r,i)),[]);return[t,n,o]}function kr({type:e,id:t,nodeId:n,onConnect:o,onDisconnect:r}){console.warn("[DEPRECATED] `useHandleConnections` is deprecated. Instead use `useNodeConnections` https://reactflow.dev/api-reference/hooks/useNodeConnections");const i=lo(),s=n??i,a=M.useRef(null),c=ie(l=>l.connectionLookup.get(`${s}-${e}${t?`-${t}`:""}`),Wd);return M.useEffect(()=>{if(a.current&&a.current!==c){const l=c??new Map;Oo(a.current,l,r),Oo(l,a.current,o)}a.current=c??new Map},[c,o,r]),M.useMemo(()=>Array.from(c?.values()??[]),[c])}function Xg({dimensions:e,lineWidth:t,variant:n,className:o}){return g.jsx("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:ue(["react-flow__background-pattern",n,o])})}function Yg({radius:e,className:t}){return g.jsx("circle",{cx:e,cy:e,r:e,className:ue(["react-flow__background-pattern","dots",t])})}var ke;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(ke||(ke={}));const Wg={[ke.Dots]:1,[ke.Lines]:1,[ke.Cross]:6},Zg=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function Es({id:e,variant:t=ke.Dots,gap:n=20,size:o,lineWidth:r=1,offset:i=0,color:s,bgColor:a,style:c,className:l,patternClassName:u}){const f=M.useRef(null),{transform:d,patternId:p}=ie(Zg,ae),m=o||Wg[t],w=t===ke.Dots,v=t===ke.Cross,x=Array.isArray(n)?n:[n,n],N=[x[0]*d[2]||1,x[1]*d[2]||1],h=m*d[2],y=Array.isArray(i)?i:[i,i],S=v?[h,h]:N,E=[y[0]*d[2]||1+S[0]/2,y[1]*d[2]||1+S[1]/2],_=`${p}${e||""}`;return g.jsxs("svg",{className:ue(["react-flow__background",l]),style:{...c,...hn,"--xy-background-color-props":a,"--xy-background-pattern-color-props":s},ref:f,"data-testid":"rf__background",children:[g.jsx("pattern",{id:_,x:d[0]%N[0],y:d[1]%N[1],width:N[0],height:N[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${E[0]},-${E[1]})`,children:w?g.jsx(Yg,{radius:h/2,className:u}):g.jsx(Xg,{dimensions:S,lineWidth:r,variant:t,className:u})}),g.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${_})`})]})}Es.displayName="Background";const qg=M.memo(Es);function Gg(){return g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:g.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function Ug(){return g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:g.jsx("path",{d:"M0 0h32v4.2H0z"})})}function Kg(){return g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:g.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function Qg(){return g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:g.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function Jg(){return g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:g.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function Lt({children:e,className:t,...n}){return g.jsx("button",{type:"button",className:ue(["react-flow__controls-button",t]),...n,children:e})}const ep=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom,ariaLabelConfig:e.ariaLabelConfig});function _s({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:o=!0,fitViewOptions:r,onZoomIn:i,onZoomOut:s,onFitView:a,onInteractiveChange:c,className:l,children:u,position:f="bottom-left",orientation:d="vertical","aria-label":p}){const m=ce(),{isInteractive:w,minZoomReached:v,maxZoomReached:x,ariaLabelConfig:N}=ie(ep,ae),{zoomIn:h,zoomOut:y,fitView:S}=ao(),E=()=>{h(),i?.()},_=()=>{y(),s?.()},$=()=>{S(r),a?.()},D=()=>{m.setState({nodesDraggable:!w,nodesConnectable:!w,elementsSelectable:!w}),c?.(!w)},F=d==="horizontal"?"horizontal":"vertical";return g.jsxs(Mt,{className:ue(["react-flow__controls",F,l]),position:f,style:e,"data-testid":"rf__controls","aria-label":p??N["controls.ariaLabel"],children:[t&&g.jsxs(g.Fragment,{children:[g.jsx(Lt,{onClick:E,className:"react-flow__controls-zoomin",title:N["controls.zoomIn.ariaLabel"],"aria-label":N["controls.zoomIn.ariaLabel"],disabled:x,children:g.jsx(Gg,{})}),g.jsx(Lt,{onClick:_,className:"react-flow__controls-zoomout",title:N["controls.zoomOut.ariaLabel"],"aria-label":N["controls.zoomOut.ariaLabel"],disabled:v,children:g.jsx(Ug,{})})]}),n&&g.jsx(Lt,{className:"react-flow__controls-fitview",onClick:$,title:N["controls.fitView.ariaLabel"],"aria-label":N["controls.fitView.ariaLabel"],children:g.jsx(Kg,{})}),o&&g.jsx(Lt,{className:"react-flow__controls-interactive",onClick:D,title:N["controls.interactive.ariaLabel"],"aria-label":N["controls.interactive.ariaLabel"],children:w?g.jsx(Jg,{}):g.jsx(Qg,{})}),u]})}_s.displayName="Controls";const tp=M.memo(_s);function np({id:e,x:t,y:n,width:o,height:r,style:i,color:s,strokeColor:a,strokeWidth:c,className:l,borderRadius:u,shapeRendering:f,selected:d,onClick:p}){const{background:m,backgroundColor:w}=i||{},v=s||m||w;return g.jsx("rect",{className:ue(["react-flow__minimap-node",{selected:d},l]),x:t,y:n,rx:u,ry:u,width:o,height:r,style:{fill:v,stroke:a,strokeWidth:c},shapeRendering:f,onClick:p?x=>p(x,e):void 0})}const op=M.memo(np),rp=e=>e.nodes.map(t=>t.id),Mn=e=>e instanceof Function?e:()=>e;function ip({nodeStrokeColor:e,nodeColor:t,nodeClassName:n="",nodeBorderRadius:o=5,nodeStrokeWidth:r,nodeComponent:i=op,onClick:s}){const a=ie(rp,ae),c=Mn(t),l=Mn(e),u=Mn(n),f=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return g.jsx(g.Fragment,{children:a.map(d=>g.jsx(ap,{id:d,nodeColorFunc:c,nodeStrokeColorFunc:l,nodeClassNameFunc:u,nodeBorderRadius:o,nodeStrokeWidth:r,NodeComponent:i,onClick:s,shapeRendering:f},d))})}function sp({id:e,nodeColorFunc:t,nodeStrokeColorFunc:n,nodeClassNameFunc:o,nodeBorderRadius:r,nodeStrokeWidth:i,shapeRendering:s,NodeComponent:a,onClick:c}){const{node:l,x:u,y:f,width:d,height:p}=ie(m=>{const{internals:w}=m.nodeLookup.get(e),v=w.userNode,{x,y:N}=w.positionAbsolute,{width:h,height:y}=Ie(v);return{node:v,x,y:N,width:h,height:y}},ae);return!l||l.hidden||!Ei(l)?null:g.jsx(a,{x:u,y:f,width:d,height:p,style:l.style,selected:!!l.selected,className:o(l),color:t(l),borderRadius:r,strokeColor:n(l),strokeWidth:i,shapeRendering:s,onClick:c,id:l.id})}const ap=M.memo(sp);var cp=M.memo(ip);const lp=200,up=150,dp=e=>!e.hidden,fp=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?Ni(Ct(e.nodeLookup,{filter:dp}),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height,ariaLabelConfig:e.ariaLabelConfig}},hp="react-flow__minimap-desc";function Cs({style:e,className:t,nodeStrokeColor:n,nodeColor:o,nodeClassName:r="",nodeBorderRadius:i=5,nodeStrokeWidth:s,nodeComponent:a,bgColor:c,maskColor:l,maskStrokeColor:u,maskStrokeWidth:f,position:d="bottom-right",onClick:p,onNodeClick:m,pannable:w=!1,zoomable:v=!1,ariaLabel:x,inversePan:N,zoomStep:h=1,offsetScale:y=5}){const S=ce(),E=M.useRef(null),{boundingRect:_,viewBB:$,rfId:D,panZoom:F,translateExtent:A,flowWidth:z,flowHeight:H,ariaLabelConfig:b}=ie(fp,ae),k=e?.width??lp,C=e?.height??up,P=_.width/k,I=_.height/C,T=Math.max(P,I),j=T*k,V=T*C,O=y*T,W=_.x-(j-_.width)/2-O,Y=_.y-(V-_.height)/2-O,Q=j+O*2,ne=V+O*2,K=`${hp}-${D}`,X=M.useRef(0),U=M.useRef();X.current=T,M.useEffect(()=>{if(E.current&&F)return U.current=Pf({domNode:E.current,panZoom:F,getTransform:()=>S.getState().transform,getViewScale:()=>X.current}),()=>{U.current?.destroy()}},[F]),M.useEffect(()=>{U.current?.update({translateExtent:A,width:z,height:H,inversePan:N,pannable:w,zoomStep:h,zoomable:v})},[w,v,N,h,A,z,H]);const re=p?te=>{const[L,R]=U.current?.pointer(te)||[0,0];p(te,{x:L,y:R})}:void 0,oe=m?M.useCallback((te,L)=>{const R=S.getState().nodeLookup.get(L).internals.userNode;m(te,R)},[]):void 0,J=x??b["minimap.ariaLabel"];return g.jsx(Mt,{position:d,style:{...e,"--xy-minimap-background-color-props":typeof c=="string"?c:void 0,"--xy-minimap-mask-background-color-props":typeof l=="string"?l:void 0,"--xy-minimap-mask-stroke-color-props":typeof u=="string"?u:void 0,"--xy-minimap-mask-stroke-width-props":typeof f=="number"?f*T:void 0,"--xy-minimap-node-background-color-props":typeof o=="string"?o:void 0,"--xy-minimap-node-stroke-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-width-props":typeof s=="number"?s:void 0},className:ue(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:g.jsxs("svg",{width:k,height:C,viewBox:`${W} ${Y} ${Q} ${ne}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":K,ref:E,onClick:re,children:[J&&g.jsx("title",{id:K,children:J}),g.jsx(cp,{onClick:oe,nodeColor:o,nodeStrokeColor:n,nodeBorderRadius:i,nodeClassName:r,nodeStrokeWidth:s,nodeComponent:a}),g.jsx("path",{className:"react-flow__minimap-mask",d:`M${W-O},${Y-O}h${Q+O*2}v${ne+O*2}h${-Q-O*2}z
        M${$.x},${$.y}h${$.width}v${$.height}h${-$.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}Cs.displayName="MiniMap";const gp=M.memo(Cs),pp=e=>t=>e?`${Math.max(1/t.transform[2],1)}`:void 0,mp={[ot.Line]:"right",[ot.Handle]:"bottom-right"};function xp({nodeId:e,position:t,variant:n=ot.Handle,className:o,style:r=void 0,children:i,color:s,minWidth:a=10,minHeight:c=10,maxWidth:l=Number.MAX_VALUE,maxHeight:u=Number.MAX_VALUE,keepAspectRatio:f=!1,resizeDirection:d,autoScale:p=!0,shouldResize:m,onResizeStart:w,onResize:v,onResizeEnd:x}){const N=lo(),h=typeof e=="string"?e:N,y=ce(),S=M.useRef(null),E=n===ot.Handle,_=ie(M.useCallback(pp(E&&p),[E,p]),ae),$=M.useRef(null),D=t??mp[n];M.useEffect(()=>{if(!(!S.current||!h))return $.current||($.current=Yf({domNode:S.current,nodeId:h,getStoreItems:()=>{const{nodeLookup:A,transform:z,snapGrid:H,snapToGrid:b,nodeOrigin:k,domNode:C}=y.getState();return{nodeLookup:A,transform:z,snapGrid:H,snapToGrid:b,nodeOrigin:k,paneDomNode:C}},onChange:(A,z)=>{const{triggerNodeChanges:H,nodeLookup:b,parentLookup:k,nodeOrigin:C}=y.getState(),P=[],I={x:A.x,y:A.y},T=b.get(h);if(T&&T.expandParent&&T.parentId){const j=T.origin??C,V=A.width??T.measured.width??0,O=A.height??T.measured.height??0,W={id:T.id,parentId:T.parentId,rect:{width:V,height:O,..._i({x:A.x??T.position.x,y:A.y??T.position.y},{width:V,height:O},T.parentId,b,j)}},Y=so([W],b,k,C);P.push(...Y),I.x=A.x?Math.max(j[0]*V,A.x):void 0,I.y=A.y?Math.max(j[1]*O,A.y):void 0}if(I.x!==void 0&&I.y!==void 0){const j={id:h,type:"position",position:{...I}};P.push(j)}if(A.width!==void 0&&A.height!==void 0){const V={id:h,type:"dimensions",resizing:!0,setAttributes:d?d==="horizontal"?"width":"height":!0,dimensions:{width:A.width,height:A.height}};P.push(V)}for(const j of z){const V={...j,type:"position"};P.push(V)}H(P)},onEnd:({width:A,height:z})=>{const H={id:h,type:"dimensions",resizing:!1,dimensions:{width:A,height:z}};y.getState().triggerNodeChanges([H])}})),$.current.update({controlPosition:D,boundaries:{minWidth:a,minHeight:c,maxWidth:l,maxHeight:u},keepAspectRatio:f,resizeDirection:d,onResizeStart:w,onResize:v,onResizeEnd:x,shouldResize:m}),()=>{$.current?.destroy()}},[D,a,c,l,u,f,w,v,x,m]);const F=D.split("-");return g.jsx("div",{className:ue(["react-flow__resize-control","nodrag",...F,n,o]),ref:S,style:{...r,scale:_,...s&&{[E?"backgroundColor":"borderColor"]:s}},children:i})}M.memo(xp);const $e=({type:e,position:t,id:n,isConnectable:o,className:r,style:i,blockedBy:s,onHandleClick:a})=>{kr({type:e,id:n});const c=kr({type:s?.type,id:s?.id});return s&&c.length>0?null:g.jsx(bt,{type:e,position:t,id:n,isConnectable:o,className:`${r} cursor-pointer hover:scale-125 transition-transform`,style:i,onClick:u=>{u.stopPropagation(),a&&a(n)},title:"Clique para interagir"})},yp=({id:e,data:t,isConnectable:n,selected:o})=>{const r=t.color||"",i=!!r&&r!=="#000000"&&r!=="#ffffff",s=a=>{t.onHandleClick?.(a,e)};return g.jsxs(Ir,{className:`min-w-[280px] bg-card shadow-xl border-2 transition-all duration-200 ${o?"ring-2 ring-primary/20":""}`,style:{borderColor:o?"var(--primary)":i?r:void 0},children:[g.jsx($e,{type:"target",position:Z.Left,id:"l-target",isConnectable:n,className:"!w-4 !h-4 !bg-primary !border-4 !border-background hover:!bg-primary/80 transition-colors z-10",style:{backgroundColor:i?r:void 0,top:"50%"},onHandleClick:s}),g.jsx($e,{type:"source",position:Z.Left,id:"l-source",isConnectable:n,className:"!w-3 !h-3 !bg-primary !border-2 !border-background hover:!bg-primary/80 transition-colors z-20 opacity-0 hover:opacity-100",style:{backgroundColor:i?r:void 0,top:"50%"},blockedBy:{type:"target",id:"l-target"},onHandleClick:s}),g.jsx($e,{type:"target",position:Z.Top,id:"t-target",isConnectable:n,className:"!w-4 !h-4 !bg-primary !border-4 !border-background hover:!bg-primary/80 transition-colors z-10",style:{backgroundColor:i?r:void 0,left:"50%"},onHandleClick:s}),g.jsx($e,{type:"source",position:Z.Top,id:"t-source",isConnectable:n,className:"!w-3 !h-3 !bg-primary !border-2 !border-background hover:!bg-primary/80 transition-colors z-20 opacity-0 hover:opacity-100",style:{backgroundColor:i?r:void 0,left:"50%"},blockedBy:{type:"target",id:"t-target"},onHandleClick:s}),g.jsxs(Oa,{className:"p-3 pb-2 flex flex-row items-center justify-between space-y-0 border-b border-border/50 bg-muted/30",style:{backgroundColor:i?`${r}15`:void 0,borderBottomColor:i?`${r}30`:void 0},children:[g.jsx(He,{value:t.title,onChange:a=>t.onTitleChange?.(a.target.value),className:"h-8 font-semibold text-sm border-transparent hover:border-input focus:border-input px-2 bg-transparent w-[140px] nodrag",placeholder:"Nome do Node",style:{color:i?r:void 0}}),g.jsxs("div",{className:"flex items-center",children:[g.jsx(pe,{variant:"ghost",size:"icon",className:"h-7 w-7 text-muted-foreground hover:text-primary hover:bg-primary/10 nodrag",onClick:a=>{a.stopPropagation(),t.onEdit?.(a)},title:"Editar node",children:g.jsx(Za,{className:"h-3.5 w-3.5"})}),g.jsx(pe,{variant:"ghost",size:"icon",className:"h-7 w-7 text-muted-foreground hover:text-destructive hover:bg-destructive/10 nodrag",onClick:a=>{a.stopPropagation(),t.onDelete?.()},title:"Remover node",children:g.jsx(Mr,{className:"h-4 w-4"})})]})]}),g.jsxs(Va,{className:"p-4 space-y-4",children:[t.fields?.map(a=>g.jsxs("div",{className:"space-y-1.5 group",children:[g.jsx(In,{className:"text-xs font-medium text-muted-foreground group-hover:text-foreground transition-colors",children:a.label}),a.type==="text"&&g.jsx(He,{value:a.value,onChange:c=>t.onUpdate?.(a.id,c.target.value),className:"h-9 text-sm bg-background/50",placeholder:"Digite algo..."}),a.type==="number"&&g.jsx(He,{type:"number",value:a.value,onChange:c=>t.onUpdate?.(a.id,c.target.value===""?"":Number(c.target.value)),className:"h-9 text-sm bg-background/50",placeholder:"0"}),a.type==="textarea"&&g.jsx(Ba,{value:a.value,onChange:c=>t.onUpdate?.(a.id,c.target.value),className:"min-h-[80px] text-sm bg-background/50 resize-none",placeholder:"Digite seu texto aqui..."}),a.type==="select"&&g.jsxs(Ar,{value:a.value,onValueChange:c=>t.onUpdate?.(a.id,c),children:[g.jsx(Pr,{className:"h-9 text-sm bg-background/50",children:g.jsx(Fa,{placeholder:"Selecione..."})}),g.jsx($r,{children:a.options?.map(c=>g.jsx(ze,{value:c.value,children:c.label},c.value))})]}),a.type==="multiselect"&&g.jsxs(Xa,{children:[g.jsx(Ya,{asChild:!0,children:g.jsx(pe,{variant:"outline",className:"w-full justify-between h-auto min-h-9 py-2 px-3 text-left font-normal text-sm bg-background/50",children:Array.isArray(a.value)&&a.value.length>0?g.jsx("span",{className:"truncate",children:a.value.map(c=>a.options?.find(l=>l.value===c)?.label||c).join(", ")}):g.jsx("span",{className:"text-muted-foreground",children:"Selecione opes..."})})}),g.jsx(Wa,{className:"w-[240px] p-0",align:"start",children:g.jsxs("div",{className:"p-1 max-h-[200px] overflow-y-auto",children:[a.options?.map(c=>{const l=Array.isArray(a.value)&&a.value.includes(c.value);return g.jsxs("div",{className:"flex items-center space-x-2 p-2 rounded-sm hover:bg-accent cursor-pointer",onClick:()=>{const u=Array.isArray(a.value)?a.value:[],f=l?u.filter(d=>d!==c.value):[...u,c.value];t.onUpdate?.(a.id,f)},children:[g.jsx(vo,{checked:l}),g.jsx("span",{className:"text-sm",children:c.label})]},c.value)}),(!a.options||a.options.length===0)&&g.jsx("div",{className:"p-2 text-xs text-muted-foreground text-center",children:"Sem opes"})]})})]}),a.type==="checkbox"&&g.jsxs("div",{className:"flex items-center space-x-2 p-2 rounded-md border border-input bg-background/50",children:[g.jsx(vo,{id:`check-${a.id}`,checked:a.value,onCheckedChange:c=>t.onUpdate?.(a.id,c)}),g.jsx("label",{htmlFor:`check-${a.id}`,className:"text-sm cursor-pointer select-none flex-1 flex items-center gap-2",children:a.value?g.jsxs("span",{className:"flex items-center text-green-600 font-medium",children:[g.jsx(Ga,{className:"w-4 h-4 mr-1.5"})," Ativado"]}):g.jsxs("span",{className:"flex items-center text-red-500 font-medium",children:[g.jsx(lc,{className:"w-4 h-4 mr-1.5"})," Desativado"]})})]}),a.type==="color"&&g.jsxs("div",{className:"flex items-center gap-2 p-1 rounded-md border border-input bg-background/50",children:[g.jsx("input",{type:"color",value:a.value,onChange:c=>t.onUpdate?.(a.id,c.target.value),className:"h-8 w-12 cursor-pointer rounded border-none bg-transparent p-0"}),g.jsx("span",{className:"text-xs text-muted-foreground font-mono",children:a.value})]})]},a.id)),(!t.fields||t.fields.length===0)&&g.jsx("div",{className:"text-center py-4 text-xs text-muted-foreground italic",children:"Nenhum campo configurado"})]}),g.jsx($e,{type:"source",position:Z.Bottom,id:"b-source",isConnectable:n,className:"!w-4 !h-4 !bg-primary !border-4 !border-background hover:!bg-primary/80 transition-colors z-10",style:{backgroundColor:i?r:void 0,left:"50%"},blockedBy:{type:"target",id:"b-target"},onHandleClick:s}),g.jsx($e,{type:"target",position:Z.Bottom,id:"b-target",isConnectable:n,className:"!w-3 !h-3 !bg-primary !border-2 !border-background hover:!bg-primary/80 transition-colors z-20 opacity-0 hover:opacity-100",style:{backgroundColor:i?r:void 0,left:"50%"},onHandleClick:s}),g.jsx($e,{type:"source",position:Z.Right,id:"r-source",isConnectable:n,className:"!w-4 !h-4 !bg-primary !border-4 !border-background hover:!bg-primary/80 transition-colors z-10",style:{backgroundColor:i?r:void 0,top:"50%"},blockedBy:{type:"target",id:"r-target"},onHandleClick:s}),g.jsx($e,{type:"target",position:Z.Right,id:"r-target",isConnectable:n,className:"!w-3 !h-3 !bg-primary !border-2 !border-background hover:!bg-primary/80 transition-colors z-20 opacity-0 hover:opacity-100",style:{backgroundColor:i?r:void 0,top:"50%"},onHandleClick:s})]})},wp=M.memo(yp),vp={custom:wp},bp=[{id:"1",type:"custom",position:{x:100,y:100},data:{title:"Incio do Mapa Mental",color:"#2563eb",fields:[{id:"f1",type:"text",label:"Nome do Projeto",value:"Meu Mapa Mental"},{id:"f2",type:"select",label:"Ambiente",value:"prod",options:[{label:"Produo",value:"prod"},{label:"Homologao",value:"staging"}]}]}}],Np=[],Ep=e=>{switch(e){case"text":return g.jsx(An,{className:"w-4 h-4"});case"textarea":return g.jsx(Hr,{className:"w-4 h-4"});case"number":return g.jsx(zr,{className:"w-4 h-4"});case"select":return g.jsx(Tr,{className:"w-4 h-4"});case"multiselect":return g.jsx(Dr,{className:"w-4 h-4"});case"checkbox":return g.jsx(jr,{className:"w-4 h-4"});case"color":return g.jsx(sc,{className:"w-4 h-4"});default:return g.jsx(An,{className:"w-4 h-4"})}},_p=e=>{switch(e){case"text":return"Texto Curto";case"textarea":return"Texto Longo";case"number":return"Nmero";case"select":return"Dropdown";case"multiselect":return"Mltipla Escolha";case"checkbox":return"Caixa de Seleo";case"color":return"Cor";default:return e}};function Cp(){const{id:e}=za(),t=ja(),{user:n}=Ha(),o=Ra(),[r,i,s]=Bg(bp),[a,c,l]=Fg(Np),[u,f]=M.useState("Meu Novo Mapa Mental"),[d,p]=M.useState(!1),m=M.useRef([]),w=M.useRef([]),[v,x]=M.useState(null),N=M.useRef(!0),h=M.useCallback(()=>{N.current=!1},[]),y=M.useCallback((L,R)=>{N.current=!0,c(B=>lf(L,R,B))},[c]),S=M.useCallback((L,R)=>{if(!R?.id){N.current=!0;return}N.current||w.current.some(q=>q.id===R.id)&&(c(q=>q.filter(G=>G.id!==R.id)),le.info("Conexo removida")),N.current=!0},[c]),[E,_]=M.useState(!1),[$,D]=M.useState(null),[F,A]=M.useState("Novo Node"),[z,H]=M.useState("#000000"),[b,k]=M.useState([]),[C,P]=M.useState(!0),I=M.useCallback((L,R)=>{i(B=>B.map(q=>q.id===L?{...q,data:{...q.data,...R}}:q))},[i]),T=M.useCallback((L,R,B)=>{i(q=>q.map(G=>{if(G.id===L){const se=(G.data.fields||[]).map(de=>de.id===R?{...de,value:B}:de);return{...G,data:{...G.data,fields:se}}}return G}))},[i]),j=M.useCallback(L=>{i(R=>R.filter(B=>B.id!==L)),le.success("Node removido")},[i]);M.useEffect(()=>{m.current=r},[r]),M.useEffect(()=>{w.current=a},[a]),M.useEffect(()=>{if(!v)return;const L=R=>{if(R.key!=="Delete"&&R.key!=="Backspace")return;const B=R.target,q=B?.tagName;q==="INPUT"||q==="TEXTAREA"||B?.isContentEditable||(c(G=>G.filter(ee=>ee.id!==v)),x(null),le.info("Conexo removida"))};return window.addEventListener("keydown",L),()=>window.removeEventListener("keydown",L)},[v,c]);const V=M.useCallback(L=>{const R=m.current.find(B=>B.id===L);R&&(D(R.id),A(R.data.title),H(R.data.color||"#000000"),k(JSON.parse(JSON.stringify(R.data.fields||[]))),_(!0))},[]),O=()=>{D(null),A("Novo Node"),H("#000000"),k([]),_(!0)},W=M.useRef(null),Y=M.useCallback((L,R)=>{const B=Date.now(),q=W.current;if(q&&B-q.timestamp<300){if(q.handleId===L&&q.nodeId===R){const G=w.current.filter(ee=>ee.source===R&&ee.sourceHandle===L||ee.target===R&&ee.targetHandle===L);G.length>0&&(c(ee=>ee.map(se=>G.some(de=>de.id===se.id)?{...se,style:{...se.style,stroke:"#ef4444",strokeWidth:3},animated:!0}:se)),setTimeout(()=>{c(ee=>{const se=ee.filter(de=>!G.some(De=>De.id===de.id));return ee.length!==se.length&&le.info(`${G.length} conexo(es) removida(s)`),se})},400))}else{const G=w.current.find(ee=>ee.source===q.nodeId&&ee.sourceHandle===q.handleId&&ee.target===R&&ee.targetHandle===L||ee.target===q.nodeId&&ee.targetHandle===q.handleId&&ee.source===R&&ee.sourceHandle===L);G&&(c(ee=>ee.map(se=>se.id===G.id?{...se,style:{...se.style,stroke:"#ef4444",strokeWidth:3},animated:!0}:se)),setTimeout(()=>{c(ee=>{const se=ee.filter(de=>de.id!==G.id);return ee.length!==se.length&&le.info("Conexo removida"),se})},400))}W.current=null}else W.current={handleId:L,nodeId:R,timestamp:B}},[c]);M.useEffect(()=>{r.some(R=>{const B=R?.data;return!(B?.onDelete&&B?.onUpdate&&B?.onTitleChange&&B?.onEdit&&B?.onHandleClick)})&&i(R=>{let B=!1;const q=R.map(G=>{const ee=G?.data??{};return ee.onDelete&&ee.onUpdate&&ee.onTitleChange&&ee.onEdit&&ee.onHandleClick?G:(B=!0,{...G,data:{...ee,onDelete:()=>j(G.id),onEdit:()=>V(G.id),onUpdate:(se,de)=>T(G.id,se,de),onTitleChange:se=>I(G.id,{title:se}),onHandleClick:(se,de)=>Y(se,de)}})});return B?q:R})},[j,r,V,i,I,T,Y]);const Q=M.useCallback(L=>{const{source:R,target:B}=L;if(!R||!B)return;if(w.current.some(G=>G.source===R&&G.target===B||G.source===B&&G.target===R)){le.error("J existe uma conexo entre estes dois nodes.");return}c(G=>$i({...L,type:"smoothstep",animated:!0,reconnectable:!0,interactionWidth:25,style:{stroke:"#8b5cf6",strokeWidth:2}},G)),le.success("Conexo criada!")},[c]);M.useEffect(()=>{if(!e||!n)return;(async()=>{const{data:R,error:B}=await At.from("workflows").select("id, title, nodes, edges").eq("id",e).eq("user_id",n.id).single();if(B){le.error("Erro ao carregar mapa mental");return}if(f(R.title??"Meu Mapa Mental"),Array.isArray(R.nodes)&&i(R.nodes),Array.isArray(R.edges)){const q=R.edges.map(G=>({...G,type:G.type??"smoothstep",animated:G.animated??!0,reconnectable:G.reconnectable??!0,interactionWidth:G.interactionWidth??25,style:{stroke:"#8b5cf6",strokeWidth:2,...G.style??{}}}));c(q)}})()},[e,n,i,c]);const ne=M.useCallback(async()=>{if(!n){le.error("Voc precisa estar logado para salvar");return}if(o&&!o.canUseTool("workflow-save-btn")){o.notifyToolBlocked();return}if(!d){p(!0);try{const L=oc(r),R={user_id:n.id,title:u||"Meu Novo Mapa Mental",nodes:L,edges:a};if(e){const{error:se}=await At.from("workflows").update(R).eq("id",e).eq("user_id",n.id);if(se){le.error("Erro ao salvar mapa mental");return}le.success("Mapa mental salvo com sucesso!");return}const{count:B,error:q}=await At.from("workflows").select("id",{count:"exact",head:!0}).eq("user_id",n.id);if(q){le.error("Erro ao validar limite de mapas mentais");return}if((B??0)>=rc){le.error("Voc atingiu o limite de 4 mapas mentais. Exclua um para criar outro.");return}const{data:G,error:ee}=await At.from("workflows").insert(R).select("id").single();if(ee){ic(ee)?le.error("Voc atingiu o limite de 4 mapas mentais. Exclua um para criar outro."):le.error("Erro ao criar mapa mental");return}le.success("Mapa mental criado com sucesso!"),t(`/dashboard/workflow/${G.id}`)}catch(L){console.error(L),le.error("Erro inesperado ao salvar mapa mental")}finally{p(!1)}}},[o,a,u,t,r,d,n,e]),K=()=>{const L={id:crypto.randomUUID(),type:"text",label:"",value:"",options:[]};k([...b,L])},X=(L,R)=>{k(b.map(B=>B.id===L?(R.type==="select"||R.type==="multiselect")&&(!B.options||B.options.length===0)?{...B,...R,options:[{label:"Opo 1",value:"opt1"}]}:{...B,...R}:B))},U=L=>{k(b.filter(R=>R.id!==L))},re=L=>{k(b.map(R=>{if(R.id===L){const B=`opt${(R.options?.length||0)+1}`;return{...R,options:[...R.options||[],{label:`Opo ${(R.options?.length||0)+1}`,value:B}]}}return R}))},oe=(L,R,B)=>{k(b.map(q=>{if(q.id===L&&q.options){const G=[...q.options];return G[R]={...G[R],label:B,value:B},{...q,options:G}}return q}))},J=(L,R)=>{k(b.map(B=>{if(B.id===L&&B.options){const q=B.options.filter((G,ee)=>ee!==R);return{...B,options:q}}return B}))},te=()=>{if($)i(L=>L.map(R=>R.id===$?{...R,data:{...R.data,title:F,color:z,fields:b}}:R)),le.success("Node atualizado com sucesso!");else{const L=crypto.randomUUID(),R={x:Math.random()*300+100,y:Math.random()*300+100},B={id:L,type:"custom",position:R,data:{title:F||"Novo Node",color:z,fields:b}};i(q=>q.concat(B)),le.success("Node criado com sucesso!")}_(!1),D(null)};return g.jsx("div",{className:"h-[calc(100vh-6rem)] w-full bg-background relative rounded-xl overflow-hidden border border-border shadow-sm",id:"workflow-editor-canvas",children:g.jsxs(Vg,{nodes:r,edges:a,onNodesChange:s,onEdgesChange:l,onConnect:Q,onReconnect:y,onReconnectStart:h,onReconnectEnd:S,onEdgeClick:(L,R)=>{L.stopPropagation(),x(R.id),le.info("Pressione Delete para remover a conexo")},onPaneClick:()=>x(null),nodeTypes:vp,fitView:!0,fitViewOptions:{padding:.2,maxZoom:1},minZoom:.1,maxZoom:2,snapToGrid:!0,snapGrid:[15,15],className:"bg-slate-50 dark:bg-slate-950",defaultEdgeOptions:{type:"smoothstep",animated:!0,reconnectable:!0,interactionWidth:25,style:{stroke:"#8b5cf6",strokeWidth:2}},children:[g.jsx(qg,{variant:ke.Dots,gap:12,size:1}),g.jsx(tp,{className:"!bg-background !border-border [&>button]:!border-border [&>button]:!bg-background [&>button]:!text-foreground hover:[&>button]:!bg-muted"}),g.jsx(gp,{className:"!bg-background !border-border",zoomable:!0,pannable:!0}),g.jsxs(Mt,{position:"top-left",className:"bg-background/80 backdrop-blur-md p-2 rounded-lg border border-border shadow-lg flex gap-2 items-center",id:"workflow-editor-panel",children:[g.jsx(He,{value:u,onChange:L=>f(L.target.value),className:"w-[200px] h-9 bg-background",placeholder:"Nome do Mapa Mental"}),g.jsx("div",{className:"h-6 w-px bg-border mx-1"}),g.jsxs(Ua,{open:E,onOpenChange:_,children:[g.jsx(Ka,{asChild:!0,children:g.jsxs(pe,{className:"gap-2 shadow-sm hover:shadow-md transition-all",onClick:O,id:"workflow-add-node-btn",children:[g.jsx(bo,{className:"w-4 h-4"}),"Adicionar Node"]})}),g.jsxs(Qa,{className:"w-[95vw] sm:w-full sm:max-w-[600px] max-h-[85vh] flex flex-col",children:[g.jsxs(Ja,{children:[g.jsx(ec,{children:$?"Editar Node":"Criar Novo Node"}),g.jsx(tc,{children:"Personalize o layout e campos do seu node."})]}),g.jsxs("div",{className:"space-y-6 py-4 flex-1 overflow-y-auto pr-2",children:[g.jsxs("div",{className:"bg-card border rounded-lg p-4 space-y-4 shadow-sm relative overflow-hidden",children:[g.jsx("div",{className:"absolute top-0 left-0 w-2 h-full",style:{backgroundColor:z||"#000"}}),g.jsxs("div",{className:"grid grid-cols-[1fr,auto] gap-4 items-start pl-2",children:[g.jsxs("div",{className:"space-y-2",children:[g.jsx(In,{children:"Ttulo do Node"}),g.jsx(He,{value:F,onChange:L=>A(L.target.value),placeholder:"Ttulo do Formulrio",className:"text-lg font-medium border-transparent hover:border-input focus:border-input px-0 h-auto py-1 rounded-none border-b transition-colors bg-transparent"})]}),g.jsxs("div",{className:"flex flex-col items-center gap-1",children:[g.jsx(In,{className:"text-xs text-muted-foreground",children:"Cor"}),g.jsxs("div",{className:"relative",children:[g.jsx("input",{type:"color",value:z,onChange:L=>H(L.target.value),className:"w-8 h-8 rounded-full cursor-pointer overflow-hidden border-2 border-border p-0 absolute opacity-0"}),g.jsx("div",{className:"w-8 h-8 rounded-full border-2 border-border shadow-sm",style:{backgroundColor:z||"#000"}})]})]})]})]}),g.jsxs("div",{className:"space-y-4",children:[b.map((L,R)=>g.jsx(Ir,{className:"p-4 space-y-4 relative group border-l-4 border-l-transparent hover:border-l-primary/50 transition-all",children:g.jsxs("div",{className:"flex gap-4 items-start",children:[g.jsxs("div",{className:"flex-1 space-y-3",children:[g.jsxs("div",{className:"flex gap-4",children:[g.jsx("div",{className:"flex-1",children:g.jsx(He,{value:L.label,onChange:B=>X(L.id,{label:B.target.value}),placeholder:"Pergunta / Rtulo",className:"bg-muted/30 border-transparent focus:border-input transition-colors"})}),g.jsxs(Ar,{value:L.type,onValueChange:B=>X(L.id,{type:B}),children:[g.jsx(Pr,{className:"w-[180px]",children:g.jsxs("div",{className:"flex items-center gap-2",children:[Ep(L.type),g.jsx("span",{children:_p(L.type)})]})}),g.jsxs($r,{children:[g.jsx(ze,{value:"text",children:g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(An,{className:"w-4 h-4"})," Texto Curto"]})}),g.jsx(ze,{value:"textarea",children:g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(Hr,{className:"w-4 h-4"})," Texto Longo"]})}),g.jsx(ze,{value:"number",children:g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(zr,{className:"w-4 h-4"})," Nmero"]})}),g.jsx(ze,{value:"select",children:g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(Tr,{className:"w-4 h-4"})," Dropdown"]})}),g.jsx(ze,{value:"multiselect",children:g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(Dr,{className:"w-4 h-4"})," Mltipla Escolha"]})}),g.jsx(ze,{value:"checkbox",children:g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(jr,{className:"w-4 h-4"})," Checkbox"]})})]})]})]}),(L.type==="select"||L.type==="multiselect")&&g.jsxs("div",{className:"pl-4 space-y-2 border-l-2 border-muted ml-1",children:[L.options?.map((B,q)=>g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("div",{className:"w-4 h-4 rounded-full border border-muted-foreground/40 flex items-center justify-center",children:g.jsx("div",{className:"w-2 h-2 rounded-full bg-muted-foreground/20"})}),g.jsx(He,{value:B.label,onChange:G=>oe(L.id,q,G.target.value),className:"h-8 text-sm flex-1 border-transparent hover:border-input focus:border-input",placeholder:`Opo ${q+1}`}),g.jsx(pe,{variant:"ghost",size:"icon",className:"h-8 w-8 text-muted-foreground hover:text-destructive opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>J(L.id,q),children:g.jsx(Mr,{className:"w-4 h-4"})})]},q)),g.jsx(pe,{variant:"ghost",size:"sm",className:"text-muted-foreground hover:text-primary text-xs h-8 ml-6",onClick:()=>re(L.id),children:"Adicionar opo"})]}),L.type==="text"&&g.jsx("div",{className:"text-xs text-muted-foreground ml-1 italic border-b border-dashed w-1/2 pb-1",children:"Texto de resposta curta"}),L.type==="textarea"&&g.jsx("div",{className:"text-xs text-muted-foreground ml-1 italic border-b border-dashed w-3/4 pb-4",children:"Texto de resposta longa"})]}),g.jsx(pe,{variant:"ghost",size:"icon",className:"text-muted-foreground hover:text-destructive",onClick:()=>U(L.id),children:g.jsx(ac,{className:"w-4 h-4"})})]})},L.id)),g.jsxs(pe,{variant:"outline",className:"w-full border-dashed py-6 text-muted-foreground hover:text-primary hover:border-primary hover:bg-primary/5 transition-colors",onClick:K,children:[g.jsx(bo,{className:"w-4 h-4 mr-2"}),"Adicionar Novo Campo"]})]})]}),g.jsxs(nc,{className:"mt-4 pt-4 border-t",children:[g.jsx(pe,{variant:"ghost",onClick:()=>_(!1),children:"Cancelar"}),g.jsx(pe,{onClick:te,className:"min-w-[120px]",children:$?"Salvar Alteraes":"Criar Node"})]})]})]}),g.jsx(pe,{variant:"outline",size:"icon",title:"Salvar Mapa Mental",onClick:ne,id:"workflow-save-btn",disabled:d,children:g.jsx(qa,{className:"w-4 h-4"})})]})]})})}function Qp(){const{startWorkflowEditorTutorial:e}=$a();return g.jsx(Ta,{children:g.jsxs("div",{className:"space-y-4 h-full flex flex-col",children:[g.jsxs("div",{className:"flex items-center justify-between px-2",id:"workflow-editor-header",children:[g.jsxs("div",{children:[g.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"Editor de Mapa Mental"}),g.jsx("p",{className:"text-muted-foreground",children:"Crie e gerencie seus mapas mentais visuais interativos."})]}),g.jsxs(pe,{onClick:e,variant:"outline",className:"flex gap-2 bg-white/10 hover:bg-white/20 border-white/20 text-foreground px-6",children:[g.jsx(Da,{className:"w-4 h-4 text-yellow-500"}),"Como usar"]})]}),g.jsx("div",{className:"flex-1 min-h-[600px]",children:g.jsx(Ns,{children:g.jsx(Cp,{})})})]})})}export{Qp as default};
