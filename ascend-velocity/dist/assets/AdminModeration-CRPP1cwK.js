import{j as a,I as x,H as c,o as e,a9 as j,N as f,ac as N,G as v}from"./index-BSbx0JO7.js";import{G as w}from"./GlassCard-VIvyi7x2.js";import{I as y}from"./input-DQGwEGmE.js";import{S as _}from"./search-DPd-n7Mp.js";import{E as C}from"./external-link-oCZf_Lj-.js";import{E as k}from"./eye-off-CqBKnFjT.js";function A(){const[h,n]=a.useState(!0),[l,m]=a.useState([]),[i,g]=a.useState(""),o=a.useCallback(async()=>{n(!0);try{const{data:s,error:r}=await x.from("bio_pages").select("*, user:profiles(email)").order("created_at",{ascending:!1}).range(0,49);if(r)throw r;m(s??[])}catch(s){console.error(s),c.error("Erro ao carregar páginas")}finally{n(!1)}},[]);a.useEffect(()=>{o()},[o]);const p=async(s,r)=>{try{const{error:t}=await x.from("bio_pages").update({is_published:!r}).eq("id",s);if(t)throw t;m(b=>b.map(d=>d.id===s?{...d,is_published:!r}:d)),c.success(r?"Página despublicada (banida)":"Página publicada")}catch(t){console.error(t),c.error("Erro ao alterar status")}},u=a.useMemo(()=>{const s=i.trim().toLowerCase();return s?l.filter(r=>r.slug.toLowerCase().includes(s)||(r.title??"").toLowerCase().includes(s)||(r.user?.email??"").toLowerCase().includes(s)):l},[l,i]);return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-start sm:justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold mb-2 flex items-center gap-3",children:[e.jsx(j,{className:"w-8 h-8 text-purple-600 dark:text-purple-400"}),"Moderação de Conteúdo"]}),e.jsx("p",{className:"text-muted-foreground",children:"Monitore e modere páginas criadas pelos usuários."})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 w-full sm:w-auto",children:[e.jsxs("div",{className:"relative flex-1 sm:w-80",children:[e.jsx(_,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(y,{value:i,onChange:s=>g(s.target.value),placeholder:"Buscar por slug, título ou email...",className:"pl-10 bg-background/60"})]}),e.jsxs(f,{variant:"glass",onClick:()=>{o()},className:"gap-2",children:[e.jsx(N,{className:"w-4 h-4"}),"Atualizar"]})]})]}),h?e.jsx("div",{className:"py-20 text-center text-muted-foreground",children:"Carregando..."}):u.length===0?e.jsx("div",{className:"py-20 text-center text-muted-foreground",children:"Nenhuma página encontrada."}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:u.map(s=>e.jsxs(w,{className:"overflow-hidden flex flex-col group",children:[e.jsxs("div",{className:"h-32 bg-muted/30 relative",children:[s.profile_image?e.jsx("img",{src:s.profile_image,className:"w-full h-full object-cover opacity-50 group-hover:opacity-100 transition-opacity",alt:"Capa"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-muted-foreground bg-muted/50",children:"Sem imagem"}),e.jsx("div",{className:"absolute top-2 right-2 flex gap-2",children:e.jsx("a",{href:`/bio/${s.slug}`,target:"_blank",rel:"noopener noreferrer",className:"p-2 rounded-full bg-background/80 hover:bg-background text-foreground transition-colors backdrop-blur-sm",title:"Ver página",children:e.jsx(C,{className:"w-4 h-4"})})})]}),e.jsxs("div",{className:"p-4 flex-1 flex flex-col",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg truncate",title:s.title??"",children:s.title||s.slug}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["/",s.slug]})]}),e.jsx("div",{className:`w-2 h-2 rounded-full mt-2 ${s.is_published?"bg-green-500":"bg-red-500"}`,title:s.is_published?"Publicada":"Privada/Banida"})]}),e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2 mb-4 flex-1",children:s.description||"Sem descrição"}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-border/50",children:[e.jsx("span",{className:"text-xs text-muted-foreground truncate max-w-[120px]",title:s.user?.email??"",children:s.user?.email??"Anon"}),e.jsx(f,{variant:s.is_published?"outline":"neon",className:`h-8 text-xs ${s.is_published?"text-red-500 hover:text-red-600 border-red-500/30":""}`,onClick:()=>p(s.id,s.is_published),children:s.is_published?e.jsxs(e.Fragment,{children:[e.jsx(k,{className:"w-3 h-3 mr-1"})," Banir/Ocultar"]}):e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"w-3 h-3 mr-1"})," Publicar"]})})]})]})]},s.id))})]})}export{A as default};
