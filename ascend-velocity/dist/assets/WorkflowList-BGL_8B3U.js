import{c as A,o as e,q as O,aR as R,Y as B,E as $,B as Q,$ as U,Z as G,j as D,I as k,H as w,a0 as Z}from"./index-DidJ2IC_.js";import{B as v}from"./button-DTTbzLxY.js";import{C as q,a as z,d as L,e as I,b as J,c as K}from"./card-D20_bRt7.js";import{e as ee,a as ae,g as te,d as re}from"./workflows-yFwrpo28.js";import{A as se,h as oe,a as ne,b as ie,c as de,d as ce,e as le,f as me,g as ue}from"./alert-dialog-C09ieuSA.js";import{S as j}from"./skeleton-BF4ood59.js";import{I as he}from"./input-RWOkaWNK.js";import{D as fe,a as ge,E as pe,b as xe,c as we,e as T,d as be}from"./dropdown-menu-BS3W2l7k.js";import{P as ve}from"./plus-C9Z0pS98.js";import{S as je}from"./search-CTyYii5Y.js";import{S as X}from"./square-pen-CUrgifGC.js";import{T as ye}from"./trash-2-CBwffM0k.js";import{C as Me}from"./calendar-CGf-h3Mg.js";import{t as b,c as Ne,n as E,a as F,g as De,e as ke,d as H,f as P,h as _,i as y,j as M,k as Pe}from"./en-US-DfnapdEA.js";import"./index-DKXZ3643.js";import"./index-KU_foAP1.js";import"./index-B17yf-n8.js";import"./index-CKOwKrdC.js";import"./index-D2QiG8fX.js";import"./check-CZK48_mu.js";const Ce=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 12.5 8 15l2 2.5",key:"1tg20x"}],["path",{d:"m14 12.5 2 2.5-2 2.5",key:"yinavb"}]],V=A("file-code",Ce);const We=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],Se=A("pause",We);const Te=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],_e=A("play",Te);function C(a,t){const s=+b(a)-+b(t);return s<0?-1:s>0?1:s}function Ae(a){return Ne(a,Date.now())}function Ee(a,t,s){const[n,r]=E(s?.in,a,t),u=n.getFullYear()-r.getFullYear(),h=n.getMonth()-r.getMonth();return u*12+h}function qe(a){return t=>{const n=(a?Math[a]:Math.trunc)(t);return n===0?0:n}}function ze(a,t){return+b(a)-+b(t)}function Le(a,t){const s=b(a,t?.in);return s.setHours(23,59,59,999),s}function Ie(a,t){const s=b(a,t?.in),n=s.getMonth();return s.setFullYear(s.getFullYear(),n+1,0),s.setHours(23,59,59,999),s}function Xe(a,t){const s=b(a,t?.in);return+Le(s,t)==+Ie(s,t)}function Fe(a,t,s){const[n,r,u]=E(s?.in,a,a,t),h=C(r,u),i=Math.abs(Ee(r,u));if(i<1)return 0;r.getMonth()===1&&r.getDate()>27&&r.setDate(30),r.setMonth(r.getMonth()-h*i);let c=C(r,u)===-h;Xe(n)&&i===1&&C(n,u)===1&&(c=!1);const p=h*(i-+c);return p===0?0:p}function He(a,t,s){const n=ze(a,t)/1e3;return qe(s?.roundingMethod)(n)}function Ve(a,t,s){const n=De(),r=s?.locale??n.locale??ke,u=2520,h=C(a,t);if(isNaN(h))throw new RangeError("Invalid time value");const i=Object.assign({},s,{addSuffix:s?.addSuffix,comparison:h}),[c,p]=E(s?.in,...h>0?[t,a]:[a,t]),g=He(p,c),W=(F(p)-F(c))/1e3,d=Math.round((g-W)/60);let f;if(d<2)return s?.includeSeconds?g<5?r.formatDistance("lessThanXSeconds",5,i):g<10?r.formatDistance("lessThanXSeconds",10,i):g<20?r.formatDistance("lessThanXSeconds",20,i):g<40?r.formatDistance("halfAMinute",0,i):g<60?r.formatDistance("lessThanXMinutes",1,i):r.formatDistance("xMinutes",1,i):d===0?r.formatDistance("lessThanXMinutes",1,i):r.formatDistance("xMinutes",d,i);if(d<45)return r.formatDistance("xMinutes",d,i);if(d<90)return r.formatDistance("aboutXHours",1,i);if(d<H){const l=Math.round(d/60);return r.formatDistance("aboutXHours",l,i)}else{if(d<u)return r.formatDistance("xDays",1,i);if(d<P){const l=Math.round(d/H);return r.formatDistance("xDays",l,i)}else if(d<P*2)return f=Math.round(d/P),r.formatDistance("aboutXMonths",f,i)}if(f=Fe(p,c),f<12){const l=Math.round(d/P);return r.formatDistance("xMonths",l,i)}else{const l=f%12,o=Math.trunc(f/12);return l<3?r.formatDistance("aboutXYears",o,i):l<9?r.formatDistance("overXYears",o,i):r.formatDistance("almostXYears",o+1,i)}}function Ye(a,t){return Ve(a,Ae(a),t)}const Oe={lessThanXSeconds:{one:"menos de um segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"meio minuto",lessThanXMinutes:{one:"menos de um minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"cerca de 1 hora",other:"cerca de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 dia",other:"{{count}} dias"},aboutXWeeks:{one:"cerca de 1 semana",other:"cerca de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"cerca de 1 mês",other:"cerca de {{count}} meses"},xMonths:{one:"1 mês",other:"{{count}} meses"},aboutXYears:{one:"cerca de 1 ano",other:"cerca de {{count}} anos"},xYears:{one:"1 ano",other:"{{count}} anos"},overXYears:{one:"mais de 1 ano",other:"mais de {{count}} anos"},almostXYears:{one:"quase 1 ano",other:"quase {{count}} anos"}},Re=(a,t,s)=>{let n;const r=Oe[a];return typeof r=="string"?n=r:t===1?n=r.one:n=r.other.replace("{{count}}",String(t)),s?.addSuffix?s.comparison&&s.comparison>0?"em "+n:"há "+n:n},Be={full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/yyyy"},$e={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},Qe={full:"{{date}} 'às' {{time}}",long:"{{date}} 'às' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Ue={date:_({formats:Be,defaultWidth:"full"}),time:_({formats:$e,defaultWidth:"full"}),dateTime:_({formats:Qe,defaultWidth:"full"})},Ge={lastWeek:a=>{const t=a.getDay();return"'"+(t===0||t===6?"último":"última")+"' eeee 'às' p"},yesterday:"'ontem às' p",today:"'hoje às' p",tomorrow:"'amanhã às' p",nextWeek:"eeee 'às' p",other:"P"},Ze=(a,t,s,n)=>{const r=Ge[a];return typeof r=="function"?r(t):r},Je={narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","depois de cristo"]},Ke={narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1º trimestre","2º trimestre","3º trimestre","4º trimestre"]},ea={narrow:["j","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["jan","fev","mar","abr","mai","jun","jul","ago","set","out","nov","dez"],wide:["janeiro","fevereiro","março","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"]},aa={narrow:["D","S","T","Q","Q","S","S"],short:["dom","seg","ter","qua","qui","sex","sab"],abbreviated:["domingo","segunda","terça","quarta","quinta","sexta","sábado"],wide:["domingo","segunda-feira","terça-feira","quarta-feira","quinta-feira","sexta-feira","sábado"]},ta={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"manhã",afternoon:"tarde",evening:"tarde",night:"noite"},abbreviated:{am:"AM",pm:"PM",midnight:"meia-noite",noon:"meio-dia",morning:"manhã",afternoon:"tarde",evening:"tarde",night:"noite"},wide:{am:"a.m.",pm:"p.m.",midnight:"meia-noite",noon:"meio-dia",morning:"manhã",afternoon:"tarde",evening:"tarde",night:"noite"}},ra={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"da manhã",afternoon:"da tarde",evening:"da tarde",night:"da noite"},abbreviated:{am:"AM",pm:"PM",midnight:"meia-noite",noon:"meio-dia",morning:"da manhã",afternoon:"da tarde",evening:"da tarde",night:"da noite"},wide:{am:"a.m.",pm:"p.m.",midnight:"meia-noite",noon:"meio-dia",morning:"da manhã",afternoon:"da tarde",evening:"da tarde",night:"da noite"}},sa=(a,t)=>{const s=Number(a);return t?.unit==="week"?s+"ª":s+"º"},oa={ordinalNumber:sa,era:y({values:Je,defaultWidth:"wide"}),quarter:y({values:Ke,defaultWidth:"wide",argumentCallback:a=>a-1}),month:y({values:ea,defaultWidth:"wide"}),day:y({values:aa,defaultWidth:"wide"}),dayPeriod:y({values:ta,defaultWidth:"wide",formattingValues:ra,defaultFormattingWidth:"wide"})},na=/^(\d+)[ºªo]?/i,ia=/\d+/i,da={narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|d\.?\s?c\.?)/i,wide:/^(antes de cristo|depois de cristo)/i},ca={any:[/^ac/i,/^dc/i],wide:[/^antes de cristo/i,/^depois de cristo/i]},la={narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234](º)? trimestre/i},ma={any:[/1/i,/2/i,/3/i,/4/i]},ua={narrow:/^[jfmajsond]/i,abbreviated:/^(jan|fev|mar|abr|mai|jun|jul|ago|set|out|nov|dez)/i,wide:/^(janeiro|fevereiro|março|abril|maio|junho|julho|agosto|setembro|outubro|novembro|dezembro)/i},ha={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^fev/i,/^mar/i,/^abr/i,/^mai/i,/^jun/i,/^jul/i,/^ago/i,/^set/i,/^out/i,/^nov/i,/^dez/i]},fa={narrow:/^(dom|[23456]ª?|s[aá]b)/i,short:/^(dom|[23456]ª?|s[aá]b)/i,abbreviated:/^(dom|seg|ter|qua|qui|sex|s[aá]b)/i,wide:/^(domingo|(segunda|ter[cç]a|quarta|quinta|sexta)([- ]feira)?|s[aá]bado)/i},ga={short:[/^d/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^s[aá]/i],narrow:[/^d/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^s[aá]/i],any:[/^d/i,/^seg/i,/^t/i,/^qua/i,/^qui/i,/^sex/i,/^s[aá]b/i]},pa={narrow:/^(a|p|mn|md|(da) (manhã|tarde|noite))/i,any:/^([ap]\.?\s?m\.?|meia[-\s]noite|meio[-\s]dia|(da) (manhã|tarde|noite))/i},xa={any:{am:/^a/i,pm:/^p/i,midnight:/^mn|^meia[-\s]noite/i,noon:/^md|^meio[-\s]dia/i,morning:/manhã/i,afternoon:/tarde/i,evening:/tarde/i,night:/noite/i}},wa={ordinalNumber:Pe({matchPattern:na,parsePattern:ia,valueCallback:a=>parseInt(a,10)}),era:M({matchPatterns:da,defaultMatchWidth:"wide",parsePatterns:ca,defaultParseWidth:"any"}),quarter:M({matchPatterns:la,defaultMatchWidth:"wide",parsePatterns:ma,defaultParseWidth:"any",valueCallback:a=>a+1}),month:M({matchPatterns:ua,defaultMatchWidth:"wide",parsePatterns:ha,defaultParseWidth:"any"}),day:M({matchPatterns:fa,defaultMatchWidth:"wide",parsePatterns:ga,defaultParseWidth:"any"}),dayPeriod:M({matchPatterns:pa,defaultMatchWidth:"any",parsePatterns:xa,defaultParseWidth:"any"})},ba={code:"pt-BR",formatDistance:Re,formatLong:Ue,formatRelative:Ze,localize:oa,match:wa,options:{weekStartsOn:0,firstWeekContainsDate:1}},va=R("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Y({className:a,variant:t,...s}){return e.jsx("div",{className:O(va({variant:t}),a),...s})}function ja(){const a=$(),{user:t}=Q(),{startWorkflowsTutorial:s}=U(),n=G(),[r,u]=D.useState([]),[h,i]=D.useState(!0),[c,p]=D.useState("");D.useEffect(()=>{t&&g()},[t]);const g=async()=>{if(t){i(!0);try{if(n?n.isPageToolsEnabled():!0){const{error:N}=await ee(k);N&&console.error(N)}const{data:m,error:x}=await k.from("workflows").select("id, title, description, updated_at, is_active").eq("user_id",t.id).order("updated_at",{ascending:!1});if(x)throw x;u(m||[])}catch(o){console.error(o),w.error("Erro ao carregar mapas mentais")}finally{i(!1)}}},W=async o=>{try{if(!t){w.error("Você precisa estar logado");return}if(n&&!n.canUseTool("workflow-delete")){n.notifyToolBlocked();return}const{error:m}=await re(k,{workflowId:o,userId:t.id});if(m)throw m;w.success("Mapa mental removido com sucesso"),g()}catch(m){console.error(m),w.error("Erro ao remover mapa mental")}},d=async(o,m)=>{try{if(!t){w.error("Você precisa estar logado");return}if(n&&!n.canUseTool("workflow-toggle-status")){n.notifyToolBlocked();return}const{error:x}=await k.from("workflows").update({is_active:!m}).eq("id",o).eq("user_id",t.id);if(x)throw x;w.success(`Mapa mental ${m?"desativado":"ativado"} com sucesso`),u(N=>N.map(S=>S.id===o?{...S,is_active:!m}:S))}catch(x){console.error(x),w.error("Erro ao atualizar status")}},f=r.filter(o=>o.title.toLowerCase().includes(c.toLowerCase())||o.description?.toLowerCase().includes(c.toLowerCase())),l=ae(r.length);return e.jsxs("div",{className:"space-y-6 max-w-[1600px] mx-auto p-4 md:p-6 lg:p-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",id:"workflow-header",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Meus Mapas Mentais"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Gerencie seus mapas mentais de automação e formulários interativos."})]}),e.jsxs("div",{className:"flex gap-3 w-full md:w-auto",children:[e.jsxs(v,{onClick:s,variant:"outline",className:"flex gap-2 bg-white/10 hover:bg-white/20 border-white/20 text-foreground px-6 w-full md:w-auto",children:[e.jsx(Z,{className:"w-4 h-4 text-yellow-500"}),"Como usar"]}),e.jsxs(v,{onClick:()=>a("/dashboard/workflow"),className:"gap-2 w-full md:w-auto shadow-lg hover:shadow-primary/20 transition-all",id:"workflow-new-btn",disabled:l,children:[e.jsx(ve,{className:"w-4 h-4"}),"Novo Mapa Mental"]})]})]}),l&&e.jsxs("div",{className:"rounded-xl border bg-muted/10 px-4 py-3 text-sm",role:"status",children:[e.jsx("div",{className:"font-medium",children:"Limite atingido"}),e.jsx("div",{className:"text-muted-foreground",children:"Você atingiu o limite de 4 mapas mentais. Exclua um mapa existente para liberar espaço."})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-center bg-card p-4 rounded-xl border shadow-sm",id:"workflow-search",children:[e.jsxs("div",{className:"relative w-full sm:max-w-md",children:[e.jsx(je,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(he,{placeholder:"Buscar mapas mentais...",className:"pl-9 bg-background/50 border-transparent hover:border-input focus:border-primary transition-all",value:c,onChange:o=>p(o.target.value)})]}),e.jsxs("div",{className:"flex items-center gap-2 w-full sm:w-auto text-sm text-muted-foreground ml-auto",children:[e.jsx(V,{className:"w-4 h-4"}),e.jsxs("span",{children:[f.length," mapas mentais encontrados"]}),e.jsx(Y,{variant:l?"destructive":"secondary",className:"ml-2",children:te(r.length)})]})]}),h?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4 gap-6",id:"workflow-list-grid",children:[1,2,3,4,5,6].map(o=>e.jsxs(q,{className:"overflow-hidden border-0 shadow-md bg-card/50",children:[e.jsx(j,{className:"h-2 w-full bg-primary/10 rounded-none"}),e.jsxs(z,{className:"space-y-2",children:[e.jsx(j,{className:"h-6 w-3/4"}),e.jsx(j,{className:"h-4 w-full"})]}),e.jsx(L,{children:e.jsx(j,{className:"h-4 w-1/2"})}),e.jsx(I,{className:"border-t bg-muted/20 p-4",children:e.jsx(j,{className:"h-9 w-full rounded-md"})})]},o))}):f.length===0?e.jsxs("div",{className:"text-center py-20 bg-muted/10 rounded-2xl border-2 border-dashed flex flex-col items-center justify-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-primary/10 flex items-center justify-center mb-2",children:e.jsx(V,{className:"w-8 h-8 text-primary"})}),e.jsxs("div",{className:"max-w-md space-y-2",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Nenhum mapa mental encontrado"}),e.jsx("p",{className:"text-muted-foreground",children:c?"Tente ajustar seus termos de busca para encontrar o que procura.":"Comece criando seu primeiro mapa mental interativo para automatizar seus processos."})]}),!c&&e.jsx(v,{onClick:()=>a("/dashboard/workflow"),className:"mt-4",id:"workflow-new-btn-empty",children:"Criar Primeiro Mapa Mental"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4 gap-6 animate-fade-in",id:"workflow-list-grid",children:f.map(o=>e.jsxs(q,{className:"group hover:shadow-xl hover:-translate-y-1 transition-all duration-300 border-0 ring-1 ring-border/50 bg-card flex flex-col relative overflow-hidden",children:[e.jsx("div",{className:`absolute top-0 left-0 w-full h-1 ${o.is_active?"bg-gradient-to-r from-primary to-purple-500":"bg-muted"}`}),e.jsxs(z,{className:"pb-3",children:[e.jsxs("div",{className:"flex justify-between items-start gap-4",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(J,{className:"line-clamp-1 text-lg group-hover:text-primary transition-colors",children:o.title}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(Y,{variant:o.is_active?"default":"secondary",className:"text-[10px] h-5 px-2",children:o.is_active?"Ativo":"Inativo"})})]}),e.jsxs(fe,{children:[e.jsx(ge,{asChild:!0,children:e.jsx(v,{variant:"ghost",size:"icon",className:"h-8 w-8 -mr-2 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(pe,{className:"w-4 h-4"})})}),e.jsxs(xe,{align:"end",children:[e.jsx(we,{children:"Ações"}),e.jsxs(T,{onClick:()=>a(`/dashboard/workflow/${o.id}`),children:[e.jsx(X,{className:"w-4 h-4 mr-2"})," Editar"]}),e.jsxs(T,{onClick:()=>d(o.id,o.is_active),children:[o.is_active?e.jsx(Se,{className:"w-4 h-4 mr-2"}):e.jsx(_e,{className:"w-4 h-4 mr-2"}),o.is_active?"Pausar":"Ativar"]}),e.jsx(be,{}),e.jsxs(se,{children:[e.jsx(oe,{asChild:!0,children:e.jsxs(T,{onSelect:m=>m.preventDefault(),className:"text-destructive focus:text-destructive",children:[e.jsx(ye,{className:"w-4 h-4 mr-2"})," Excluir"]})}),e.jsxs(ne,{children:[e.jsxs(ie,{children:[e.jsx(de,{children:"Excluir mapa mental?"}),e.jsxs(ce,{children:['Esta ação é irreversível e removerá permanentemente o mapa mental "',o.title,'" e todos os seus dados.']})]}),e.jsxs(le,{children:[e.jsx(me,{children:"Cancelar"}),e.jsx(ue,{onClick:()=>W(o.id),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Excluir Definitivamente"})]})]})]})]})]})]}),e.jsx(K,{className:"line-clamp-2 min-h-[40px] text-sm mt-2",children:o.description||"Sem descrição definida para este mapa mental."})]}),e.jsx(L,{className:"py-2 flex-1",children:e.jsxs("div",{className:"flex items-center text-xs text-muted-foreground gap-2 bg-muted/30 p-2 rounded-lg w-fit",children:[e.jsx(Me,{className:"w-3 h-3"}),e.jsxs("span",{children:["Atualizado ",Ye(new Date(o.updated_at),{addSuffix:!0,locale:ba})]})]})}),e.jsx(I,{className:"pt-4 pb-4 px-6 border-t bg-muted/5 mt-auto gap-3",children:e.jsxs(v,{onClick:()=>a(`/dashboard/workflow/${o.id}`),className:"w-full shadow-none group-hover:shadow-md transition-all",variant:"default",children:[e.jsx(X,{className:"w-4 h-4 mr-2"}),"Editar Mapa Mental"]})})]},o.id))})]})}function Va(){return e.jsx(B,{children:e.jsx(ja,{})})}export{Va as default};
