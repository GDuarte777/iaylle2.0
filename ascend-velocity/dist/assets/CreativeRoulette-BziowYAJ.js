import{c as ne,aC as oe,aD as Y,u as le,k as ie,o as e,Y as ce,B as de,Z as ue,$ as xe,j as l,aw as me,D as G,a0 as H,t as T,A as he,H as g,X as ge,I as R}from"./index-BSbx0JO7.js";import{G as fe}from"./GlassCard-VIvyi7x2.js";import{I as pe}from"./input-DQGwEGmE.js";import{B as f}from"./button-BPilKZxs.js";import{D as be,a as we,c as je,b as ve}from"./dialog-C88qaMGg.js";import{c as U}from"./confetti.module-oQXWb4Lk.js";import{P as F,S as ye}from"./save-DoASyzhY.js";import{C as ke}from"./chevron-down-B-Q5fn4f.js";import{S as Ne}from"./sparkles-BdsTEIOQ.js";import{P as Ce}from"./plus-fQ5sqYr7.js";import{T as Te}from"./trash-2-DN8uoqXU.js";import"./index-DiCYkEsm.js";import"./index-CjQuBds1.js";import"./index-BAL7-AhQ.js";const Ee=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],W=ne("rotate-cw",Ee);function Ae(s){s.values.forEach(r=>r.stop())}function P(s,r){[...r].reverse().forEach(n=>{const c=s.getVariant(n);c&&Y(s,c),s.variantChildren&&s.variantChildren.forEach(y=>{P(y,r)})})}function De(s,r){if(Array.isArray(r))return P(s,r);if(typeof r=="string")return P(s,[r]);Y(s,r)}function Se(){const s=new Set,r={subscribe(i){return s.add(i),()=>{s.delete(i)}},start(i,n){const c=[];return s.forEach(y=>{c.push(oe(y,i,{transitionOverride:n}))}),Promise.all(c)},set(i){return s.forEach(n=>{De(n,i)})},stop(){s.forEach(i=>{Ae(i)})},mount(){return()=>{r.stop()}}};return r}function _e(){const s=le(Se);return ie(s.mount,[]),s}const Re=_e,X=[{id:"1",text:"Mostre os bastidores do seu trabalho"},{id:"2",text:"Responda uma caixinha de perguntas polêmica"},{id:"3",text:"Conte um erro que você cometeu e o que aprendeu"},{id:"4",text:"Compartilhe uma ferramenta que você usa todos os dias"},{id:"5",text:"Faça um tutorial rápido de algo que você domina"},{id:"6",text:"Mostre sua rotina matinal"},{id:"7",text:"Reaja a uma notícia ou tendência do seu nicho"},{id:"8",text:"Agradeça seus seguidores por uma conquista recente"},{id:"9",text:"Poste uma foto antiga e conte sua história (TBT)"},{id:"10",text:"Dê uma dica rápida que economiza tempo"},{id:"11",text:"Pergunte a opinião da audiência sobre um projeto novo"},{id:"12",text:"Mostre seu espaço de trabalho"}],E=["#FF6B6B","#4ECDC4","#45B7D1","#96CEB4","#FFEEAD","#D4A5A5","#9B59B6","#3498DB","#E67E22","#2ECC71","#F1C40F","#E74C3C"];function Fe(){const{user:s}=de(),r=ue(),{startRouletteTutorial:i}=xe(),[n,c]=l.useState(X),[y,K]=l.useState(!0),[u,I]=l.useState(!1),[k,B]=l.useState(null),M=Re(),p=me(0),m=l.useRef(null),L=l.useRef(-1),[Z,q]=l.useState(!1),[b,w]=l.useState(""),[j,A]=l.useState(null),N=()=>r&&!r.isPageToolsEnabled()?(r.notifyToolBlocked(),!1):!0;l.useEffect(()=>{if(!s)return;(async()=>{try{const{data:a,error:o}=await R.from("user_roulette_challenges").select("challenges").eq("user_id",s.id).single();if(a)c(a.challenges);else{if(r&&!r.isPageToolsEnabled())return;await R.from("user_roulette_challenges").insert({user_id:s.id,challenges:X})}}catch(a){console.error("Error loading challenges:",a)}finally{K(!1)}})()},[r,s]);const D=async t=>{if(!N())return!1;const a=n;if(c(t),!s)return!0;const{error:o}=await R.from("user_roulette_challenges").upsert({user_id:s.id,challenges:t,updated_at:new Date().toISOString()},{onConflict:"user_id"});return o?(c(a),g.error("Erro ao salvar alterações"),!1):!0};l.useEffect(()=>(m.current=new(window.AudioContext||window.webkitAudioContext),()=>{m.current?.close()}),[]);const J=()=>{if(!m.current)return;const t=m.current,a=t.createOscillator(),o=t.createGain();a.type="triangle",a.frequency.setValueAtTime(800,t.currentTime),a.frequency.exponentialRampToValueAtTime(100,t.currentTime+.05),o.gain.setValueAtTime(.1,t.currentTime),o.gain.exponentialRampToValueAtTime(.001,t.currentTime+.05),a.connect(o),o.connect(t.destination),a.start(),a.stop(t.currentTime+.05)};l.useEffect(()=>{const t=p.on("change",a=>{const o=360/n.length,d=(360-a%360)%360,x=Math.floor(d/o);x!==L.current&&u&&(J(),L.current=x)});return()=>t()},[n.length,u,p]);const Q=async()=>{if(r&&!r.isPageToolsEnabled()){r.notifyToolBlocked();return}if(u||n.length===0)return;m.current?.state==="suspended"&&await m.current.resume(),I(!0),B(null);const t=360/n.length,a=5,o=Math.random()*360,d=p.get()+360*a+o;await M.start({rotate:d,transition:{duration:4,ease:[.2,.8,.3,1],type:"tween"}}),p.set(d);const v=(360-d%360)%360,h=Math.floor(v/t),S=h>=n.length?0:h,_=n[S];B(_),I(!1);const re=Date.now()+3*1e3,V=["#00F2FF","#8B5CF6","#FF00FF"];(function se(){U({particleCount:3,angle:60,spread:55,origin:{x:0},colors:V}),U({particleCount:3,angle:120,spread:55,origin:{x:1},colors:V}),Date.now()<re&&requestAnimationFrame(se)})()},$=async()=>{if(!b.trim())return;const t={id:Math.random().toString(36).substr(2,9),text:b};await D([...n,t])&&(w(""),g.success("Desafio adicionado!"))},z=async()=>{!j||!b.trim()||!await D(n.map(a=>a.id===j?{...a,text:b}:a))||(A(null),w(""),g.success("Desafio atualizado!"))},ee=async t=>{if(n.length<=1){g.error("Você precisa ter pelo menos 1 desafio!");return}await D(n.filter(o=>o.id!==t))&&g.success("Desafio removido!")},te=t=>{A(t.id),w(t.text)},ae=()=>{A(null),w("")},O=t=>{const a=Math.cos(2*Math.PI*t),o=Math.sin(2*Math.PI*t);return[a,o]};return e.jsxs("div",{className:"container mx-auto p-4 md:p-8 max-w-6xl",children:[e.jsxs("header",{className:"mb-8 text-center md:text-left flex flex-col md:flex-row justify-between items-center gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl md:text-4xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-neon-blue to-purple-600 flex items-center gap-3 justify-center md:justify-start",children:[e.jsx(G,{className:"w-8 h-8 text-neon-blue"}),"Roleta Criativa"]}),e.jsxs("p",{className:"text-lg text-muted-foreground mt-3 max-w-2xl mx-auto md:mx-0 font-light tracking-wide border-l-4 border-neon-blue pl-4 bg-gradient-to-r from-neon-blue/5 to-transparent py-2 rounded-r-lg",children:["Gire a roleta e receba um ",e.jsx("span",{className:"font-medium text-neon-blue",children:"desafio criativo"})," para o seu conteúdo de hoje."]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(f,{onClick:i,variant:"outline",className:"border-neon-blue/20 hover:bg-neon-blue/10 flex gap-2",children:[e.jsx(H,{className:"w-4 h-4 text-yellow-500"}),"Como usar"]}),e.jsxs(f,{id:"roulette-manage-btn",variant:"outline",className:"border-neon-blue/20 hover:bg-neon-blue/10",onClick:()=>{N()&&q(!0)},children:[e.jsx(F,{className:"w-4 h-4 mr-2"}),"Gerenciar Opções"]})]})]}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-12 items-center",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsxs("div",{className:"relative w-[300px] h-[300px] md:w-[400px] md:h-[400px]",id:"roulette-wheel",children:[e.jsx("div",{className:"absolute -top-4 left-1/2 -translate-x-1/2 z-20 text-white filter drop-shadow-lg",children:e.jsx(ke,{className:"w-10 h-10 fill-current text-neon-blue"})}),e.jsx("div",{className:"w-full h-full rounded-full border-4 border-border/20 dark:bg-background/40 bg-background/40 shadow-[0_0_50px_rgba(0,242,255,0.1)] dark:shadow-[0_0_50px_rgba(0,242,255,0.1)] shadow-2xl relative overflow-hidden",children:e.jsx(T.div,{className:"w-full h-full",animate:M,style:{rotate:p},children:e.jsx("svg",{viewBox:"-1 -1 2 2",className:"w-full h-full transform -rotate-90",children:n.map((t,a)=>{const o=a/n.length,C=(a+1)/n.length,[d,x]=O(o),[v,h]=O(C),S=C-o>.5?1:0,_=[`M ${d} ${x}`,`A 1 1 0 ${S} 1 ${v} ${h}`,"L 0 0"].join(" ");return e.jsxs("g",{children:[e.jsx("path",{d:_,fill:E[a%E.length],stroke:"rgba(0,0,0,0.2)",strokeWidth:"0.01"}),e.jsx("text",{x:(d+v)/3,y:(x+h)/3,fill:"white",fontSize:"0.15",fontWeight:"bold",textAnchor:"middle",dominantBaseline:"middle",transform:`rotate(${a*360/n.length+180/n.length}, ${(d+v)/3}, ${(x+h)/3})`,style:{textShadow:"1px 1px 2px black"},children:a+1})]},t.id)})})})}),e.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-16 h-16 bg-white rounded-full border-4 border-gray-200 shadow-lg flex items-center justify-center z-10",children:e.jsx("div",{className:"w-12 h-12 bg-neon-blue rounded-full flex items-center justify-center animate-pulse",children:e.jsx(Ne,{className:"w-6 h-6 text-white"})})})]}),e.jsx("div",{className:"mt-8 w-full max-w-xs",id:"roulette-spin-btn",children:e.jsxs(T.button,{onClick:Q,disabled:u||n.length===0||(r?!r.isPageToolsEnabled():!1),whileHover:{scale:1.05,boxShadow:"0 0 20px rgba(0, 242, 255, 0.4)"},whileTap:{scale:.95},className:`
                  relative w-full py-4 px-8 rounded-2xl font-bold text-lg tracking-wide
                  transition-all duration-300 overflow-hidden group
                  ${u||r&&!r.isPageToolsEnabled()?"bg-gray-200 dark:bg-gray-800/50 text-gray-400 dark:text-gray-500 cursor-not-allowed border border-gray-300 dark:border-gray-700":"bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 dark:from-neon-blue dark:via-purple-500 dark:to-pink-500 text-white shadow-lg dark:shadow-[0_0_20px_rgba(0,242,255,0.3)] hover:shadow-xl dark:hover:shadow-[0_0_30px_rgba(0,242,255,0.5)] hover:scale-[1.02] active:scale-[0.98]"}
                `,children:[e.jsx("div",{className:"absolute inset-0 bg-white/20 translate-y-full group-hover:translate-y-0 transition-transform duration-300 ease-out"}),e.jsx("span",{className:"relative flex items-center justify-center gap-3 z-10",children:u?e.jsxs(e.Fragment,{children:[e.jsx(W,{className:"w-5 h-5 animate-spin"}),e.jsx("span",{className:"text-base",children:"Sorteando..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(G,{className:"w-6 h-6 transition-transform group-hover:rotate-180 duration-500"}),"GIRAR"]})})]})})]}),e.jsx("div",{className:"flex flex-col gap-6",children:e.jsxs(fe,{className:"p-6 min-h-[200px] flex flex-col justify-center relative overflow-hidden border-neon-blue/20 dark:border-neon-blue/20 border-neon-blue/10 bg-white/50 dark:bg-black/50",id:"roulette-result-card",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-neon-blue/5 via-purple-500/5 to-transparent pointer-events-none"}),e.jsx(he,{mode:"wait",children:k?e.jsxs(T.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},exit:{y:-20,opacity:0},className:"text-center",children:[e.jsx("div",{className:"inline-block p-3 rounded-full bg-green-500/20 text-green-600 dark:text-green-400 mb-4 border border-green-500/30",children:e.jsx(H,{className:"w-8 h-8"})}),e.jsxs("h2",{className:"text-2xl font-bold text-foreground mb-2",children:["Desafio #",n.indexOf(k)+1]}),e.jsxs("p",{className:"text-xl md:text-2xl text-foreground/90 font-medium leading-relaxed",children:['"',k.text,'"']}),e.jsx("div",{className:"mt-6 pt-6 border-t border-border flex justify-center gap-4",children:e.jsx(f,{variant:"outline",onClick:()=>{N()&&(navigator.clipboard.writeText(k.text),g.success("Copiado!"))},children:"Copiar Texto"})})]},"result"):e.jsxs(T.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"text-center text-muted-foreground",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 dark:bg-white/5 rounded-full flex items-center justify-center",children:e.jsx(W,{className:`w-8 h-8 ${u?"animate-spin text-neon-blue":"text-gray-400 dark:text-gray-500"}`})}),e.jsx("h3",{className:"text-xl font-medium text-gray-900 dark:text-white mb-2",children:u?"A sorte está sendo lançada...":"Pronto para girar?"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Clique no botão para descobrir seu próximo conteúdo."})]},"waiting")})]})})]}),e.jsx(be,{open:Z,onOpenChange:t=>{t&&!N()||q(t)},children:e.jsxs(we,{className:"w-[95vw] sm:w-full max-w-2xl max-h-[80vh] bg-white dark:bg-[#0f172a]/95 backdrop-blur-xl border-gray-200 dark:border-white/10 text-gray-900 dark:text-white overflow-hidden flex flex-col shadow-2xl",children:[e.jsx(je,{children:e.jsxs(ve,{className:"text-xl font-bold flex items-center gap-2 text-gray-900 dark:text-white",children:[e.jsx(F,{className:"w-5 h-5 text-neon-blue"}),"Gerenciar Banco de Ideias"]})}),e.jsx("div",{className:"p-1 space-y-4",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(pe,{value:b,onChange:t=>w(t.target.value),placeholder:"Digite uma nova ideia de desafio...",className:"bg-gray-50 dark:bg-black/20 border-gray-300 dark:border-white/10 focus:border-neon-blue text-gray-900 dark:text-white placeholder:text-gray-400",onKeyDown:t=>{t.key==="Enter"&&(j?z():$())}}),j?e.jsxs("div",{className:"flex gap-1",children:[e.jsx(f,{onClick:z,className:"bg-green-600 hover:bg-green-700 text-white",children:e.jsx(ye,{className:"w-4 h-4"})}),e.jsx(f,{onClick:ae,variant:"ghost",className:"hover:bg-muted",children:e.jsx(ge,{className:"w-4 h-4"})})]}):e.jsx(f,{onClick:$,className:"bg-neon-blue text-black hover:bg-neon-blue/80",children:e.jsx(Ce,{className:"w-4 h-4"})})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto pr-2 space-y-2 mt-2",children:n.map((t,a)=>e.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg border transition-colors ${j===t.id?"bg-neon-blue/10 border-neon-blue/30":"bg-white dark:bg-black/20 border-gray-200 dark:border-white/5 hover:border-gray-300 dark:hover:border-white/10"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 mr-4",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-gray-100 dark:bg-white/10 flex items-center justify-center text-xs font-bold shrink-0",style:{backgroundColor:E[a%E.length],color:"black"},children:a+1}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-200",children:t.text})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>te(t),className:"p-2 hover:bg-gray-100 dark:hover:bg-white/10 rounded-md text-gray-500 dark:text-muted-foreground hover:text-gray-900 dark:hover:text-white transition-colors",children:e.jsx(F,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>ee(t.id),className:"p-2 hover:bg-red-500/20 rounded-md text-gray-500 dark:text-muted-foreground hover:text-red-500 transition-colors",children:e.jsx(Te,{className:"w-4 h-4"})})]})]},t.id))})]})})]})}function Xe(){return e.jsx(ce,{children:e.jsx(Fe,{})})}export{Xe as default};
